<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="keywords" content="ABS, manual, modeling languages, programming languages">
<meta name="author" content="ABS Development Team">
<meta name="copyright" content="CC-BY-SA 3.0">
<title>ABS Documentation</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Noto Serif", "DejaVu Serif", serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Open Sans", "DejaVu Sans", sans-serif; font-weight: 300; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #7a2518; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #19407c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
  * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
  thead { display: table-header-group; }
  svg { max-width: 100%; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  .sect1 { padding-bottom: 0 !important; }
  .sect1 + .sect1 { border: 0 !important; }
  #header > h1:first-child { margin-top: 1.25rem; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { background: none !important; padding: 0 0.9375em; }
  #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>ABS Documentation</h1>
<div class="details">
<span id="author" class="author">ABS Development Team</span><br>
<span id="revnumber">version v1.10.1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#-introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#-the-abs-language">1.1. The ABS Language</a></li>
<li><a href="#sec:concurrency-model">1.2. The ABS Actor and Concurrency Model</a></li>
<li><a href="#sec:error-model">1.3. Error Propagation and Recovery in ABS</a></li>
</ul>
</li>
<li><a href="#-lexical-structure">2. Lexical Structure</a>
<ul class="sectlevel2">
<li><a href="#-line-terminators-and-white-spaces">2.1. Line Terminators and White Spaces</a></li>
<li><a href="#-comments">2.2. Comments</a></li>
<li><a href="#-identifiers">2.3. Identifiers</a></li>
<li><a href="#-keywords">2.4. Keywords</a></li>
<li><a href="#sec:literals">2.5. Literals</a></li>
<li><a href="#-annotations">2.6. Annotations</a></li>
</ul>
</li>
<li><a href="#-types">3. Types</a>
<ul class="sectlevel2">
<li><a href="#sec:builtin-types">3.1. Built-in Types</a></li>
<li><a href="#sec:algebraic-data-types">3.2. Algebraic Data Types</a></li>
<li><a href="#-interface-types">3.3. Interface Types</a></li>
<li><a href="#sec:exception-types">3.4. Exceptions</a></li>
<li><a href="#-type-synonyms">3.5. Type Synonyms</a></li>
<li><a href="#-location-types">3.6. Location Types</a></li>
</ul>
</li>
<li><a href="#-expressions">4. Expressions</a>
<ul class="sectlevel2">
<li><a href="#-literals">4.1. Literals</a></li>
<li><a href="#-template-strings">4.2. Template Strings</a></li>
<li><a href="#-operator-expressions">4.3. Operator Expressions</a></li>
<li><a href="#-let">4.4. Let</a></li>
<li><a href="#-data-constructor-expressions">4.5. Data Constructor Expressions</a></li>
<li><a href="#-function-calls">4.6. Function Calls</a></li>
<li><a href="#-partially-defined-function-calls">4.7. Partially-Defined-Function Calls</a></li>
<li><a href="#-conditional-expressions">4.8. Conditional Expressions</a></li>
<li><a href="#case-expression">4.9. Case</a></li>
<li><a href="#typecheck-expression">4.10. Type-Check Expressions</a></li>
<li><a href="#typecast-expression">4.11. Type-Cast Expressions</a></li>
<li><a href="#-new">4.12. New</a></li>
<li><a href="#-synchronous-method-calls">4.13. Synchronous Method Calls</a></li>
<li><a href="#async-call-expression">4.14. Asynchronous Method Calls</a></li>
<li><a href="#get-expression">4.15. Get</a></li>
<li><a href="#await-expression">4.16. Await (Expression)</a></li>
<li><a href="#destiny-expression">4.17. Destiny (Expression)</a></li>
</ul>
</li>
<li><a href="#-function-definitions">5. Function Definitions</a>
<ul class="sectlevel2">
<li><a href="#sec:partially-defined-functions">5.1. Partial Function Definitions</a></li>
<li><a href="#sec:anonymous-functions">5.2. Anonymous Functions</a></li>
<li><a href="#-built-in-functions">5.3. Built-In Functions</a></li>
<li><a href="#-embedded-sqlite-database-queries">5.4. Embedded SQLite Database Queries</a></li>
</ul>
</li>
<li><a href="#-statements">6. Statements</a>
<ul class="sectlevel2">
<li><a href="#-skip">6.1. Skip</a></li>
<li><a href="#-variable-declarations">6.2. Variable Declarations</a></li>
<li><a href="#-assignment">6.3. Assignment</a></li>
<li><a href="#-expressions-as-statements">6.4. Expressions as Statements</a></li>
<li><a href="#-assertions">6.5. Assertions</a></li>
<li><a href="#await-stmt">6.6. Await (Statement)</a></li>
<li><a href="#suspend-stmt">6.7. Unconditional Release: Suspend</a></li>
<li><a href="#-return">6.8. Return</a></li>
<li><a href="#throw-statement">6.9. Throw</a></li>
<li><a href="#-blocks-of-statements">6.10. Blocks of Statements</a></li>
<li><a href="#-conditionals">6.11. Conditionals</a></li>
<li><a href="#switch-stmt">6.12. Switch: Pattern Matching</a></li>
<li><a href="#-the-while-loop">6.13. The While Loop</a></li>
<li><a href="#foreach-loop">6.14. The Foreach Loop</a></li>
<li><a href="#try-catch-finally-stmt">6.15. Handling Exceptions with Try-Catch-Finally</a></li>
</ul>
</li>
<li><a href="#sec:interfaces">7. Interfaces</a></li>
<li><a href="#sec:classes">8. Classes</a>
<ul class="sectlevel2">
<li><a href="#-constant-fields">8.1. Constant Fields</a></li>
<li><a href="#-read-only-methods">8.2. Read-only Methods</a></li>
<li><a href="#-atomic-methods">8.3. Atomic Methods</a></li>
<li><a href="#sec:active-classes">8.4. Active Classes</a></li>
</ul>
</li>
<li><a href="#sec:traits">9. Traits</a></li>
<li><a href="#sec:modules">10. Modules</a>
<ul class="sectlevel2">
<li><a href="#-defining-a-module">10.1. Defining a Module</a></li>
<li><a href="#-exporting-identifiers">10.2. Exporting Identifiers</a></li>
<li><a href="#-importing-identifiers">10.3. Importing Identifiers</a></li>
</ul>
</li>
<li><a href="#sec:standard-library">11. The Standard Library</a>
<ul class="sectlevel2">
<li><a href="#type-bool">11.1. Boolean values</a></li>
<li><a href="#type-numbers">11.2. Numbers</a></li>
<li><a href="#type-string">11.3. Strings</a></li>
<li><a href="#type-unit">11.4. Unit</a></li>
<li><a href="#type-object">11.5. Object</a></li>
<li><a href="#type-future">11.6. The Future Type</a></li>
<li><a href="#stdlib:predefined-exceptions">11.7. Predefined exceptions in the Standard Library</a></li>
<li><a href="#type-list">11.8. Lists</a></li>
<li><a href="#type-set">11.9. Sets</a></li>
<li><a href="#type-map">11.10. Maps</a></li>
<li><a href="#type-pair">11.11. Pairs</a></li>
<li><a href="#type-triple">11.12. Triples</a></li>
<li><a href="#type-optionals">11.13. Optionals</a></li>
<li><a href="#stdlib-others">11.14. Others</a></li>
</ul>
</li>
<li><a href="#-the-model-api">12. The Model API</a>
<ul class="sectlevel2">
<li><a href="#-starting-the-model-api">12.1. Starting the Model API</a></li>
<li><a href="#-shutting-down-the-model-api">12.2. Shutting down the Model API</a></li>
<li><a href="#-exposing-objects">12.3. Exposing objects</a></li>
<li><a href="#-exposing-methods">12.4. Exposing methods</a></li>
<li><a href="#-querying-object-state">12.5. Querying object state</a></li>
<li><a href="#-listing-the-exposed-methods-of-an-object">12.6. Listing the exposed methods of an object</a></li>
<li><a href="#-calling-exposed-methods">12.7. Calling exposed methods</a></li>
<li><a href="#-the-model-api-and-timed-abs">12.8. The Model API and Timed ABS</a></li>
<li><a href="#-customizing-the-browser-based-visualization">12.9. Customizing the Browser-Based Visualization</a></li>
<li><a href="#customizing-url-prefixes">12.10. Customizing the Model API URL</a></li>
</ul>
</li>
<li><a href="#sec:timed-abs">13. Timed ABS</a>
<ul class="sectlevel2">
<li><a href="#-datatypes-and-constructors-11">13.1. Datatypes and Constructors</a></li>
<li><a href="#-functions-10">13.2. Functions</a></li>
<li><a href="#-statements-2">13.3. Statements</a></li>
<li><a href="#-semantics-of-time-advancement">13.4. Semantics of Time Advancement</a></li>
<li><a href="#timed-abs-and-model-api">13.5. Timed ABS and the Model API</a></li>
</ul>
</li>
<li><a href="#sec:schedulers">14. User-Defined Schedulers</a>
<ul class="sectlevel2">
<li><a href="#-defining-schedulers">14.1. Defining Schedulers</a></li>
<li><a href="#sec:process-attributes">14.2. Processes and Process Attributes</a></li>
<li><a href="#-using-schedulers">14.3. Using Schedulers</a></li>
</ul>
</li>
<li><a href="#sec:deployment">15. Deployment and Resource Modeling</a>
<ul class="sectlevel2">
<li><a href="#sec:cloudprovider">15.1. The CloudProvider API</a></li>
<li><a href="#sec:deployment-components">15.2. Deployment Components</a></li>
<li><a href="#sec:resources">15.3. Resource Types</a></li>
<li><a href="#-modeling-resource-usage">15.4. Modeling Resource Usage</a></li>
</ul>
</li>
<li><a href="#-software-product-line-engineering">16. Software Product Line Engineering</a>
<ul class="sectlevel2">
<li><a href="#-delta-oriented-programming">16.1. Delta-Oriented Programming</a></li>
<li><a href="#-the-feature-model">16.2. The Feature Model</a></li>
<li><a href="#-software-product-lines-and-products">16.3. Software Product Lines and Products</a></li>
</ul>
</li>
<li><a href="#-abs-backends">17. ABS Backends</a>
<ul class="sectlevel2">
<li><a href="#sec:java-backend">17.1. Java Backend</a></li>
<li><a href="#sec:erlang-backend">17.2. Erlang Backend</a></li>
<li><a href="#-maude-backend">17.3. Maude Backend</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="-introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="-the-abs-language">1.1. The ABS Language</h3>
<div class="paragraph">
<p>The <strong>ABS language</strong> is an actor-based, object-oriented, executable modeling
language.  Its prime features are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Algebraic user-defined data types and side effect-free functions </dt>
<dd>
<p>All data
(except the state of objects and future variables) is immutable, and functions
are free of side effects.  This makes understanding and reasoning about models
easier.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>User-defined data types are used for data modeling instead of objects, so ABS
models are typically smaller than their Java counterparts.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A syntax that is close to Java </dt>
<dd>
<p>Programmers that are used to Java can easily
learn the ABS language.</p>
</dd>
<dt class="hdlist1">Distributed, actor-based semantics </dt>
<dd>
<p>Method calls are asynchronous and create
a new process in the target.  Processes are scheduled cooperatively and run
within the scope of one object.  Futures are used to synchronize with and get
the result of another process.</p>
</dd>
<dt class="hdlist1">Interfaces for specifying object behavior </dt>
<dd>
<p>Similar to Java, the behavior of
a class is defined by implementing zero or more interfaces with their
corresponding methods.</p>
</dd>
<dt class="hdlist1">Safe concurrency </dt>
<dd>
<p>Processes run cooperatively within one object and do not
have access to other objects' state, and data structures are immutable.  The
most common error causes of concurrent systems (aliasing, insufficient
locking) are avoided by the language semantics.</p>
</dd>
<dt class="hdlist1">Distributed computing </dt>
<dd>
<p>The combination of asynchronous method calls,
immutability and strong encapsulation makes it very easy to model distributed
systems.</p>
</dd>
<dt class="hdlist1">A formal semantics and compositional proof theory </dt>
<dd>
<p>ABS is designed to be
amenable to program analysis and verification.  A variety of tools (deadlock
checker, resource analysis, formal verification) have been developed.</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Non-goals</div>
<div class="paragraph">
<p>Languages are eco-systems, and a language containing all possible features
will be easy to use for no one.  The following areas are currently
under-served by ABS:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Parallel computing </dt>
<dd>
<p>Algorithms relying on multiple processes operating on
mutable state, e.g., from the domain of scientific computing, can only be
expressed in roundabout ways.</p>
</dd>
<dt class="hdlist1">Close-to-the-metal programming </dt>
<dd>
<p>ABS is not designed to be a systems
programming language.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:concurrency-model">1.2. The ABS Actor and Concurrency Model</h3>
<div class="paragraph">
<p>As mentioned, ABS method calls are asynchronous and create a new process in
the target, while the caller process continues to run in parallel, as shown in
Figure <a href="#fig-future-await">Process call semantics</a>.  At point ①, P1 issues an asynchronous call to
some object residing on another cog.  In response, a new process P2 is
created; P1 and P2 can run in parallel.  At point ②, P1 needs the result of
the method call and suspends itself.  At point ③, P2 finishes and returns a
value.  P1’s cog then reactivates P1 to continue execution.</p>
</div>
<div id="fig-future-await" class="imageblock">
<div class="content">
<img src="images/ABS-future-await.png" alt="Process call semantics" width="636" height="233">
</div>
<div class="title">Figure 1. Process call semantics</div>
</div>
<div class="paragraph">
<p>The paragraph above elides some details.  An asynchronous method call (see
<a href="#async-call-expression">Asynchronous Method Calls</a>) produces a <em>future variable</em>, which is used both to
synchronize with the callee process (see <a href="#await-stmt">Await (Statement)</a>) and to get the result
(see <a href="#get-expression">Get</a>).  Future variables are first-class objects that can
be passed along, so multiple processes can synchronize on the same future.</p>
</div>
<div class="paragraph">
<p>The processes created by method calls are scheduled cooperatively and run
within the scope of the target object.  Objects are grouped into COGs
(Concurrent Object Groups).  Each cog runs one process at a time, while
processes on different cogs run in parallel, as shown in Figure
<a href="#fig-cog-scheduling">Processes running inside their cogs</a>.  This means that each cog is a <strong>unit of concurrency</strong>
and is in charge of scheduling the processes running on its objects.  Each
process runs until it suspends itself (see <a href="#await-stmt">Await (Statement)</a> and
<a href="#suspend-stmt">Unconditional Release: Suspend</a>) or terminates, at which point the cog chooses the next
process to run.</p>
</div>
<div id="fig-cog-scheduling" class="imageblock">
<div class="content">
<img src="images/ABS-scheduling.png" alt="Processes running inside their cogs" width="636" height="283">
</div>
<div class="title">Figure 2. Processes running inside their cogs</div>
</div>
<div class="paragraph">
<p>A new cog is created by creating an object with a <code>new</code> expression (see Figure
<a href="#fig-object-new-cog">Creating an object in a new cog</a>).</p>
</div>
<div id="fig-object-new-cog" class="imageblock">
<div class="content">
<img src="images/new-cog-object.png" alt="Creating an object in a new cog" width="565" height="151">
</div>
<div class="title">Figure 3. Creating an object in a new cog</div>
</div>
<div class="paragraph">
<p>An object in an existing cog is created via the <code>new local</code> expression (see Figure
<a href="#fig-object-new-local">Creating an object in the same cog</a>).</p>
</div>
<div id="fig-object-new-local" class="imageblock">
<div class="content">
<img src="images/new-local-object.png" alt="Creating an object in the same cog" width="593" height="154">
</div>
<div class="title">Figure 4. Creating an object in the same cog</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:error-model">1.3. Error Propagation and Recovery in ABS</h3>
<div class="paragraph">
<p>ABS models exceptional (unforeseen and erroneous) situations using exceptions.
This section gives an overview of the language constructs that deal with
exception propagation and recovery.</p>
</div>
<div class="paragraph">
<p>Exceptions occur when a process cannot continue normal execution, e.g., when
trying to divide by zero or when no pattern in a <code>case</code> expression matches the
given value.  Exceptions can also be thrown by the modeler via the <code>throw</code>
statement: <a href="#throw-statement">Throw</a>.  Exceptions thrown implicitly or explicitly
are propagated and handled in the same way.</p>
</div>
<div class="paragraph">
<p>The modeler can define new exceptions; see <a href="#sec:exception-types">Exceptions</a>.</p>
</div>
<div class="paragraph">
<p>Exceptions can be caught and handled locally, i.e., in a lexically enclosing
<code>try</code>-<code>catch</code>-<code>finally</code> block in the same method (see <a href="#try-catch-finally-stmt">Handling Exceptions with Try-Catch-Finally</a>).
In that case, the process continues execution and will eventually produce a
return value to its future.</p>
</div>
<div class="paragraph">
<p>In case of an <em>unhandled</em> exception, the future of the process does not
receive a return value; instead, it will propagate the unhandled exception to
the caller (or any process that tries to get its value).  When evaluating
<code>f.get</code> on a future that carries an exception instead of a normal return
value, the exception will be <em>re-thrown</em>; it can be handled as usual via
<code>try</code>-<code>catch</code> or left to propagate up the call chain of futures.</p>
</div>
<div class="paragraph">
<p>Additionally, terminating a process in the middle of execution might leave its
object in an inconsistent state.  To recover from this, ABS uses <em>recovery
blocks</em> (see <a href="#sec:classes">Classes</a>).  Unhandled exceptions are handed to the
recovery block, which can take appropriate action to re-establish the class
invariant and/or send asynchronous messages to other objects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-lexical-structure">2. Lexical Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the lexical structure of the ABS language.  We use the
following EBNF conventions for specifying the syntax of ABS elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. EBNF syntax for this manual</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>typewriter text</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminal symbols (occurring in program source code)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>CursiveText</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-terminals (production rule names)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Separator between left hand side and right hand side of a rule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">|</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant; either of the element(s) separated by |</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionals; the enclosed elements can be omitted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ }</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repetition; zero or more occurrences of the enclosed elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">? ?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Special group (elements in the group are specified informally)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[: :]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A character class, as in extended regular expression syntax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">( )</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grouping</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="-line-terminators-and-white-spaces">2.1. Line Terminators and White Spaces</h3>
<div class="paragraph">
<p>Line terminators and white spaces are defined as in Java.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>LineTerminator</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\n</code> | <code>\r</code> | <code>\r\n</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>WhiteSpace</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>LineTerminator</em> | <code>␣</code> | <code>\t</code> | <em>Comment</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="-comments">2.2. Comments</h3>
<div class="paragraph">
<p>ABS supports the two common Java-style styles of comments: end-of-line comments and block comments.</p>
</div>
<div class="paragraph">
<p>An end-of-line comment starts with two slashes, e.g., <code>// text</code>. All text that follows <code>//</code> until the end of the line is treated as a comment.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Comment</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>LineComment</em> | <em>BlockComment</em><br></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>LineComment</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>//</code> { ? characters except <em>LineTerminator</em> ? } <em>LineTerminator</em><br></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>BlockComment</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/*</code> { ? characters except <code>*/</code> ? } <code>*/</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>// this is a comment
module A; // this is also a comment</code></pre>
</div>
</div>
<div class="paragraph">
<p>A block comment is enclosed in <code>/* */</code>,
e.g., <code>/* this is a comment */</code>.  Block comments can span
multiple lines and do not nest.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>/* this
is a multiline
comment */</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-identifiers">2.3. Identifiers</h3>
<div class="paragraph">
<p>Identifiers consist of a letter followed by a sequence of letters,
numbers and underscores (<code>_</code>).</p>
</div>
<div class="paragraph">
<p>ABS distinguishes identifiers and type identifiers.  Identifiers start
with a lower-case character, type identifiers start with an upper-case
character.  Identifiers name local variables, fields, methods and functions.
Type identifiers name interfaces, classes, types, type
constructors, deltas and products.</p>
</div>
<div class="paragraph">
<p>Identifiers can be <em>qualified</em> with a module name (see <a href="#sec:modules">Modules</a>) or
<em>simple</em> (without module name prefix).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SimpleIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[: lower :] { [: alpha :] | [: digit :] | <code>_</code> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SimpleTypeIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[: upper :] { [: alpha :] | [: digit :] | <code>_</code> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>QualifiedIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ <em>SimpleTypeIdentifier</em> <code>.</code> } <em>SimpleIdentifier</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>QualifiedTypeIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ <em>SimpleTypeIdentifier</em> <code>.</code> } <em>SimpleTypeIdentifier</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Identifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SimpleIdentifier</em> | <em>QualifiedIdentifier</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TypeIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SimpleTypeIdentifier</em> | <em>QualifiedTypeIdentifier</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="-keywords">2.4. Keywords</h3>
<div class="paragraph">
<p>The following words are keywords in the ABS language and are invalid as identifiers.</p>
</div>
<table class="tableblock frame-all grid-none stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assert</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>await</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>builtin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>case</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catch</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>def</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delta</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>die</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>else</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exception</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>export</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>extends</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>features</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>finally</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hasField</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hasInterface</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hasMethod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>in</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>let</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modifies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>module</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>new</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>original</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>product</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>productline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>recover</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>removes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>return</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>suspend</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>this</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>throw</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trait</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>try</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uses</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="sec:literals">2.5. Literals</h3>
<div class="paragraph">
<p>A literal is a textual representation of a value. ABS supports integer
literals, floating-point literals, string literals, and the null literal.
Rational numbers are written using the division operator <code>/</code>, e.g., <code>1/4</code> for
one quarter.</p>
</div>
<div class="paragraph">
<p>Strings are enclosed in double quotes (<code>"</code>).  Line feed in a string is written
as <code>\n</code>, carriage return as <code>\r</code>.</p>
</div>
<div class="paragraph">
<p>The null literal is written as <code>null</code>.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Literal</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>IntLiteral</em> | <em>FloatLiteral</em> | <em>StringLiteral</em> |</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>IntLiteral</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code> | ( ( <code>1</code> | &#8230;&#8203; | <code>9</code> ) { [: digit :] } )</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FloatLiteral</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ <em>IntLiteral</em> ] <code>.</code> [: digit :] { [: digit :] } [ ( <code>e</code> | <code>E</code> ) [ <code>-</code> | <code>+</code> ] <em>IntLiteral</em> ]</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>StringLiteral</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"</code> { ? <em>Valid String Character</em> ? } <code>"</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Valid string characters are defined as in the Java language.</p>
</div>
</div>
<div class="sect2">
<h3 id="-annotations">2.6. Annotations</h3>
<div class="paragraph">
<p>Annotations consist of a syntactically valid pure expression, optionally
preceded by a type identifier (the “tag”) and a colon (<code>:</code>).  They can be put
in front of statements and definitions.  Annotations are enclosed in square
brackets (<code>[]</code>).</p>
</div>
<div class="paragraph">
<p>There can be more than one annotation in one place.  When annotating a place
with more than one annotation, writing the annotations in separate pairs of
brackets or separated by commas in one pair of brackets produces the same
effect.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AnnotationFragment</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ <em>TypeIdentifier</em> <code>:</code> ] <em>PureExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Annotation</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ <code>[</code> <em>Annotationfragment</em> { <code>,</code> <em>AnnotationFragment</em> } <code>]</code> }</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Annotations are used to write auxiliary information that can be used by
various tools.  Unknown (user-defined) annotations are ignored by the
tool chain.  Pre-defined annotations are usually type-checked.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>[Near] class Example { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is an example of annotations with a tag:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>[Cost: 15, Deadline: Duration(20)] o!m();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same annotations, written in separate brackets:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>[Cost: 15] [Deadline: Duration(20)] o!m();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Annotations are associated with the following language construct.  In the
examples above, the first annotation pertains to the class definition of
<code>Example</code>, the second annotation pertains to the asynchronous method call
<code>o!m()</code>.</p>
</div>
<div class="paragraph">
<p>In general, it is not an error to have more than one annotation with the same
tag in the same place.  However, some pre-defined annotations might forbid
this.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-types">3. Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ABS has a static, nominal type system.  Local variables, object fields,
function parameters and method parameters are statically typed.  A type name
can refer to a algebraic data type, an interface, a type synonym.  There are a
number of pre-defined data types which are documented in Chapter <a href="#sec:standard-library">The Standard Library</a>.</p>
</div>
<div class="paragraph">
<p>A <em>type name</em> is a sequence of letters, digits and  underscores (<code>_</code>) starting
with an uppercase letter.  In case of a parametric data type, the type name
continues with a left angle (<code>&lt;</code>), a list of type names separated by commas
and ends with a right angle (<code>&gt;</code>).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Type</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeIdentifier</em> [ <code>&lt;</code> <em>Type</em> { <code>,</code> <em>Type</em> } <code>&gt;</code> ]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>New types are defined as either <em>interfaces</em> or <em>algebraic data types</em>.
Algebraic data types can be <em>parametric</em>, which is useful for defining
“container-like” data types.  Currently only algebraic data types can be
parameterized, i.e., ABS does not currently offer class templates.</p>
</div>
<div class="paragraph">
<p>Note that classes are not types in ABS; object references are typed by an
interface that the object’s class implements.  (Classes that do not implement
any interfaces can be instantiated, and can interact with the rest of the
system via their <code>run</code> method and constructor arguments.)</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>String <i class="conum" data-value="1"></i><b>(1)</b>
A_s1mple_type <i class="conum" data-value="2"></i><b>(2)</b>
Map&lt;Int, List&lt;String&gt;&gt; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The type name is <code>String</code>.  The string type is defined in the standard library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is a type name containing underscores and digits.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This type name denotes a map from integers to lists of strings.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sec:builtin-types">3.1. Built-in Types</h3>
<div class="paragraph">
<p>ABS offers the following built-in datatypes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. ABS built-in types</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The empty (void) type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-unit">Unit</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code>, <code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-bool">Boolean values</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integers of arbitrary size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code>, <code>-15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-numbers">Numbers</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rational numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1/5</code>, <code>22/58775</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-numbers">Numbers</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floating-point numbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0.5</code>, <code>1.0e-15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-numbers">Numbers</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"Hello world\n"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-string">Strings</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Fut&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Futures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-future">The Future Type</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Destiny</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supertype of all futures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-destiny">The Destiny Type</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Exception</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exceptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DivisionByZeroException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:exception-types">Exceptions</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lists of values of type <code>A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list[1, 2, 3]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-list">Lists</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Set&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets of values of type <code>A</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>set[True, False]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-set">Sets</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;A,B&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maps from type <code>A</code> to <code>B</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>map[Pair(1, True)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-map">Maps</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pair&lt;A,B&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pairs of values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pair(1, True)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-pair">Pairs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Triple&lt;A,B,C&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triples of values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Triple(1, "hi", True)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-triple">Triples</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Maybe&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Just(True)</code>, <code>Nothing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#type-optionals">Optionals</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>Int</code> type is a subtype of <code>Rat</code>; this means that <code>Int</code> values are assignable
to places of type <code>Rat</code>.  Rational values can be converted to integers via the
<code>truncate</code> function.  <code>Float</code> is a distinct numeric type.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Support for floating-point calculations is under development;
calculations resulting in <code>Inf</code> or <code>NaN</code> currently have unspecified runtime
behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The future type <code>Fut&lt;A&gt;</code> is a special built-in type that denotes that an ABS
value of type <code>A</code> will become available in the future.  The value that a
future holds and will return can be of any concrete type.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;String&gt; <i class="conum" data-value="1"></i><b>(1)</b>
Fut&lt;List&lt;Rat&gt;&gt; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This future will contain a value of type <code>String</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This future will contain a list of rational numbers</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:algebraic-data-types">3.2. Algebraic Data Types</h3>
<div class="paragraph">
<p>Algebraic Data Types in ABS are used to implement user-defined, immutable data
values.  Because values of algebraic data types are immutable, they can be
safely passed on to other objects and cogs and make it easy to reason about
program correctness.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DataTypeDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data</code> <em>SimpleTypeIdentifier</em> [ <em>TypeParams</em> ] [ <code>=</code> <em>DataConstr</em> { <code>|</code> <em>DataConstr</em> } ] <code>;</code><br></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TypeParams</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code> <em>SimpleTypeIdentifier</em> { <code>,</code> <em>SimpleTypeIdentifier</em> } <code>&gt;</code><br></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DataConstr</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SimpleTypeIdentifier</em> [ <code>(</code> <em>Type</em> [ <em>SimpleIdentifier</em> ] { <code>,</code> <em>Type</em> [ <em>SimpleIdentifier</em> ] } <code>)</code> ]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Data Type <em>Constructors</em> enumerate the possible values of a data type.
Constructors can have zero or more arguments.  Each argument can have an
optional accessor function (see <a href="#sec:accessor-functions">Accessor Functions</a>).</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>data IntList = NoInt | ConsInt(Int head, IntList tail); <i class="conum" data-value="1"></i><b>(1)</b>
data Bool = True | False; <i class="conum" data-value="2"></i><b>(2)</b>
data NotInstantiable; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The data type <code>IntList</code> has two constructors: <code>NoInt</code> and <code>ConsInt</code>.  The second constructor defines two accessor functions.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is the definition of the built-in data type <code>Bool</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This type does not have constructors and therefore cannot be instantiated.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:accessor-functions">Accessor Functions</h4>
<div class="paragraph">
<p>Data constructor arguments can optionally have a name, which needs to be a
valid identifier.  If a name is given, it defines a function that, when passed a
value expressed with the given constructor, return the argument.</p>
</div>
<div class="paragraph">
<p>The name of an accessor function must be unique in the module it is
defined in.  It is an error to have a function definition with the same name as an accessor
function or to have multiple accessor functions with the same name, unless they
belong to the same data type.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>data Person = Person(String name, Int age);
{
  Person john = Person("John", 34);
  Int age = age(john); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The call to <code>age</code> returns 34.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="-parametric-data-types">Parametric Data Types</h4>
<div class="paragraph">
<p>Algebraic data types can carry <em>type parameters</em>.  Data types with type
parameters are called <em>parametric data types</em>.</p>
</div>
<div class="paragraph">
<p>Parametric Data Types are useful to define “container” data types, such as
lists, sets or maps. Parametric data types are declared like normal data types
but have an additional type parameter section inside broken brackets (<code>&lt;</code> <code>&gt;</code>)
after the data type name.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>data List&lt;A&gt; = Nil | Cons(A, List&lt;A&gt;);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using a parametric data type, concrete types are given for the type parameters.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>List&lt;Int&gt; l = Cons(1, Cons(2, Nil));</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:n_ary-constructors">N-ary Constructors</h4>
<div class="paragraph">
<p>Literal values of recursive data types like lists and sets can be arbitrarily
long, and nested constructor expressions can become unwieldy.  ABS provides a
special syntax for n-ary constructors, which are transformed into constructor
expressions via a user-supplied function.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; set&lt;A&gt;(List&lt;A&gt; l) = <i class="conum" data-value="1"></i><b>(1)</b>
    case l {
       Nil =&gt; EmptySet
       | Cons(x,xs) =&gt; insertElement(set(xs), x)
    };

{
  Set&lt;Int&gt; s1 = set(Cons(1, Cons(2, Cons(3, Nil)))); <i class="conum" data-value="2"></i><b>(2)</b>
  Set&lt;Int&gt; s = set[1, 2, 3]; <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The parametric function <code>set</code> is defined to take a list of elements and return a set.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>set</code> is called with a literal list constructed as normal.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>set</code> is called with the special n-ary constructor syntax.  The two calls return the same value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The constructor function usually has the same name as the type it is
constructing.  For example, a value of type <code>Set</code> is constructed via the
function <code>set</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="-fully-abstract-data-types">Fully Abstract Data Types</h4>
<div class="paragraph">
<p>Using the module system it is possible to define abstract data types.  For an
abstract data type, only the functions that operate on them are known to the
client, but not its constructors.  This can be easily realized in ABS by
putting such a data type in its own module and by only exporting the data type
and its functions, without exporting the constructors.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-interface-types">3.3. Interface Types</h3>
<div class="paragraph">
<p>Interfaces in ABS describe the functionality of objects.  Thus, Interfaces in
ABS are similar to interfaces in Java.  Unlike Java, object references are
typed by interfaces and not by their class.  See <a href="#typecheck-expression">Type-Check Expressions</a> and
<a href="#typecast-expression">Type-Cast Expressions</a> for how to obtain a reference to the same object via a
different interface.</p>
</div>
<div class="paragraph">
<p>The syntax of interfaces is given in <a href="#sec:interfaces">Interfaces</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:exception-types">3.4. Exceptions</h3>
<div class="paragraph">
<p>In higher-level programming languages, exceptions are generally used to signal
an <em>erroneous</em> or <em>abnormal</em> runtime behavior of the program, that should be
treated (handled) separately compared to normal values.</p>
</div>
<div class="paragraph">
<p>Exceptions are declared with the keyword <code>exception</code>, followed by the name of
an exception and an optional list of parameters.  The semantics are the same
as for defining data constructors; naming a parameter will create an accessor
function (see <a href="#sec:accessor-functions">Accessor Functions</a>).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ExceptionDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exception</code> <em>SimpleTypeIdentifier</em>  [ ( <em>Type</em> [ <em>SimpleIdentifier</em> ] { , <em>Type</em> [ <em>SimpleIdentifier</em> ] } ) ] <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Like any other constructor or datatype name, exceptions always start with an
upper-case letter.</p>
</div>
<div class="paragraph">
<p>Exceptions are of type <code>ABS.StdLib.Exception</code>, which is pre-defined in the
standard library.  It is possible to store exception values in variables of
type <code>Exception</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>exception MyException;
exception MyOtherException(String param, Int); // no accessor for second param</code></pre>
</div>
</div>
<div class="paragraph">
<p>In ABS, exceptions are first-class values; the user can construct
exception-values, assign them to variables, pass them in expressions, etc.  An
exception can be thrown via the <code>throw</code> statement (see <a href="#throw-statement">Throw</a>)
and be caught in a <code>catch</code> block (see <a href="#try-catch-finally-stmt">Handling Exceptions with Try-Catch-Finally</a>).
Additionally, the object itself can recover its invariant after an uncaught
exception in a process via its recovery block (see <a href="#sec:classes">Classes</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="-type-synonyms">3.5. Type Synonyms</h3>
<div class="paragraph">
<p>A <em>Type Synonym</em> is an alternative type name for a type.  Type synonyms are
introduced with the keyword <code>type</code>.  Parametric type synonyms are not
currently supported.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TypeSynDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code> <em>SimpleTypeIdentifier</em> <code>=</code> <em>Type</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>type Filename = String;
type Filenames = Set&lt;Filename&gt;;
type Servername = String;
type Packet = String;
type File = List&lt;Packet&gt;;
type Catalog = List&lt;Pair&lt;Servername,Filenames&gt;&gt;;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-location-types">3.6. Location Types</h3>
<div class="paragraph">
<p>A <em>Location Type</em> is an interface type annotated with a location.  The
location is seen relative to the current context, and can be one of
the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. ABS built-in types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Far</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The object is on a different cog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Near</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The object is on the same cog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Somewhere</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The object is either <code>Near</code> or <code>Far</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Infer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Have the type-checker infer the location</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When location type checking is active, the following example is
erroneous, and will result in a type error:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>interface I { }
class C {
    [Far] I m([Near] I o) {
        return o; <i class="conum" data-value="1"></i><b>(1)</b>
    }
    [Somewhere] I m2([Near] I o) {
        return o; <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here, <code>o</code> is of type <code>[Near] I</code>, which cannot be converted to the return type <code>[Far] I</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here, <code>o</code>’s type <code>[Near] I</code> can be converted to <code>[Somewhere] I</code>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-expressions">4. Expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter specifies all ABS expressions.  Expressions are usually evaluated
for their value, although they can be used inside annotations as purely
syntactic constructs that do not need to follow standard evaluation rules.</p>
</div>
<div class="paragraph">
<p>ABS expressions can either be pure or have side effects. <em>Pure expressions</em>
only refer to entities in the functional and expression layer.  They can be
evaluated multiple times without influencing the execution of the imperative
and object oriented layers of ABS.  Pure expressions can be sub-expressions of
other expressions and can be used as function bodies.  <em>Side-effect
expressions</em>, on the other hand, refer to semantic entities “above” the
functional layer (objects and futures).  They are only legal “stand-alone”
(i.e., not as a sub-expression of another expression) and in certain places,
mostly in the right-hand side of an assignment.  This strict separation of
pure and side-effect expressions simplifies the language, for
example wrt. using expressions inside annotations and reasoning about
expressions in static analysis tools.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Exp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> | <em>EffExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>PureExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SimpleIdentifier</em><br>
 | <code>this</code> <code>.</code> <em>SimpleIdentifier</em><br>
 | <code>this</code><br>
 | <code>destiny</code><br>
 | <em>Literal</em><br>
 | <em>TemplateString</em><br>
 | <em>LetExp</em><br>
 | <em>DataConstrExp</em><br>
 | <em>FnAppExp</em><br>
 | <em>FnAppListExp</em><br>
 | <em>ParFnAppExp</em><br>
 | <em>WhenExp</em><br>
 | <em>CaseExp</em><br>
 | <em>OperatorExp</em><br>
 | <em>TypeCheckExp</em><br>
 | <em>TypeCastExp</em><br>
 | <code>(</code> <em>PureExp</em> <code>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>EffExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>NewExp</em><br>
 | <em>SyncCall</em><br>
 | <em>AsyncCall</em><br>
 | <em>GetExp</em><br>
 | <em>AwaitExp</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="-literals">4.1. Literals</h3>
<div class="paragraph">
<p>Literals, as defined in <a href="#sec:literals">Literals</a>, are expressions.</p>
</div>
</div>
<div class="sect2">
<h3 id="-template-strings">4.2. Template Strings</h3>
<div class="paragraph">
<p>Template strings are strings allowing embedded expressions.  In
contrast to normal string literals, template strings can contain
linebreaks and other special characters.</p>
</div>
<div class="paragraph">
<p>A template string starts and ends with a backtick (<code>`</code>) character.  A
template string can contain zero or more pure expressions enclosed by
dollar signs (<code>$</code>).  These expressions will be replaced by their
string representation (as with the function <code>toString</code>) every time the
template string is evaluated.</p>
</div>
<div class="paragraph">
<p>The only characters that need to be escaped by a backslash (<code>\</code>) in a
template string are the backtick (<code>`</code>) and the dollar sign (<code>$</code>).  All
other characters, including line breaks and the backslash itself, do
not need to be specially treated when writing a template string.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TemplateString</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>` { ? <em>Valid String Character</em> ? } </code>`<br></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>`  { ? <em>Valid String Character</em> ? } <code>$</code> <em>PureExp</em> <code>$</code>
                              { { ? <em>Valid String Character</em> ? } <code>$</code> <em>PureExp</em> <code>$</code> }
                              { ? <em>Valid String Character</em> ? } </code>`</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>`Hello $name$!
The price is \$$price$.`</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this expression will be a string with two lines, and with the values of the local variables <code>name</code> and <code>price</code> in place.</p>
</div>
</div>
<div class="sect2">
<h3 id="-operator-expressions">4.3. Operator Expressions</h3>
<div class="paragraph">
<p>ABS has a range of unary and binary operators working on pre-defined
datatypes.  All operators are pure (side effect-free).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>OperatorExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>UnaryExp</em> | <em>BinaryExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>UnaryExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>UnaryOp</em> <em>PureExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>UnaryOp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code> | <code>-</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>BinaryExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <em>BinaryOp</em> <em>PureExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>BinaryOp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>||</code> | <code>&amp;&amp;</code> | <code>==</code> | <code>!=</code> | <code>&lt;</code> | <code>&lt;=</code> | <code>&gt;</code> | <code>&gt;=</code> | <code>+</code> | <code>-</code> | <code>*</code> | <code>/</code> | <code>%</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following table describes the meaning as well as the associativity and the
precedence of the different operators. The list is sorted from low precedence
to high precedence.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. ABS Operators</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Associativity</th>
<th class="tableblock halign-left valign-top">Argument types</th>
<th class="tableblock halign-left valign-top">Result type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 || e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &amp;&amp; e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 == e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 != e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inequality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &lt; e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &lt;= e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &gt; e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &gt;= e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 + e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">concatenation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 + e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 - e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subtraction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 * e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 / e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">division</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rat</code> or <code>Float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 % e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">modulo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!e</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical negation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">right</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-e</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer negation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">right</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="-semantics-of-comparison-operators">Semantics of Comparison Operators</h4>
<div class="paragraph">
<p>ABS has generic equality and less-than comparison between two values of the
same type.</p>
</div>
<div class="paragraph">
<p>Equality and inequality comparison is standard: by value for functional
datatypes and by reference for objects and futures.  I.e., two strings
<code>"Hello"</code> compare as identical via <code>==</code>, as do two sets containing identical
values.  Two references to objects or futures compare as identical via <code>==</code> if
they point to the same object or future.  The inequality operator <code>!=</code>
evaluates to <code>True</code> for any two values that compare to <code>False</code> under <code>==</code> and
vice versa.</p>
</div>
<div class="paragraph">
<p>For the comparison operator <code>&lt;</code>, an ordering is defined in the following way.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Numbers compare as usual.</p>
</li>
<li>
<p>Strings compare lexicographically.</p>
</li>
<li>
<p>Algebraic datatypes compare first by constructor name, then by comparing
constructor arguments left to right.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>Cons(_, _) &lt; Nil
Cons(1, _) &lt; Cons(2, _)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Objects and futures are compared by identity, in an implementation-specific
but stable way.  This means that for any two variables <code>a</code> and <code>b</code> that
point to different objects, the value of <code>a &lt; b</code> does not change as long as
<code>a</code> and <code>b</code> are not re-assigned.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>
The value <code>null</code> compares less than any other object reference.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-let">4.4. Let</h3>
<div class="paragraph">
<p>The expression <code>let T v = p in b</code> evaluates <code>b</code>, with <code>v</code> bound to the value
of evaluating the expression <code>p</code>.  The newly-introduced binding of <code>v</code> can
shadow a binding of <code>v</code> outside of the <code>let</code> expression.</p>
</div>
<div class="paragraph">
<p>More than one binding can be established in one <code>let</code> expression.
Bindings are evaluated sequentially, i.e., later bindings can use
earlier variables in their value expression.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>LetExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>let</code> <em>Type</em> <em>SimpleIdentifier</em> <code>=</code> <em>PureExp</em><br>
{ <code>,</code> <em>Type</em> <em>SimpleIdentifier</em> <code>=</code> <em>PureExp</em> }<br>
<code>in</code> <em>PureExp</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let Int x = 2 + 2, Int y = x + 1 in y * 2 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The value of this expression is 10 (<code>((2 + 2) + 1) * 2</code>)</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-data-constructor-expressions">4.5. Data Constructor Expressions</h3>
<div class="paragraph">
<p>Data Constructor Expressions are expressions that create data values by
applying arguments to data type constructors.  Data constructor expressions
look similar to function calls, but data constructors always start with an
upper-case letter.</p>
</div>
<div class="paragraph">
<p>For data type constructors without parameters, the parentheses are optional.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DataConstrExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeIdentifier</em> [ <code>(</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>)</code> ]</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>True
Cons(True, Nil)
Nil</code></pre>
</div>
</div>
<div class="paragraph">
<p>Defining new data types and their constructors is described in
<a href="#sec:algebraic-data-types">Algebraic Data Types</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="-function-calls">4.6. Function Calls</h3>
<div class="paragraph">
<p>Function calls apply arguments to functions, producing a value.  Function call
expressions look similar to data constructor expressions, but function names
always start with a lower-case letter.  The parentheses are mandatory in
function calls.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FnAppExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Identifier</em> <code>(</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>tail(Cons(True, Nil))
head(list)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="-n-ary-function-calls">N-ary Function Calls</h4>
<div class="paragraph">
<p>Calls to n-ary Constructors (see <a href="#sec:n_ary-constructors">N-ary Constructors</a>) are written with
brackets (<code>[]</code>) instead of parentheses (<code>()</code>).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FnAppListExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Identifier</em> <code>[</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>]</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-partially-defined-function-calls">4.7. Partially-Defined-Function Calls</h3>
<div class="paragraph">
<p>Calls to partially defined functions (see <a href="#sec:partially-defined-functions">Partial Function Definitions</a>) are similar to
function call expressions, but have an additional prepended set of arguments.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ParFnAppExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Identifier</em><br>
  <code>(</code> <em>ParFnAppParam</em> { <code>,</code> <em>ParFnAppParam</em> } <code>)</code><br>
  <code>(</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ParFnAppParam</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Identifier</em><br>
                  | <em>AnonymousFunction</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AnonymousFunction</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em>  } ]  <code>)</code> <code>=></code> <em>PureExp</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>map(toString)(list[1, 2])
filter((Int i) =&gt; i &gt; 0)(list[0, 1, 2])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-conditional-expressions">4.8. Conditional Expressions</h3>
<div class="paragraph">
<p>The value of the conditional expression <code>when c then e1 else e2</code> is either the
value of <code>e1</code> or the value of <code>e2</code>, depending on the value of <code>c</code>, which must
be of type <code>Bool</code>.  Depending on the value of <code>c</code>, either <code>e1</code> or <code>e2</code> is
evaluated, but not both.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>WhenExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>when</code> <em>PureExp</em> <code>then</code> <em>PureExp</em> <code>else</code> <em>PureExp</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>when 5 == 4 then True else False</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="case-expression">4.9. Case</h3>
<div class="paragraph">
<p>ABS supports pattern matching via the Case Expression.  A case expression
consists of an input expression and one or more branches, each consisting of a
pattern and a right hand side expression.</p>
</div>
<div class="paragraph">
<p>The case expression evaluates its input expression and attempts to match the
resulting value against the branches until a matching pattern is found.  The
value of the case expression itself is the value of the expression on the
right-hand side of the first matching pattern.</p>
</div>
<div class="paragraph">
<p>If no pattern matches the expression, a <code>PatternMatchFailException</code> is thrown.</p>
</div>
<div class="paragraph">
<p>There are four different kinds of patterns available in ABS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Variables (with different semantics depending on whether the variable is bound or not)</p>
</li>
<li>
<p>Literal Patterns (e.g., <code>5</code>)</p>
</li>
<li>
<p>Data Constructor Patterns (e.g., <code>Cons(Nil,x)</code>)</p>
</li>
<li>
<p>Underscore Pattern (<code>_</code>)</p>
</li>
</ul>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>CaseExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>case</code> <em>PureExp</em> <code>{</code> <em>CaseExpBranch</em> { <code>|</code> <em>CaseExpBranch</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>CaseExpBranch</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Pattern</em> <code>=&gt;</code> <em>PureExp</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Pattern</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_</code><br>
                 | <em>SimpleIdentifier</em><br>
                 | <em>Literal</em><br>
                 | <em>ConstrPattern</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ConstrPattern</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeIdentifier</em> [ <code>(</code> [ <em>Pattern</em> { <code>,</code> <em>Pattern</em> }  ] <code>)</code> ]</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Older versions of the ABS language used the semicolon (<code>’</code>) to terminate
case branches.  This older syntax is still supported by the compiler.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="-variable-patterns">Variable Patterns</h4>
<div class="paragraph">
<p>Variable patterns are written as identifiers starting with a lower-case
letter.  If the identifier does not name a variable in the current scope, the
variable pattern matches any value and introduces a binding of the given
identifier to the matched value for the right-hand side of the branch and the
rest of the pattern itself.  In case a binding for that identifier is already
in scope, its value is compared to the value being matched against.</p>
</div>
<div class="paragraph">
<p>The variable being named by the variable pattern can be used in the
right-hand-side expression of the corresponding branch.  Typically, pattern
variables are used inside of data constructor patterns to extract values from
data constructors.  For example:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let (Pair&lt;Int, Int&gt; a) = Pair(5, 5) in
  case a {
    Pair(x, x) =&gt; x <i class="conum" data-value="1"></i><b>(1)</b>
    | Pair(x, y) =&gt; y <i class="conum" data-value="2"></i><b>(2)</b>
  } <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This branch matches a pair with identical values.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This branch matches every pair.  Since pairs with identical values are matched by the previous branch, <code>x</code> and <code>y</code> will be different.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The value of the whole expression is 5, produced by the first branch.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let (x = 7) in
  case Pair(5, 5) {
    Pair(x, x) =&gt; x <i class="conum" data-value="1"></i><b>(1)</b>
    | Pair(x, y) =&gt; y <i class="conum" data-value="2"></i><b>(2)</b>
    | Pair(y, z) =&gt; z <i class="conum" data-value="3"></i><b>(3)</b>
  } <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This pattern does not match since <code>x</code> is bound to 7 and does not match 5.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This pattern does not match either, for the same reason.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This pattern contains only unbound variable patterns and therefore matches.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The value of the whole expression is 5, produced by the third branch.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="-literal-patterns">Literal Patterns</h4>
<div class="paragraph">
<p>Literals can be used as patterns.  The pattern matches if the value of the
case expression is equal to the literal value.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let (Pair&lt;Int, Int&gt; a) = Pair(5, 5) in
  case a {
    Pair(3, x) =&gt; x <i class="conum" data-value="1"></i><b>(1)</b>
    | Pair(x, y) =&gt; y <i class="conum" data-value="2"></i><b>(2)</b>
  } <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The pattern <code>3</code> does not match the value in the first position of the <code>Pair</code> constructor pattern.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This pattern matches.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The value of the whole expression is 5, produced by the second branch.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="-data-constructor-patterns">Data Constructor Patterns</h4>
<div class="paragraph">
<p>A data constructor pattern is written like a standard data constructor expression.
Constructor arguments are again patterns.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let (List&lt;Int&gt; l) = list[1, 2, 3] in
  case l {
    Nil =&gt; 0 <i class="conum" data-value="1"></i><b>(1)</b>
    | Cons(1, _) =&gt; 15 <i class="conum" data-value="2"></i><b>(2)</b>
    | Cons(_, Cons(y, _)) =&gt; y <i class="conum" data-value="3"></i><b>(3)</b>
  } <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This pattern matches the empty list.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This pattern matches a list starting with the literal <code>1</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This pattern matches a list of at least length 2, and binds the second element to <code>y</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The value of the whole expression is 15, produced by the second branch.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="-the-wildcard-pattern">The Wildcard Pattern</h4>
<div class="paragraph">
<p>The wildcard pattern, written with an underscore (<code>_</code>) matches any value.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>let (List&lt;Int&gt; l) = list[1, 2, 3] in
  case l {
    Nil =&gt; True <i class="conum" data-value="1"></i><b>(1)</b>
    | _ =&gt; False <i class="conum" data-value="2"></i><b>(2)</b>
}; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This pattern matches the empty list.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This pattern matches anything.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The value of the whole expression is <code>False</code>, produced by the second branch.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The wildcard pattern can be used as the last pattern in a case expression to
define a default case.</p>
</div>
<div class="paragraph">
<div class="title">Typing of Case Expressions</div>
<p>A case expression is type-correct if and only if all its expressions and all
its branches are type-correct and the right-hand side of all branches have a
common super type.  This common super type is also the type of the overall case
expression.  A branch (a pattern and its expression) is type-correct if its
pattern and its right-hand side expression are type-correct.  A pattern is
type-correct if it can match the corresponding case expression.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="typecheck-expression">4.10. Type-Check Expressions</h3>
<div class="paragraph">
<p>Variables pointing to objects are typed by interface, which means that the
concrete class of the referenced object might support more methods than can be
called through the reference.  The type-check expression checks if an object
implements the given interface.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TypeCheckExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <code>implements</code> <em>TypeIdentifier</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>interface I {}
interface J {}
class C implements I, J {}
{
  I o = new C();
  if (o implements J) {  // evaluates to True
    println("o is a J");
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="typecast-expression">4.11. Type-Cast Expressions</h3>
<div class="paragraph">
<p>Variables pointing to objects are typed by interface, which means that
the concrete class of the referenced object might support more methods
than can be called through the reference.  The type-cast expression
returns a reference of type <code>I</code> to the same object if it implements
the given interface <code>I</code>, or <code>null</code> otherwise.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TypeCastExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <code>as</code> <em>TypeIdentifier</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>interface I {}
interface J {}
class C implements I, J {}
class D implements I {}
{
  I o = new C();
  J j = o as J;  // j is an alias of o, with type J
  I o2 = new D();
  J j2 = o2 as J; // j2 is null
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-new">4.12. New</h3>
<div class="paragraph">
<p>A <code>new</code> expression creates a new object from a class name and a list of
arguments.  In ABS objects can be created in two different ways.  Either they
are created in the current COG, using the <code>new local</code> expression, or they are
created in a new COG by using the <code>new</code> expression (see
<a href="#sec:concurrency-model">The ABS Actor and Concurrency Model</a> for more details about cogs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This expression is a side-effect expression and cannot be used as a sub-expression.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>NewExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>new</code> [ <code>local</code> ] <em>TypeIdentifier</em> <code>(</code> [ <em>PureExp</em> {<code>,</code> <em>PureExp</em> } ] <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>new local Foo(5)
new Bar()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Classes can declare an <em>init block</em> (see <a href="#sec:classes">Classes</a>), which is executed for
each new instance.  The semantics of the <code>new</code> expression guarantee that the
init block is fully executed before the new object begins receiving method
calls.  Classes can also declare a <code>run</code> method, which is asynchronously
invoked after the init block and subject to the normal scheduling rules for
processes.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
When the fresh object gets passed <code>this</code> as argument, it is
possible to execute synchronous calls to the creating object in the
init block while the creating task is executing the <code>new</code> or <code>new
local</code> expression.  This works as expected when the fresh object is on
the same cog (i.e., is created with <code>new local</code> but will deadlock when
the fresh object is on its own cog).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-synchronous-method-calls">4.13. Synchronous Method Calls</h3>
<div class="paragraph">
<p>A synchronous call consists of a target expression evaluating to an interface
type, a method name declared in that interface, and a list of argument expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This expression is a side-effect expression and cannot be used as a sub-expression.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SyncCall</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <code>.</code> <em>SimpleIdentifier</em> <code>(</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Bool b = x.m(5, 3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The semantics of the synchronous method call differ depending on whether the
caller and callee are in the same cog.  A synchronous method call between
objects in the same cog has Java-like semantics, i.e., the caller is suspended
and the called method starts executing immediately.  When the called method
finishes, the caller process is scheduled and resumes execution.</p>
</div>
<div class="paragraph">
<p>In the case when caller and called object are in different cogs, a synchronous
method call is equivalent to and asynchronous method call immediately followed
by a <code>get</code> expression on the resulting future.  This means that the intuitive
semantics of synchronous method calls are preserved, but introduces the
possibility of deadlocks in case the callee tries to call back to an object of
the caller cog.</p>
</div>
</div>
<div class="sect2">
<h3 id="async-call-expression">4.14. Asynchronous Method Calls</h3>
<div class="paragraph">
<p>An asynchronous call consists of a target expression evaluating to an
interface type, a method name declared in that interface, and a list of
argument expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This expression is a side-effect expression and cannot be used as a sub-expression.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AsyncCall</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <code>!</code> <em>SimpleIdentifier</em> <code>(</code> [ <em>PureExp</em> { <code>,</code> <em>PureExp</em> } ] <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An asynchronous method call creates a new task in the COG that contains the
target.  This means that the caller task proceeds independently and in
parallel with the callee task, without waiting for the result.  The result of
evaluating an asynchronous method call expression <code>o!m(e)</code> is a <em>future</em> of
type (<code>Fut&lt;V&gt;</code>), where <code>V</code> is the return type of the callee method <code>m</code>.</p>
</div>
<div class="paragraph">
<p>This future is resolved (i.e., it gets a value) when the callee task finishes.
It can be used to synchronize with the callee task and obtain the result of
the method call.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;Bool&gt; f = x!m(5);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="get-expression">4.15. Get</h3>
<div class="paragraph">
<p>A get expression is used to obtain the value from a future.  The current task
is blocked until the future has been resolved, i.e., until either the return
value is available or an exception has occurred in the callee task.  No other
task in the COG can be activated while the current task is blocked by a get
expression.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This expression is a side-effect expression and cannot be used as a sub-expression.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>GetExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>PureExp</em> <code>.</code> <code>get</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Bool b = f.get;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the future contains a normal return value, the value of the get expression
is that value.  If the future contains an exception thrown by the callee
process, evaluating the get expression will throw the same exception.  The
value thrown by a get expression can be caught by try-catch as normal (see
<a href="#try-catch-finally-stmt">Handling Exceptions with Try-Catch-Finally</a>).</p>
</div>
<div class="paragraph">
<p>The following example assigns the return value contained in <code>f</code> to the
variable <code>b</code>.  In case of any error, <code>b</code> is assigned <code>False</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>try b = f.get; catch { _ =&gt; b = False; }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="await-expression">4.16. Await (Expression)</h3>
<div class="paragraph">
<p>An await expression is a way to asynchronously call a method, wait for the
callee to finish, and optionally get the result in one expression.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This expression is a side-effect expression and cannot be used as a sub-expression.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AwaitExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>await</code> <em>AsyncCall</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>A x = await o!m();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The statement above is equivalent to these three statements:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;A&gt; fx = o!m();
await fx?;
A x = fx.get;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="-exception-propagation-and-the-await-expression">Exception Propagation and the Await Expression</h4>
<div class="paragraph">
<p>As explained in Section <a href="#get-expression">Get</a>, exceptions propagate from callee
to caller via the <code>get</code> expression.  An <code>await</code> statement will proceed once
the callee process has finished, but an exception in the future will not be
raised when executing the <code>await</code> statement.  To align the <code>await</code> expression
with that behavior, an exception will only be raised when the return value of
a method call is used, e.g., by assigning it to a variable. Hence the
following line of code will not raise an error even if the call to <code>o!m()</code>
results in an exception:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>await o!m();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the return value is ignored in the statement above, it is equivalent to
these two statements:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;A&gt; fx = o!m();
await fx?;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="destiny-expression">4.17. Destiny (Expression)</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This feature is only available in the Erlang backend.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>destiny</code> expression returns the future of the asynchronous call that is
currently being executed.
It returns a value of the <code>Destiny</code> type. For more information on how <code>Destiny</code>
values can be used, see <a href="#type-destiny">The Destiny Type</a>.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DestinyExp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destiny</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class C {
    Destiny myMethod() {
        return destiny;
    }

    Unit run() {
        Fut&lt;Destiny&gt; f = this!myMethod();
        await f?;
        Destiny g = f.get;
        assert(f == g); <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the boolean expression will evaluate to <code>True</code> since the returned <code>destiny</code>
value is the same as the future of the asynchronous call to <code>myMethod</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>destiny</code> is evaluated as part of a synchronous call S then it evaluates to
the future of the task that is executing S:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class C {
    Unit syn(Destiny caller) {
        assert(destiny == caller);
    }

    Unit asyn() {
        this.syn(destiny);
    }

    Unit run() {
        this!asyn();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is also the <code>destinyOf</code> built-in function that can retrieve the
  future of the asynchronous call that is currently being executed by a <code>Process</code>,
  see <a href="#sec:process-attributes">Processes and Process Attributes</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-function-definitions">5. Function Definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Functions take a list of arguments and evaluate the expression in their body,
producing a return value.  ABS functions are always pure.  This means the body
of a function can use all pure expressions but
no expressions with side effects.</p>
</div>
<div class="paragraph">
<p>Functions can be <em>parametric</em>, which means that they can take and return
parametric datatypes.  This means that a function <code>head</code> defined over a
parametric list datatype can return the first element of a list, regardless of
its type.  Parametric functions are defined like normal functions but have an
additional type parameter section inside angle brackets (<code>&lt;</code> <code>&gt;</code>) after the
function name.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FunctionDecl</em>  ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>def</code> <em>Type</em> <em>SimpleIdentifier</em> [ <code>&lt;</code> <em>SimpleTypeIdentifier</em> { <code>,</code> <em>SimpleTypeIdentifier</em> } <code>&gt;</code> ]<br>
                        <code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em>  } ]  <code>)</code><br>
                        <code>=</code> <em>PureExp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>def Rat abs(Rat x) = if x &gt; 0 then x else -x; <i class="conum" data-value="1"></i><b>(1)</b>

def Int length&lt;A&gt;(List&lt;A&gt; list) = <i class="conum" data-value="2"></i><b>(2)</b>
case list {
  Nil =&gt; 0
  | Cons(_, ls) =&gt; 1 + length(ls)
};

def A head&lt;A&gt;(List&lt;A&gt; list) = <i class="conum" data-value="3"></i><b>(3)</b>
  case list { Cons(x, _) =&gt; x };</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>abs</code> function returns the absolute value of its argument.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This parametric function takes lists with arbitrary values and returns an Integer.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This parametric function returns the same type that is contained in the list.  (Note that <code>head</code> is a partial function which is not defined for empty lists.)</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sec:partially-defined-functions">5.1. Partial Function Definitions</h3>
<div class="paragraph">
<p>For reasons of simplicity and analyzability, ABS does not offer higher-order
functions.  On the other hand, many common patterns of functional programming
are extremely useful, for example the well-known <code>map</code>, <code>filter</code> and <code>fold</code>
higher-order functions.  For this reason, ABS supports <em>partial function
definitions</em>.</p>
</div>
<div class="paragraph">
<p>Partial function definitions are function definitions taking an additional set
of parameters.  These additional parameters can be either names of normal
functions, or anonymous functions (see <a href="#sec:anonymous-functions">Anonymous Functions</a>).  Partial
function definitions define a set of functions which only differ in function
applications but share overall structure.  Put another way, partial function
definitions define second-order functions&#8201;&#8212;&#8201;functions that take first-order
functions as arguments.  Partially defined functions can be used inside
functional code, but cannot be passed as parameters to other partial
functions.</p>
</div>
<div class="paragraph">
<p>A partially defined function is called the same way as a normal function, with
a separate, non-empty argument list containing the functional arguments.  For recursion
inside the body of a partially defined function, omit the function parameter
list.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>PartialFunctionDecl</em>  ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>def</code> <em>Type</em> <em>SimpleIdentifier</em> [ <code>&lt;</code> <em>SimpleTypeIdentifier</em> { <code>,</code> <em>SimpleTypeIdentifier</em> } <code>&gt;</code> ]<br>
                        <code>(</code> <em>SimpleIdentifier</em> { <code>,</code> <em>SimpleIdentifier</em>  } <code>)</code><br>
                        <code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em>  } ]  <code>)</code><br>
                        <code>=</code> <em>PureExp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>// Simply applies a function fn to a value.
def B apply&lt;A, B&gt;(fn)(A value) = fn(value);

def Int double(Int x) = x * 2;

{
  // doubled = 4
  Int doubled = apply(double)(2);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>def List&lt;B&gt; map&lt;A, B&gt;(f)(List&lt;A&gt; list) = case list { <i class="conum" data-value="1"></i><b>(1)</b>
    Nil =&gt; Nil
    | Cons(x, xs) =&gt; Cons(f(x), map(xs)) <i class="conum" data-value="2"></i><b>(2)</b>
};

def Int double(Int x) = x * 2;

{
  // doubled = [2, 4, 6]
  List&lt;Int&gt; doubled = map(double)(list[1, 2, 3]);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This definition of <code>map</code> is contained in the standard library.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Note the recursive call to <code>map</code> omits the function parameter list.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For each call of a partial function, a normal function definition is
generated at compile time by replacing the functional parameters syntactically
by the functions passed in the additional parameter list.  This is done before
type checking and after delta and trait flattening&#8201;&#8212;&#8201;any type mismatch and
similar errors are caught afterwards during type checking.  If multiple
statements call a partially defined function with the same function-name
arguments, only one expansion is generated.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec:anonymous-functions">5.2. Anonymous Functions</h3>
<div class="paragraph">
<p>To reduce the need to declare a function with a new function name explicitly
every time a partially defined function is called, ABS uses anonymous
functions.  Anonymous functions are only allowed in the first arguments list
calls to partially defined functions.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AnonymousFunction</em>  ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em>  } ]  <code>)</code> <code>&#8658;</code> <em>PureExp</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An anonymous function specifies a number of parameters and an expression that
may refer to the declared parameters.</p>
</div>
<div class="paragraph">
<p>The following example is equivalent to the previous example, but does not
define the <code>double</code> function explicitly.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>{
  List&lt;Int&gt; list = list[1, 2, 3];
  list = map((Int y) =&gt; y * 2)(list);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Anonymous functions can refer to variables and fields accessible in the
context of the partial function call.  (Since anonymous functions are not
first-class values, no closure is created.)</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>{
  Int factor = 5;
  List&lt;Int&gt; list = list[1, 2, 3];
  list = map((Int y) =&gt; y * factor)(list);
  // list = [5, 10, 15]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Anonymous functions are inlined into the expansion of the partial
function definition.  Errors caused by wrong typing are caught after the
expansion during the type checking of core ABS, but the expanded function
definition has an annotation referring to the statement that caused the
expansion, hence error reporting will be accurate wrt. the original source
code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-built-in-functions">5.3. Built-In Functions</h3>
<div class="paragraph">
<p>Some special "functions" cannot be defined with pure expressions, for example
the function <code>println</code>.  The definition of such functions is done via a
special function body written as <code>builtin</code>, with optional pure expression
arguments <code>builtin(a, "b", 3)</code>.  Such builtin functions have to be defined
separately in the code generator for each backend where the model is compiled.</p>
</div>
<div class="paragraph">
<p>Built-in functions in the standard library include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The functions <code>sqrt</code>, <code>log</code>, <code>exp</code> that work on floating-point numbers</p>
</li>
<li>
<p>Functions that convert between different numerical types: <code>truncate</code>, <code>float</code>, <code>rat</code>, <code>floor</code>, <code>ceil</code>, <code>numerator</code>, <code>denominator</code></p>
</li>
<li>
<p>String functions: <code>substr</code>, <code>strlen</code>, <code>toString</code>, <code>println</code></p>
</li>
<li>
<p>Clock access: <code>currentms</code>, <code>ms_since_model_start</code></p>
</li>
<li>
<p>Functions that return process attributes (see Section <a href="#sec:process-attributes">Processes and Process Attributes</a>)</p>
</li>
<li>
<p>The <code>random</code> function</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="-embedded-sqlite-database-queries">5.4. Embedded SQLite Database Queries</h3>
<div class="paragraph">
<p>The Erlang and Java backends can read from a relational database and convert
the result into ABS lists.  Currently only SQLite databases are supported.</p>
</div>
<div class="paragraph">
<p>A SQLite database is queried by writing a function with a <code>builtin</code> body with
three or more arguments: a literal <code>sqlite3</code>, the name of the database file,
the query as a SQL string, and zero or more arguments to the query.  The
return value is a list of ABS values.  The return type of such a function can
be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>List&lt;Int&gt;</code>, when the query returns rows with a single SQLite
<code>INTEGER</code> value;</p>
</li>
<li>
<p><code>List&lt;Float&gt;</code>, when the query returns rows with a single SQLite
<code>INTEGER</code> or <code>REAL</code> value;</p>
</li>
<li>
<p><code>List&lt;Rat&gt;</code>, when the query returns rows with a single SQLite
<code>INTEGER</code> or <code>REAL</code> value;</p>
</li>
<li>
<p><code>List&lt;Bool&gt;</code>, when the query returns rows with a single SQLite
<code>INTEGER</code> value, where <code>0</code> corresponds to ABS <code>False</code>;</p>
</li>
<li>
<p><code>List&lt;String&gt;</code>, when the query returns rows with a single SQLite
<code>TEXT</code> value;</p>
</li>
<li>
<p>A list of an algebraic datatype, with a single constructor taking
only the above datatypes, such that the constructor can be invoked
for each row returned by the query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Query parameters are written as <code>?</code> in the SQL query string.  Each of these
parameters must be supplied with a value.  ABS query parameters are converted
into SQL values (see <a href="https://www.sqlite.org/datatype3.html" class="bare">https://www.sqlite.org/datatype3.html</a>) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Int</code> values are converted into <code>INTEGER</code>;</p>
</li>
<li>
<p><code>Float</code> values are converted into <code>REAL</code>;</p>
</li>
<li>
<p><code>Rat</code> values are converted into floating-point numbers before passing them to the query function;</p>
</li>
<li>
<p><code>Bool</code> values are converted into <code>0</code> and <code>1</code> (note that SQLite treats all non-zero values as true; consider directly using a query parameter of type <code>Int</code> instead);</p>
</li>
<li>
<p><code>String</code> values are converted into <code>STRING</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example: creating a database</div>
<div class="content">
<pre class="rouge highlight"><code>$ sqlite3 /tmp/test.sqlite3
CREATE TABLE IF NOT EXISTS test_table (
  int_value INTEGER,
  float_value REAL,
  string_value TEXT,
  bool_value BOOLEAN
);
INSERT INTO test_table(int_value, float_value, string_value, bool_value)
     VALUES (15, 13.53, "hello", 0);
INSERT INTO test_table(int_value, float_value, string_value, bool_value)
     VALUES (30, 42.5, "world", 1);
.quit</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above database, the following ABS model can be run:</p>
</div>
<div class="listingblock">
<div class="title">Example: reading from the database</div>
<div class="content">
<pre class="rouge highlight"><code>module Test;

def List&lt;String&gt; fstring() = builtin(sqlite3, <i class="conum" data-value="1"></i><b>(1)</b>
    "/tmp/test.sqlite3",
    "SELECT string_value FROM test_table");

def List&lt;Rat&gt; frat() = builtin(sqlite3, <i class="conum" data-value="2"></i><b>(2)</b>
    "/tmp/test.sqlite3",
    "SELECT float_value FROM test_table");

data RowResult = RowResult(Int, Bool, Float, Rat, String);

def List&lt;RowResult&gt; ftuple() = builtin(sqlite3, <i class="conum" data-value="3"></i><b>(3)</b>
    "/tmp/test.sqlite3",
    `SELECT int_value, bool_value, float_value, float_value, string_value
       FROM test_table`);

def List&lt;RowResult&gt; ftuple_with_params(String str, Rat rat) = builtin(sqlite3,
    "/tmp/test.sqlite3",
    `SELECT int_value, bool_value, float_value, float_value, string_value
       FROM test_table
      WHERE string_value = ? <i class="conum" data-value="4"></i><b>(4)</b>
        AND float_value = ?`,
    str, <i class="conum" data-value="5"></i><b>(5)</b>
    rat);


{
    foreach (v, i in frat()) {
        println(`$i$'th rational value is $v$`);
    }
    foreach (v, i in fstring()) {
        println(`$i$'th string value is $v$`);
    }
    foreach (v, i in ftuple()) {
        println(`$i$'th tuple is $v$`);
    }
    foreach (v, i in ftuple_with_params("world", 85/2)) {
        println(`$i$'th tuple is $v$`);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A <code>builtin</code> function with first argument <code>sqlite3</code> takes two or more additional arguments: the name of the database, a SQL query string, and the query parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>SQL <code>REAL</code> values are converted to ABS rational values</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>SQL query results with more than one column are converted into ABS user-defined datatypes. The data constructor of the result datatype has to take the same number of arguments as the <code>SELECT</code> returns, and the datatypes must be compatible.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Query parameters in SQLite are written as plain <code>?</code> in the query string.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>For each parameter in the SQL query, a value must be supplied.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the Erlang backend only, when the database file (the second argument
to the <code>builtin</code> expression) does not contain a path, the model will look for
it in the <code>priv</code> directory of the compiled model.  That directory is the value
of the erlang function <code>code:priv_dir(absmodel)</code>, typically
<code>gen/erl/absmodel/_build/default/lib/absmodel/priv/</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-statements">6. Statements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter specifies all ABS statements.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Statement</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SkipStmt</em><br>
| <em>VarDeclStmt</em><br>
| <em>AssignStmt</em><br>
| <em>ExpStmt</em><br>
| <em>AssertStmt</em><br>
| <em>AwaitStmt</em><br>
| <em>SuspendStmt</em><br>
| <em>ThrowStmt</em><br>
| <em>ReturnStmt</em><br>
| <em>Block</em><br>
| <em>IfStmt</em><br>
| <em>SwitchStmt</em><br>
| <em>WhileStmt</em><br>
| <em>ForeachStmt</em><br>
| <em>TryCatchFinallyStmt</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="-skip">6.1. Skip</h3>
<div class="paragraph">
<p>The skip statement is a statement that does nothing.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SkipStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>skip;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-variable-declarations">6.2. Variable Declarations</h3>
<div class="paragraph">
<p>A variable declaration statement is used to declare variables.  Variable
declarations can occur at any point in a sequence of statements; i.e., it is
not necessary to declare variables only at the beginning of methods or blocks.</p>
</div>
<div class="paragraph">
<p>Variables declared inside a block are in scope for the duration of the block.
It is an error to declare a variable with the same name of another variable in
scope.  A local variable can have the same name as an object field.</p>
</div>
<div class="paragraph">
<p>A variable declaration has an expression that defines the initial value of the
variable.  The initialization expression is mandatory except for variables of
reference types (interfaces and futures), in which case the variable is
initialized with <code>null</code> if the initialization expression is omitted.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>VarDeclStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Type</em> <em>SimpleIdentifier</em> [ <code>=</code> <em>Exp</em> ] <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Bool b = True;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="-constant-declarations">Constant Declarations</h4>
<div class="paragraph">
<p>Variable and field declarations can carry a <code>Final</code> annotation.  the effect of
such an annotation is to forbid re-assignment to such variables.</p>
</div>
<div class="paragraph">
<p>The following example will lead to a compile-time error since we are trying to
assign a new value to <code>constant_i</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>{
    [Final] Int constant_i = 24;
    constant_i = 25;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-assignment">6.3. Assignment</h3>
<div class="paragraph">
<p>The assign statement assigns a value to a variable or a field.</p>
</div>
<div class="paragraph">
<p>Assignments to a field <code>f</code> can be written either <code>this.f = e;</code> or <code>f = e;</code>.
In case a local variable <code>f</code> is in scope at the point of the assignment
statement, the <code>this</code> prefix has to be used to assign to the field <code>f</code>; assignment
to <code>f</code> will change the value of the local variable.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AssignStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ <code>this</code> <code>.</code> ] <em>SimpleIdentifier</em> <code>=</code> <em>Exp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>this.f = True;
x = 5;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-expressions-as-statements">6.4. Expressions as Statements</h3>
<div class="paragraph">
<p>An expression statement is a statement that consists of a single expression.
When an expression statement is executed, the expression is evaluated and the
resulting value is discarded.</p>
</div>
<div class="paragraph">
<p>Expression statements are used for their side effects, for example issuing an
asynchronous method call without waiting for its result.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ExpStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Exp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Creating an object without storing a reference (and hence never invoking
a method on the new object) can be a meaningful operation, for example when
the object has a <code>run</code> method and interacts with the rest of the system by
calling methods on references passed in via the <code>new</code> expression.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>server!operate();
new Client(server);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-assertions">6.5. Assertions</h3>
<div class="paragraph">
<p>An assert statement is a statement for asserting certain conditions.  If the
expression evaluates to <code>True</code>, executing an assertion is equivalent to
<code>skip;</code>.  If the expression evaluates to <code>False</code>, it is equivalent to <code>throw
AssertionFailException;</code>.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AssertStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assert</code> <em>PureExp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>assert x != null;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="await-stmt">6.6. Await (Statement)</h3>
<div class="paragraph">
<p>An await statement suspends the current task until the given guard becomes
active (evaluates to <code>True</code>).  While the task is suspended, other tasks within
the same COG can be scheduled.</p>
</div>
<div class="paragraph">
<p>Guards can wait for a futures to become resolved, for a Boolean condition over
the object state to become true, or (in timed ABS) for a certain duration to
pass.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When evaluating a guard results in an exception, that exception will be
thrown when the task is scheduled next, and can be caught as normal (see
<a href="#try-catch-finally-stmt">Handling Exceptions with Try-Catch-Finally</a>).  Note that a guard can be evaluated multiple
times before its task is scheduled&#8201;&#8212;&#8201;the most recent exception will be thrown
even if the guard evaluated without an exception afterwards.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In general, each cog will continue running a task without preempting it until
the task is finished or it reaches a <em>scheduling point</em>.  Await statements are
scheduling points, as are <code>suspend</code> statements and assignment or expression
statements containing an await expression (see <a href="#await-expression">Await (Expression)</a>).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AwaitStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>await</code> <em>Guard</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Guard</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ <code>this</code> <code>.</code> ] <em>SimpleIdentifier</em> <code>?</code><br>
| <em>PureExp</em><br>
| <em>Guard</em> <code>&amp;</code> <em>Guard</em><br>
| <code>duration</code> <code>(</code> <em>PureExp</em> <code>,</code> <em>PureExp</em> <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;Bool&gt; f = x!m();
await f?; <i class="conum" data-value="1"></i><b>(1)</b>
await this.x == True; <i class="conum" data-value="2"></i><b>(2)</b>
await f? &amp; this.y &gt; 5; <i class="conum" data-value="3"></i><b>(3)</b>
await duration(3, 5); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A <em>claim guard</em> becomes active when the future is resolved (contains a value or an exception).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A <em>field guard</em> is a Boolean expression over the object state.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A <em>guard conjunction</em> becomes active when both its components are active.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A <em>duration guard</em> becomes active after a certain amount of simulated time has passed.  See <a href="#sec:timed-abs">Timed ABS</a> for more on timed models.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="suspend-stmt">6.7. Unconditional Release: Suspend</h3>
<div class="paragraph">
<p>The suspend statement causes the current task to be suspended.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SuspendStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>suspend</code> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is no guarantee that the cog will choose another task to run; the
current task might be resumed immediately after suspending itself.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is tempting to misuse the <code>suspend</code> statement for
busy-waiting (<code>while (!condition) suspend; doTheThing();</code>).  In all
cases, it is better to await on the condition: <code>await condition; doTheThing();</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>suspend;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-return">6.8. Return</h3>
<div class="paragraph">
<p>A return statement returns a value from a method.  A return statement can only
appear as a last statement in a method body.</p>
</div>
<div class="paragraph">
<p>For asynchronous method calls, executing the return statement will cause the
future to be resolved so that it contains a value.  Any claim guards awaiting
the future will become active.</p>
</div>
<div class="paragraph">
<p>Methods that have a <code>Unit</code> return type do not need an explicit return
statement.  The future will be resolved when the method terminates.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ReturnStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>return</code> <em>Exp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ABS does not allow exiting a method from multiple points, e.g., via
multiple <code>return</code> statements.  This makes model analysis easier.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>return x;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="throw-statement">6.9. Throw</h3>
<div class="paragraph">
<p>The statement <code>throw</code> signals an exception (see <a href="#sec:exception-types">Exceptions</a>).  It
takes a single argument of type <code>ABS.StdLib.Exception</code>, which is the exception
value to throw.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ThrowStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>throw</code> <em>PureExp</em> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>  throw AssertionFailException;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the 'throw' statement can only be used inside imperative code.
Functional code that cannot return a value in all cases should use the <code>Maybe</code>
datatype.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def Maybe&lt;Int&gt; f(Int x, Int y) = if (y &lt; 0) then None else Just(x);</pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, note that some built-in exceptions, like
<code>DivisionByZeroException</code> and <code>PatternMatchFailException</code> can originate from
functional code.  See <a href="#stdlib:predefined-exceptions">Predefined exceptions in the Standard Library</a> for a list of built-in
exceptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="-blocks-of-statements">6.10. Blocks of Statements</h3>
<div class="paragraph">
<p>A sequence of statements is called a <em>block</em>.  A block introduces a scope for
local variables.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Block</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{</code> { <em>Statement</em> } <code>}</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Semantically, a whole block is a single statement and can be written
anywhere a single statement is valid.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>{
  Int a = 0; <i class="conum" data-value="1"></i><b>(1)</b>
  a = a + 1;
  n = a % 10;
}

{ } <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The variable <code>a</code> is in scope until the end of the block.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>An empty block is equivalent to <code>skip;</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-conditionals">6.11. Conditionals</h3>
<div class="paragraph">
<p>ABS has the standard conditional statement.  The condition has to evaluate to
a Boolean value.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>IfStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if</code> <code>(</code> <em>PureExp</em> <code>)</code> <em>Stmt</em> [ <code>else</code> <em>Stmt</em> ]</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>if (5 &lt; x) {
  y = 6;
}
else {
  y = 7;
}
if (True)
  x = 5;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="switch-stmt">6.12. Switch: Pattern Matching</h3>
<div class="paragraph">
<p>The switch statement, like the case expression (see <a href="#case-expression">Case</a>),
consists of an expression and a series of branches, each consisting of a
pattern and a statement (which can be a block).</p>
</div>
<div class="paragraph">
<p>When a switch statement is executed, its input expression is evaluated and the
value matched against the branches until a matching pattern is found.  The
statement in the right-hand side of that branch is then executed.  Any
variable bindings introduced by matching the pattern are in effect while
executing that statement.</p>
</div>
<div class="paragraph">
<p>If no pattern matches the expression, a <code>PatternMatchFailException</code> is thrown.</p>
</div>
<div class="paragraph">
<p>For a description of the pattern syntax, see <a href="#case-expression">Case</a>.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SwitchStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>switch</code> <code>(</code> <em>PureExp</em> <code>)</code> <code>{</code> { <em>SwitchStmtBranch</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>SwitchStmtBranch</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Pattern</em> <code>=&gt;</code> <em>Stmt</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Pair&lt;Int, Int&gt; p = Pair(2, 3);
Int x = 0;
switch (p) {
  Pair(2, y) =&gt; { x = y; skip; }
  _ =&gt; x = -1;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-the-while-loop">6.13. The While Loop</h3>
<div class="paragraph">
<p>The while loop repeats its body while the condition evaluates to <code>True</code>.  The
condition is re-evaluated after each iteration of the loop.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>WhileStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>while</code> <code>(</code> <em>PureExp</em> <code>)</code> <em>Stmt</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>while (x &lt; 5) {
  x = x + 1;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="foreach-loop">6.14. The Foreach Loop</h3>
<div class="paragraph">
<p>The foreach loop repeatedly executes its body with a loop value variable bound
to each element of the given list, in sequence.  An optional loop index
variable is bound to the index of the element bound to the value variable,
starting with 0.</p>
</div>
<div class="paragraph">
<p>The rules for the loop variables follow the rules of local variable
declarations in blocks: the loop variables cannot shadow existing variables,
but can use the same name as an object field.  Loop variables go out of scope
after execution leaves the body of their foreach loop.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Also see the second-order functions <code>map</code>, <code>filter</code>, <code>foldl</code> and <code>foldr</code>
in Section <a href="#type-list">Lists</a> for common list processing idioms.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ForeachStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foreach</code> <code>(</code> <em>Identifier</em> [ <code>,</code> <em>identifier</em>] <code>in</code> <em>PureExp</em> <code>)</code> <em>Stmt</em></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>foreach (v in list["a", "b", "c"]) {
  println(`v is bound to $v$`);
}

foreach (v, i in list["a", "b", "c"]) {
  println(`Element number $i$ has value $v$`);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="try-catch-finally-stmt">6.15. Handling Exceptions with Try-Catch-Finally</h3>
<div class="paragraph">
<p>Executing a statement can result in an exception, either explicitly signaled
using the <code>throw</code> keyword or implicitly, for example by dividing by zero.  The
try-catch-finally statement is used to handle exceptions and resume normal
execution afterwards.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TryCatchFinallyStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>try</code> <em>Stmt</em><br>
                              <code>catch</code> ( <code>{</code> { <em>SwitchStmtBranch</em> } <code>}</code>  | <em>SwitchStmtBranch</em> )<br>
                              [ <code>finally</code> <em>Stmt</em> ]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The statement protected by <code>try</code> (which can be a block) is executed first.  If
no exception is thrown, execution continues with the optional <code>finally</code>
statement, then with the next statement after the try-catch-finally statement.</p>
</div>
<div class="paragraph">
<p>If during execution of the statement protected by <code>try</code> an exception is
thrown, it is matched one-by-one against the exception patterns defined in the
<code>catch</code> block.  The statement following the first matching pattern will be
executed, as in the switch statement (see <a href="#switch-stmt">Switch: Pattern Matching</a>).  Execution continues
with the optional <code>finally</code> statement, then with the statement following the
try-catch-finally statement.</p>
</div>
<div class="paragraph">
<p>If during execution of the statement protected by <code>try</code> an exception is thrown
that is not matched by any branch in the <code>catch</code> block, the exception is
<em>unhandled</em>.  In this case, first the optional <code>finally</code> statement is
executed.  If the try-catch-finally was protected by another try-catch-finally
statement, the unhandled exception is passed on to this surrounding
try-catch-finally statement.  Otherwise, the current process terminates and
its future is resolved by storing the unhandled exception.  Any <code>get</code>
expression on this future will re-throw the exception (see
<a href="#get-expression">Get</a>).  The object that ran the aborted process will execute its
recovery block with the unhandled exception as parameter (see
<a href="#sec:classes">Classes</a>).</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>try {
    Rat z = 1/x; <i class="conum" data-value="1"></i><b>(1)</b>
} catch {
    DivisionByZeroException =&gt; println("We divided by zero"); <i class="conum" data-value="2"></i><b>(2)</b>
} finally {
    println("Leaving the protected area"); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If <code>x</code> is zero, this will throw an exception</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Division by zero is handled here; other exceptions will be left unhandled</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This statement is always executed</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a syntactic convenience, when matching only a single pattern, the braces
around the catch block can be omitted.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>try b = f.get; catch _ =&gt; b = False; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A “catch-all” exception handler that sets <code>b</code> to a default value in case an unhandled exception was propagated via <code>f</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>finally</code> block has the same restrictions as the class init and
recovery blocks, i.e., it cannot contain processor release points (i.e.,
<code>await</code> or <code>suspend</code>), blocking expressions (i.e., <code>get</code>), or explicitly throw
an exception via the <code>throw</code> statement.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:interfaces">7. Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Interfaces in ABS are similar to interfaces in Java.  They have a name, which
defines a nominal type, and they can extend one or more interfaces.  If no
explicit <code>extends</code> clause is given, the interface will extend the standard
library interface <code>ABS.StdLib.Object</code> (see <a href="#type-object">Object</a>).  The
<code>ABS.StdLib.Object</code> interface does not specify any methods.</p>
</div>
<div class="paragraph">
<p>The interface body consists of a list of method signature declarations.
Method names start with a lowercase letter.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>InterfaceDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code> <em>SimpleTypeIdentifier</em> [ <code>extends</code> <em>InterfaceList</em> ] <code>{</code> { <em>MethSig</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>InterfaceList</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeIdentifier</em> { <code>,</code> <em>TypeIdentifier</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>MethSig</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Type</em> <em>SimpleIdentifier</em> <code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em> } ] <code>)</code> <code>;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a method declarations in an interface has an <code>[Atomic]</code> annotation, the
compiler will statically check that any definitions for this method contain no
suspension points (<code>suspend</code> and <code>await</code> statements), i.e., that running that
method will complete without scheduling.</p>
</div>
<div class="paragraph">
<p>If a method declarations in an interface has a <code>[Readonly]</code> annotation, the
compiler will statically check that any definitions for this method contain no
assignments to fields.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For ease of reasoning and analysis, ABS methods differ only by name.  It
is an error for an interface to declare two methods with the same name, either
explicitly or via extending another interface.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The interfaces in the example below represent a database system, providing
functionality to store and retrieve files, and a node of a peer-to-peer file
sharing system.  Each node of a peer-to-peer system plays both the role of a
server and a client.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>interface DB {
  File getFile(Filename fId);
  Int getLength(Filename fId);
  Unit storeFile(Filename fId, File file);
  Filenames listFiles();
}
interface Client {
  List&lt;Pair&lt;Server,Filenames&gt;&gt; availFiles(List&lt;Server&gt; sList);

  Unit reqFile(Server sId, Filename fId);
}
interface Server {
  Filenames inquire();
  Int getLength(Filename fId);
  Packet getPack(Filename fId, Int pNbr);
}
interface Peer extends Client, Server {
  List&lt;Server&gt; getNeighbors();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:classes">8. Classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Classes in ABS describe stateful behavior.  All objects in ABS have exactly
one class; objects are created via the <code>new</code> expression.</p>
</div>
<div class="paragraph">
<p>Classes implement one or more interfaces.  If a class implements more than
one interface, <a href="#typecheck-expression">Type-Check Expressions</a> and <a href="#typecast-expression">Type-Cast Expressions</a> are used
to obtain a reference to the same object typed with a different interface.  If
no explicit <code>implements</code> clause is given, the class will extend the standard
library interface <code>ABS.StdLib.Object</code> (see <a href="#type-object">Object</a>).  The
<code>ABS.StdLib.Object</code> interface does not specify any methods.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Classes typically explicitly implement one or more interfaces so that
methods can be called on them, but the <code>run</code> method makes it meaningful to
have objects without public methods; such objects cannot accept method calls
but can send method calls to other objects.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For ease of reasoning and analysis, ABS methods differ only by name.  It
is an error for a class to implement two interfaces that both contain a method
with the same name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Classes have <em>fields</em> that define the state of objects of that class.  All
fields are private and can only be accessed from methods defined in the class.
Fields are defined in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Field declarations</em> in the body of the class define fields that get their
initial value from their init expression.</p>
</li>
<li>
<p><em>Class parameters</em> define fields that get their initial value from the <code>new</code>
expression.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Classes have an optional <em>init block</em>, which is executed for each new object
before any other code.  The init block cannot contain processor release points
(i.e., <code>await</code> or <code>suspend</code>), blocking expressions (i.e., <code>get</code>, <code>duration</code>,
using resources), or explicitly throw an exception via the <code>throw</code> statement.
It is mainly used for complicated field initializations and is frequently
omitted.</p>
</div>
<div class="paragraph">
<p>Classes have an optional <em>run method</em> (see <a href="#sec:active-classes">Active Classes</a>).</p>
</div>
<div class="paragraph">
<p>Classes have an optional <em>recovery block</em>.  In case an uncaught exception
occurs in a method, the exception is matched against the patterns given in the
recovery block, and the associated statement(s) are executed.  If the
exception does not match any pattern in the recovery block, or if the recovery
block itself raises an exception, the object is killed.  Code in the recovery
block has the same restrictions as in the init block (i.e., no processor
release points, blocking expressions and <code>throw</code> statements).</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ClassDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code> <em>SimpleTypeIdentifier</em> [ <code>(</code> [ <em>ClassParameterList</em> ] <code>)</code> ] [ <code>implements</code> <em>InterfaceList</em> ]<br>
                    <code>{</code> [ <em>FieldDeclList</em> ] [ <em>Block</em> ] [<em>RecoveryBlock</em>] { <em>TraitUseList</em> } { <em>MethDecl</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ClassParameterList</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>InterfaceList</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeIdentifier</em> { <code>,</code> <em>TypeIdentifier</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TraitUse</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">adds <em>TraitExpr</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FieldDeclList</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ <em>Type</em> <em>SimpleIdentifier</em> [ <code>=</code> <em>PureExp</em> ] <code>;</code> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>RecoveryBlock</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>recover</code> <code>{</code> { <em>Pattern</em> <code>=&gt;</code> <em>Stmt</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>MethDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Type</em> <em>SimpleIdentifier</em> <code>(</code> [ <em>Type</em> <em>SimpleIdentifier</em> { <code>,</code> <em>Type</em> <em>SimpleIdentifier</em> } ] <code>)</code> <em>Block</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A class definition contains zero or more method definitions.  Each method has
a name, return type and zero or more parameters.  All methods declared in an
interface that is implemented by the class or one of their super-interfaces
must be defined in the class body or in one of the used traits (see
<a href="#sec:traits">Traits</a>).  A class is free to define methods not declared in an
interface; such methods are private to the class and cannot be called from
outside the class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ABS currently does not support method overloading.  Each method must
have a unique name since methods are not disambiguated by their parameter
lists.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class DataBase(Map&lt;Filename,File&gt; db) implements DB {
	File getFile(Filename fId) {
		return lookup(db, fId);
	}

	Int getLength(Filename fId){
		return length(lookup(db, fId));
	}

	Unit storeFile(Filename fId, File file) {
		db = insert(Pair(fId,file), db);
	}

	Filenames listFiles() {
		return keys(db);
	}

	}

class Node(DB db, Peer admin, Filename file) implements Peer {

	Catalog catalog;
	List&lt;Server&gt; myNeighbors;
	// implementation...

}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="-constant-fields">8.1. Constant Fields</h3>
<div class="paragraph">
<p>Similar to variable declarations, field declarations and class parameters can
carry a <code>Final</code> annotation.  the effect of such an annotation is to forbid
re-assignment to such a field.</p>
</div>
<div class="paragraph">
<p>The following example will lead to compile-time errors since we are trying to
assign new values to two fields declared as <code>Final</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class Sample ([Final] Int constant_i) {
    [Final] Int constant_j = 24;
    Unit m() {
        constant_i = 25; // error
        constant_j = 24; // error
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to fields, method parameters and variables can also be declared
<code>Final</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="-read-only-methods">8.2. Read-only Methods</h3>
<div class="paragraph">
<p>For any method definition annotated with <code>[Readonly]</code>, the compiler will
statically check that its body does not contain assignments to fields.</p>
</div>
<div class="paragraph">
<p>If an interface declares a method to be read-only, its definition has to be
annotated with <code>[Readonly]</code> as well.</p>
</div>
<div class="paragraph">
<p>The following example shows a class declaration with an atomic method that
will lead to a compile error.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class Wrong {
    Int field = 12;

    // This will not compile
    [Readonly] Unit fails() {
        field = field + 1;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-atomic-methods">8.3. Atomic Methods</h3>
<div class="paragraph">
<p>For any method definition annotated with <code>[Atomic]</code>, the compiler will
statically check that its body does not contain suspension points
(<code>suspend</code> and <code>await</code> statements) and blocking <code>get</code> expressions.  Such
methods can be called inside init blocks and in <code>finally</code> clauses; all other
methods cannot be called in these places.</p>
</div>
<div class="paragraph">
<p>If an interface declares a method to be atomic, its definition has to be
annotated with <code>[Atomic]</code> as well.</p>
</div>
<div class="paragraph">
<p>The following example shows a call to an atomic method from an init block.
Removing the <code>Atomic</code> annotation from method <code>m</code> would lead to a compile-time
error.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>class Sample {
    Int field = 12;

    {
        field = this.m();
    }

    [Atomic] Int m() {
        return 24;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:active-classes">8.4. Active Classes</h3>
<div class="paragraph">
<p>A class can be active or passive. Active classes start an activity on their own upon creation. Passive classes only react to incoming method calls. A class is active if and only if it has a run method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Unit run() {
	// active behavior ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The run method is asynchronously called after object initialization.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:traits">9. Traits</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ABS does not support inheritance for code reuse.  Method implementations that
are common between classes can be defined once and used inside these classes
by using <em>traits</em>.  A trait is a set of method definitions that can be added
to a class via the <code>uses</code> clause in the class definition.</p>
</div>
<div class="paragraph">
<p>Traits are applied to classes at compile-time and do not change the
interface(s) of a class.  Classes and their methods are type-checked once all
traits are applied.</p>
</div>
<div class="paragraph">
<p>Traits can re-use and modify other traits via <em>trait operations</em>.  A trait can
add methods to another trait, modify methods in another trait, or remove
methods from another trait.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TraitDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trait</code> <em>TraitName</em> = <em>TraitExpr</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TraitExpr</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>MethodSet</em> { <em>TraitOper</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>MethodSet</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TraitName</em> | <em>MethDecl</em> | <code>{</code> { <em>MethDecl</em> }  <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TraitName</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>SimpleIdentifier</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>TraitOper</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adds</code> <em>MethodSet</em><br>
               | <code>modifies</code> <em>MethodSet</em><br>
               | <code>removes</code> ( <em>MethSig</em> | <code>{</code> { <em>MethSig</em> } <code>}</code> )</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A trait is defined with <code>trait</code> t = <em>T</em> at module level.</p>
</div>
<div class="paragraph">
<p>The effect of applying a trait <em>T</em> to a class (using <code>uses</code> <em>T</em> inside the
class body) is to add the methods in that trait to the class
definition.</p>
</div>
<div class="ulist">
<div class="title">Explanation</div>
<ul>
<li>
<p>The trait operation <code>adds</code> adds all the elements of its <em>MethodSet</em> to the
trait.  It is an error if any method of the <em>MethodSet</em> is already present in
the trait.  Any error will be raised <em>after</em> applying all operations, during
type checking.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>trait T = { Unit x(){ skip; } }
trait T2 = { Unit y(){ skip; } } adds T
// T2 contains the following methods:
// Unit y(){ skip; } Unit x(){ skip; }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The trait operation <code>modifies</code> changes all the methods in the trait to the new implementation described in this <em>MethodSet</em>.  If a method with the same name is not present in the trait, the method is added instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The methods in the <code>modifies</code> operation may contain <code>original()</code> calls which
will call the version of the method before the operation application.  In case
an overriden method is not present, <code>original()</code> calls will lead to a
compile-time error.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>trait T = { Bool m(){ return False; } }
trait T2 = { Bool m() { Bool orig = original(); return !orig; } }
class C {
  uses T modifies T2;
}
// Calling C.m() will return True</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The operation <code>removes</code> removes the method(s) with the provided signatures
from the trait.  If a method with the same name is not present in the class
(or set of methods), an error will be raised during compilation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>trait T = { Bool m(){ return False; } }
class C {
  uses T removes { Bool m(); };
}
// class C does not contain any methods</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:modules">10. Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All ABS definitions (classes, interfaces, functions data types, type aliases)
are contained in modules.  All definitions are visible in their own module
only, except when the module exports the name and it is imported in another
module or referenced by its qualified name.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>export</code> clause in a module definition exports <em>names</em>, not
definitions as such.  This means that if a module defines a class and an
interface with the same name, both definitions will be accessible if that name
is contained in the <code>export</code> clause.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="-defining-a-module">10.1. Defining a Module</h3>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ModuleDecl</em>  ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>module</code> <em>TypeIdentifier</em> <code>;</code> { <em>ExportImport</em> } { <em>Decl</em> } [ <em>Block</em> ]</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ExportImport</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Export</em> | <em>Import</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Export</em>      ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>export</code> <em>IdentifierList</em> [ <code>from</code> <em>TypeIdentifier</em> ] <code>;</code><br>
                 | <code>export</code> <code>*</code> [ <code>from</code> <em>TypeIdentifier</em> ] <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Import</em>      ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>import</code> <em>IdentifierList</em> [ <code>from</code> <em>TypeIdentifier</em> ] <code>;</code><br>
                 | <code>import</code> <code>*</code> <code>from</code> <em>TypeIdentifier</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>IdentifierList</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>AnyIdentifier</em> { <code>,</code> <em>AnyIdentifier</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AnyIdentifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Identifier</em> | <em>TypeIdentifier</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Decl</em>        ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>FunctionDecl</em><br>
| <em>PartialFunctionDecl</em><br>
| <em>TypeSynDecl</em><br>
| <em>DataTypeDecl</em><br>
| <em>ExceptionDecl</em><br>
| <em>InterfaceDecl</em><br>
| <em>ClassDecl</em><br>
| <em>TraitDecl</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A module name is a type name and must always start with an upper case letter.</p>
</div>
<div class="paragraph">
<p>Every module starts with a declaration of the form</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module MyModule;</pre>
</div>
</div>
<div class="paragraph">
<p>This declaration starts a new module named <code>MyModule</code>.  All declarations after
this line until the next module declaration belong to the module <code>MyModule</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The module <code>ABS.StdLib</code> contains the standard library and is imported by
every module by default.  If a module contains an explicit <code>import x, y from
ABS.StdLib;</code> import clause, only <code>x</code> and <code>y</code> will be imported, otherwise all
names exported from the standard library will be imported in that module.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-exporting-identifiers">10.2. Exporting Identifiers</h3>
<div class="paragraph">
<p>By default, modules do not export any names.  In order to make names defined
within a module available to other modules, the names have to be <em>exported</em>.
For example, to export a data type and a data constructor, one can write
something like this:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Drinks;
export Drink, pourMilk, pourWater;
data Drink = Milk | Water;
def Drink pourMilk() = Milk;
def Drink pourWater() = Water;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in this example, the data constructors are not exported, and other
modules can only create values of type <code>Drink</code> by calling the exported
constructor functions <code>pourMilk</code> and <code>pourWater</code>.  By only exporting the data
type without any of its constructors, one can realize <em>abstract data types</em>
in ABS.</p>
</div>
<div class="paragraph">
<p>A special export clause <code>export *;</code> exports all names that are defined in the
module.  Note that imported names are <em>not</em> re-exported by <code>export *;</code> or
<code>export Name;</code> (but can be re-exported via <code>export * from OtherModule;</code> and
<code>export Name from OtherModule;</code> clauses).</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Test;
export *;
import * from OtherModule;
export * from OtherModule;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-importing-identifiers">10.3. Importing Identifiers</h3>
<div class="paragraph">
<p>In order to use exported names of a module in another module, the names have
to be imported.  In a module definition, a list of import clauses follows the
list of export clauses.  After being imported, these names are accessible in
the current module.</p>
</div>
<div class="paragraph">
<p>Names can be accessible either qualified (with package prefix) or unqualified,
depending on how they are imported.</p>
</div>
<div class="paragraph">
<p>The following example makes the <code>Drink</code> data type of the module <code>Drinks</code>
accessible as <code>Drinks.Drink</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Bar;
import Drinks.Drink; <i class="conum" data-value="1"></i><b>(1)</b>
import pourMilk from Drinks; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name <code>Drink</code> is accessible in module <code>Bar</code> as <code>Drinks.Drink</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The name <code>pourMilk</code> is accessible in module <code>Bar</code> both as <code>Drinks.pourMilk</code> and <code>pourMilk</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>import * from Module;</code> statement makes all names that are exported from
module <code>Module</code> accessible without module qualifier in the current module.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Bar;
import * from Drinks; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All names from <code>Drinks</code> are accessible in <code>Bar</code> with and without the <code>Drinks.</code> prefix.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="-re-exporting-imported-names">Re-exporting Imported Names</h4>
<div class="paragraph">
<p>It is possible to re-export names that are imported from another module. For example,</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Bar;
import * from Drinks;
export * from Drinks;</code></pre>
</div>
</div>
<div class="paragraph">
<p>re-exports from <code>Bar</code> all names that are exported by module <code>Drinks</code>.  Another
module that writes <code>import * from Bar;</code> will have the names from <code>Drinks</code>
accessible as well.</p>
</div>
<div class="paragraph">
<p>To re-export only selected names, include only these names in the export list:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Bar;
import * from Drinks;
export Drink from Drinks; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>Only <code>Drink</code> is exported from <code>Bar</code>.</p>
</div>
<div class="paragraph">
<p>Note that only names that have been imported can be re-exported.  For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>module Bar;
import Drink from Drinks;
export * from Drinks;</code></pre>
</div>
</div>
<div class="paragraph">
<p>only re-exports <code>Drink</code>, as this is the only name imported from module
<code>Drinks</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:standard-library">11. The Standard Library</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter documents the ABS standard library.  All definitions, except
where noted otherwise, are contained in the module <code>ABS.StdLib</code> which is
included by default in every module.  Therefore, no <code>import</code> statement is
necessary to use these definitions.</p>
</div>
<div class="sect2">
<h3 id="type-bool">11.1. Boolean values</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The literals for Boolean values are <code>True</code> and <code>False</code>.  The name of the
datatype is <code>Bool</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Bool value = True;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-operators">Operators</h4>
<div class="paragraph">
<p>The following operators apply to Boolean values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Associativity</th>
<th class="tableblock halign-left valign-top">Argument types</th>
<th class="tableblock halign-left valign-top">Result type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 || e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool, Bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &amp;&amp; e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool, Bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 == e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 != e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inequality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &lt; e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &lt;= e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &gt; e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &gt;= e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">! e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical negation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">right</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="type-numbers">11.2. Numbers</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors-2">Datatypes and constructors</h4>
<div class="paragraph">
<p>The numeric datatypes of ABS are <code>Int</code> (arbitrary-length integers), <code>Rat</code>
(arbitrary-precision rational numbers) and <code>Float</code> (64-bit floating point).
See <a href="#sec:builtin-types">Built-in Types</a> for their syntax.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Support for floating-point calculations is under development;
calculations resulting in <code>Inf</code> or <code>NaN</code> currently have unspecified runtime
behavior.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="-operators-2">Operators</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Associativity</th>
<th class="tableblock halign-left valign-top">Argument types</th>
<th class="tableblock halign-left valign-top">Result type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 == e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 != e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inequality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &lt; e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &lt;= e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &gt; e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 &gt;= e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 + e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number, number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 - e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subtraction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number, number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 * e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number, number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 / e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">division</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number, number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rat</code> or <code>Float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>e1 % e2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">modulo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number, number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="-functions">Functions</h4>
<div class="sect4">
<h5 id="-min-max">min, max</h5>
<div class="paragraph">
<p>These functions calculate the maximum and minimum of their two arguments.
Since ABS datatypes are ordered, they can be applied to arguments of all
types.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>A max&lt;A&gt;(A a, A b)
A min&lt;A&gt;(A a, A b)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-abs">abs</h5>
<div class="paragraph">
<p>This function calculates the absolute (positive) value of its argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Rat abs(Rat x)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-truncate">truncate</h5>
<div class="paragraph">
<p>Converts a rational number to an integer by truncating towards zero.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int truncate(Rat a)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-float">float</h5>
<div class="paragraph">
<p>Converts an integer or rational number into a floating-point number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Float float(Rat a)</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Very large integers and some rational numbers cannot be converted
exactly into floating-point numbers.  More in general, <code>rat(float(x)) == x</code>
might not be true.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="-rat">rat</h5>
<div class="paragraph">
<p>Converts  a floating-point number into a rational number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Rat rat(Float f)</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Conversion from floating-point to rational numbers is inexact and
backend-specific.  In general, <code>float(rat(x)) == x</code> might not be true.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="-floor">floor</h5>
<div class="paragraph">
<p>Returns the largest integer smaller or equal to the argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int floor(Float f)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-ceil">ceil</h5>
<div class="paragraph">
<p>Returns the smallest integer larger or equal to the argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int ceil(Float f)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-numerator">numerator</h5>
<div class="paragraph">
<p>Returns the numerator of a rational number, or the number itself for an
integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int numerator(Rat a)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-denominator">denominator</h5>
<div class="paragraph">
<p>Returns the denominator of a rational number, or <code>1</code> for an integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int denominator(Rat a)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-pow">pow</h5>
<div class="paragraph">
<p>This function calculates <code>b</code> to the power of <code>n</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Rat pow(Rat b, Int n)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-sqrt_newton">sqrt_newton</h5>
<div class="paragraph">
<p>This function approximates the square root of <code>x</code>; it stops when two subsequent
estimates (as per Newton&#8217;s algorithm) differ by less than <code>epsilon</code>.  <code>estimate</code> is an initial estimate of the
square root.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Rat sqrt_newton(Rat x, Rat estimate, Rat epsilon)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-exp_newton">exp_newton</h5>
<div class="paragraph">
<p>This function approximates <em>e</em> to the power of <code>x</code>; it stops when two subsequent
estimates (as per Newton&#8217;s algorithm) differ by less than <code>epsilon</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Rat exp_newton(Rat x, Rat epsilon)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-sqrt">sqrt</h5>
<div class="paragraph">
<p>This function returns the square root of <code>x</code>.  It is an error if <code>x</code> is
negative.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Float sqrt(Float x)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-log">log</h5>
<div class="paragraph">
<p>This function returns the natural logarithm of its argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Float log(Float x)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-exp">exp</h5>
<div class="paragraph">
<p>This function returns Euler’s number <em>e</em> raised to the power of <code>x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Float exp(Float x)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-random">random</h5>
<div class="paragraph">
<p>Returns an integer between 0 (inclusive) and its argument (exclusive).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Int random(Int below)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-string">11.3. Strings</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors-3">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The datatype for strings is <code>String</code>.</p>
</div>
<div class="paragraph">
<p>String literals are enclosed in double quotes (<code>"</code>).  Line feed in a string
literal is written as <code>\n</code>, carriage return as <code>\r</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="-operators-3">Operators</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Associativity</th>
<th class="tableblock halign-left valign-top">Argument types</th>
<th class="tableblock halign-left valign-top">Result type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 == e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 != e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inequality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &lt; e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &lt;= e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">less than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &gt; e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 &gt;= e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">greater than or equal to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compatible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e1 + e2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">concatenation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String, String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="-functions-2">Functions</h4>
<div class="sect4">
<h5 id="-tostring">toString</h5>
<div class="paragraph">
<p>This function converts any data into a printable string representation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def String toString&lt;T&gt;(T t)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-substr">substr</h5>
<div class="paragraph">
<p>Returns a substring of a given string <code>str</code> with length <code>length</code> starting from
position <code>start</code> (inclusive).  The first character in a string has position 0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def String substr(String str, Int start, Int length)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-strlen">strlen</h5>
<div class="paragraph">
<p>Returns the length of the given string <code>str</code>.  The empty string (<code>""</code>) has
length 0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Int strlen(String str)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-println">println</h5>
<div class="paragraph">
<p>Prints the given string <code>s</code> to standard output, followed by a newline, meaning
that the next output will not continue on the same line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Unit println(String s)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-print">print</h5>
<div class="paragraph">
<p>Prints the given string <code>s</code> to standard output.  Does not cause the next
output to begin on a new line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Unit print(String s)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-unit">11.4. Unit</h3>
<div class="paragraph">
<p><code>Unit</code> is the empty (void) datatype.</p>
</div>
<div class="sect3">
<h4 id="-datatypes-and-constructors-4">Datatypes and Constructors</h4>
<div class="paragraph">
<p>Both the datatype and the single constructor are named <code>Unit</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-object">11.5. Object</h3>
<div class="paragraph">
<p><code>Object</code> is the standard super-interface.  All interfaces extend this type.
All object references can be assigned to variables of this type.</p>
</div>
<div class="paragraph">
<p>The <code>Object</code> interface does not specify any methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="type-future">11.6. The Future Type</h3>
<div class="paragraph">
<p>Futures are placeholders for return values of asynchronous methods calls.</p>
</div>
<div class="paragraph">
<p>Future values are produced by asynchronous method calls (see
<a href="#async-call-expression">Asynchronous Method Calls</a>).  The current process can suspend itself until a
future is resolved, i.e., until the return value of the asynchronous method
call is available (see <a href="#await-stmt">Await (Statement)</a>).  The get expression returns the value
of a future (see <a href="#get-expression">Get</a>).  In case the future is not yet resolved,
the get expression blocks the current cog.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Fut&lt;Int&gt; f = o!add(2, 3); <i class="conum" data-value="1"></i><b>(1)</b>
await f?; <i class="conum" data-value="2"></i><b>(2)</b>
Int result = f.get; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This statement defines a future variable <code>f</code> to hold the integer result of the method call to <code>add</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>await</code> statement suspends the current process until <code>f</code> is resolved.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>get</code> expression returns the value computed by the <code>add</code> call.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Futures are first-class values that can be stored and passed around.  In case
only the return value of the method call is needed and not the future itself,
a shorthand can be used that combines the above three statements:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Int result = await o!add(2, 3); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This statement invokes <code>add</code>, suspends the current process until the result is available, then stores it in <code>result</code>.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="type-destiny">The Destiny Type</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This feature is only available in the Erlang backend.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Destiny</code> type is the type of the <code>destiny</code> expression, see
<a href="#destiny-expression">Destiny (Expression)</a>.
Thus, its values are also futures:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Unit myMethod() {
    Destiny x = destiny;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Destiny</code> type is a supertype of all future types.
For example, values of any future type <code>Fut&lt;T&gt;</code> can implicitly be cast to the
<code>Destiny</code> type:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Destiny f = this!myMethod();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Destiny</code> type supports all boolean comparisons that <code>Fut&lt;T&gt;</code> types
support. Thus, one can use it to compare futures even across different future
types to identify asynchronous method calls:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Destiny f = this!myMethod();
Fut&lt;Int&gt; g = this!myMethod();

assert(f == f &amp;&amp; f != g);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Get-Expression of a <code>Destiny</code> value is typed by the internal type <code>Bottom</code>
that has no values.
Thus, it is permitted to synchronize on a future typed by <code>Destiny</code> but one can
not extract its result:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>Int myMethod() {
    Destiny f = destiny;
    f.get; <i class="conum" data-value="1"></i><b>(1)</b>
    await f?; <i class="conum" data-value="2"></i><b>(2)</b>
    Int x = f.get; <i class="conum" data-value="3"></i><b>(3)</b>

    return 42;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is permitted but results in a deadlock, as the method is now synchronizing on its own completion.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Applying <code>await</code> to a <code>Destiny</code> value is also permitted but in this case it has the same deadlock problem.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This will result in a compile-time error.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stdlib:predefined-exceptions">11.7. Predefined exceptions in the Standard Library</h3>
<div class="paragraph">
<p>ABS provides pre-defined exceptions that are thrown in specific circumstances.
See <a href="#sec:exception-types">Exceptions</a> for information about exceptions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This list is subject to revision in future versions of ABS.  Not all
these exceptions are currently thrown by different backends in the described
situation.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">DivisionByZeroException</dt>
<dd>
<p>Raised in arithmetic expressions when the divisor (denominator) is equal to 0, as in 3/0</p>
</dd>
<dt class="hdlist1">AssertionFailException</dt>
<dd>
<p>The assert keyword was called with False as argument</p>
</dd>
<dt class="hdlist1">PatternMatchFailException</dt>
<dd>
<p>The pattern matching was not complete. In other words all c catch-all clause</p>
</dd>
<dt class="hdlist1">NullPointerException</dt>
<dd>
<p>A method was called on <code>null</code></p>
</dd>
<dt class="hdlist1">StackOverflowException</dt>
<dd>
<p>The calling stack has reached its limit (system error)</p>
</dd>
<dt class="hdlist1">HeapOverflowException</dt>
<dd>
<p>The memory heap is full (system error)</p>
</dd>
<dt class="hdlist1">KeyboardInterruptException</dt>
<dd>
<p>The user pressed a key sequence to interrupt the running ABS program</p>
</dd>
<dt class="hdlist1">ObjectDeadException</dt>
<dd>
<p>A method was called on a dead (crashed) object</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="type-list">11.8. Lists</h3>
<div class="paragraph">
<p>A list is a sequence of values of the same type.  Lists are constructed via
the <code>list</code> constructor function, e.g., <code>list[1, 2, 3]</code> creates a list of three
integers.  An empty list is created via <code>list[]</code> or <code>Nil</code>.</p>
</div>
<div class="paragraph">
<p>The time to access a value via <code>nth</code> is proportional to the length of the
list.  The first value of a list can be accessed in constant time, using the
<code>head</code> function.</p>
</div>
<div class="paragraph">
<p>The <code>map</code>, <code>fold</code> and <code>filter</code> second-order functions described in
this section implement common functional programming patterns.  To
execute some statements for each element in a list, use a <code>foreach</code>
loop (see <a href="#foreach-loop">The Foreach Loop</a>).</p>
</div>
<div class="sect3">
<h4 id="-datatypes-and-constructors-5">Datatypes and Constructors</h4>
<div class="paragraph">
<p>A list is defined either as the empty list (<code>Nil</code>) or as a value <code>a</code> followed
by another list <code>l</code> (<code>Cons(a, l)</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>data List&lt;A&gt; = Nil | Cons(A head, List&lt;A&gt; tail);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Literal lists of arbitrary length can be written using a special function
<code>list</code>.  In the following example, <code>l1</code> and <code>l2</code> contain the same elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>List&lt;Int&gt; l1 = list[1, 2, 3];
List&lt;Int&gt; l2 = Cons(1, Cons(2, Cons(3, Nil)));</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-functions-3">Functions</h4>
<div class="sect4">
<h5 id="-head">head</h5>
<div class="paragraph">
<p>Returns the head of a list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A head(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-tail">tail</h5>
<div class="paragraph">
<p>Returns the tail (rest) of a list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; tail(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-length">length</h5>
<div class="paragraph">
<p>Returns the length of a list.  The length of <code>Nil</code> is 0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Int length(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-isempty">isEmpty</h5>
<div class="paragraph">
<p>Checks if a list is empty.  Returns <code>True</code> for <code>Nil</code>, <code>False</code> otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool isEmpty(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-nth">nth</h5>
<div class="paragraph">
<p>Returns the <code>n</code>-th element of a list.  Returns the head of <code>l</code> for <code>n</code>=0,
returns the last element of <code>l</code> for <code>n</code>=<code>length(l)-1</code>.</p>
</div>
<div class="paragraph">
<p>It is an error if <code>n</code> is equal to or larger than <code>length(l)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A nth(List&lt;A&gt; l, Int n);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-without">without</h5>
<div class="paragraph">
<p>Returns a fresh list where all occurrences of <code>a</code> have been removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; without&lt;A&gt;(List&lt;A&gt; list, A a);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-concatenate">concatenate</h5>
<div class="paragraph">
<p>Returns a list containing all elements of list <code>list1</code> followed by all
elements of list <code>list2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; concatenate&lt;A&gt;(List&lt;A&gt; list1, List&lt;A&gt; list2);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-appendright">appendright</h5>
<div class="paragraph">
<p>Returns a list containing all elements of list <code>l</code> followed by the element <code>p</code>
in the last position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; appendright&lt;A&gt;(List&lt;A&gt; l, A p);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-reverse">reverse</h5>
<div class="paragraph">
<p>Returns a list containing all elements of <code>l</code> in reverse order.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; reverse&lt;A&gt;(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-copy">copy</h5>
<div class="paragraph">
<p>Returns a list of length <code>n</code> containing <code>p</code> n times.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; copy&lt;A&gt;(A p, Int n);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-map">map</h5>
<div class="paragraph">
<p>Applies a function to each element of a list, returning a list of results in
the same order.  The function <code>fn</code> must take an argument of type <code>A</code> and
return a value of type <code>B</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;B&gt; map&lt;A, B&gt;(fn)(List&lt;A&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-filter">filter</h5>
<div class="paragraph">
<p>Returns a list containing only the elements in the given list for which the
given predicate returns <code>True</code>.  The function <code>predicate</code> must take an
argument of type <code>T</code> and return a Boolean value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;T&gt; filter&lt;T&gt;(predicate)(List&lt;T&gt; l);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-foldl">foldl</h5>
<div class="paragraph">
<p>Accumulates a value starting with <code>init</code> and applying <code>accumulate</code> from left
to right to current accumulator value and each element.  The function
<code>accumulate</code> must take two arguments: the first of type <code>A</code> (the type of the
list) and the second of type <code>B</code> (the accumulator and result type), and return
a value of type <code>B</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def B foldl&lt;A, B&gt;(accumulate)(List&lt;A&gt; l, B init);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-foldr">foldr</h5>
<div class="paragraph">
<p>Accumulates a value starting with <code>init</code> and applying <code>accumulate</code> from right
to left to each element and current accumulator value.  The function
<code>accumulate</code> must take two arguments: the first of type <code>A</code> (the type of the
list) and the second of type <code>B</code> (the accumulator and result type), and return
a value of type <code>B</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def B foldr&lt;A, B&gt;(accumulate)(List&lt;A&gt; l, B init);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-set">11.9. Sets</h3>
<div class="paragraph">
<p>A set contains elements of the same type, without duplicates.  Sets are
constructed via the <code>set</code> constructor function, e.g., <code>set[1, 2, 2, 3]</code>
creates a set of three integers 1, 2, 3.  The expression <code>set[]</code> produces the
empty set.</p>
</div>
<div class="paragraph">
<p>To add an element to a set, use the function <code>insertElement</code>, to remove an
element, use <code>remove</code>.  To test for set membership, use the function
<code>contains</code>.</p>
</div>
<div class="paragraph">
<p>The <code>takeMaybe</code> function can be used to iterate through a set.  It is used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Unit printAll&lt;A&gt;(Set&lt;A&gt; set) =
  case takeMaybe(set) {
    Nothing =&gt; println("Finished")
    | Just(e) =&gt; let (Unit dummy) = println("Element " + toString(e)) in printAll(remove(set, e))
  };</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="-datatypes-and-constructors-6">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The datatype for sets with elements of type <code>A</code> is <code>Set&lt;A&gt;</code>.  The <code>set</code> constructor function is used to construct sets.</p>
</div>
</div>
<div class="sect3">
<h4 id="-functions-4">Functions</h4>
<div class="sect4">
<h5 id="-contains">contains</h5>
<div class="paragraph">
<p>Returns <code>True</code> if set <code>ss</code> contains element <code>e</code>, <code>False</code> otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool contains&lt;A&gt;(Set&lt;A&gt; ss, A e);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-emptyset">emptySet</h5>
<div class="paragraph">
<p>Returns <code>True</code> if set <code>xs</code> is empty, <code>False</code>  otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool emptySet&lt;A&gt;(Set&lt;A&gt; ss);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-size">size</h5>
<div class="paragraph">
<p>Returns the number of elements in set <code>xs</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Int size&lt;A&gt;(Set&lt;A&gt; xs);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-elements">elements</h5>
<div class="paragraph">
<p>Returns a list with all elements in set <code>xs</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;A&gt; elements&lt;A&gt;(Set&lt;A&gt; xs);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-union">union</h5>
<div class="paragraph">
<p>Returns a set containing all elements of sets <code>set1</code> and <code>set2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; union&lt;A&gt;(Set&lt;A&gt; set1, Set&lt;A&gt; set2);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-intersection">intersection</h5>
<div class="paragraph">
<p>Returns a set containing all elements that are present in both sets <code>set1</code> and
<code>set2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; intersection&lt;A&gt;(Set&lt;A&gt; set1, Set&lt;A&gt; set2);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-difference">difference</h5>
<div class="paragraph">
<p>Returns a set containing all elements of set <code>set1</code> not present in set <code>set2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; difference&lt;A&gt;(Set&lt;A&gt; set1, Set&lt;A&gt; set2);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-issubset">isSubset</h5>
<div class="paragraph">
<p>Returns <code>True</code> if <code>set</code> contains all elements of <code>maybe_subset</code>, <code>False</code>
otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool isSubset&lt;A&gt;(Set&lt;A&gt; maybe_subset, Set&lt;A&gt; set);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-insertelement">insertElement</h5>
<div class="paragraph">
<p>Returns a set with all elements of set <code>xs</code> plus element <code>e</code>.  Returns a set
with the same elements as <code>xs</code> if <code>xs</code> already contains <code>e</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; insertElement&lt;A&gt;(Set&lt;A&gt; xs, A e);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-remove">remove</h5>
<div class="paragraph">
<p>Returns a set with all elements of set <code>xs</code> except element <code>e</code>.  Returns a set
with the same elements as <code>xs</code> if <code>xs</code> did not contain <code>e</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; remove&lt;A&gt;(Set&lt;A&gt; xs, A e);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-take">take</h5>
<div class="paragraph">
<p>Returns one element from a non-empty set.  It is an error to call <code>take</code> on an
empty set; consider using <code>takeMaybe</code> in that case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A take&lt;A&gt;(Set&lt;A&gt; ss);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-takemaybe">takeMaybe</h5>
<div class="paragraph">
<p>Returns one element from a set, or <code>Nothing</code> for an empty set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Maybe&lt;A&gt; takeMaybe&lt;A&gt;(Set&lt;A&gt; ss);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-map">11.10. Maps</h3>
<div class="paragraph">
<p>Maps are dictionaries storing a <em>value</em> for each <em>key</em>.</p>
</div>
<div class="paragraph">
<p>Maps are constructed using by passing a list of type <code>Pair&lt;A, B&gt;</code> to the <code>map</code>
constructor function.  The keys of the resulting map are of type <code>A</code> and
values are of type <code>B</code>.  The expression <code>map[]</code> produces an empty map.</p>
</div>
<div class="paragraph">
<p>The following example produces a map with two entries <code>1 &#8594; "ABS"</code> and <code>3 &#8594;
"SACO"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Map&lt;Int, String&gt; m = map[Pair(1, "ABS"), Pair(3, "SACO")];</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In case of duplicate keys, it is unspecified which value the map will
contain for a given key.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value associated with a key can be obtained using the <code>lookup</code> and
<code>lookupDefault</code> functions.</p>
</div>
<div class="paragraph">
<p>A map can be iterated over via the functions <code>keys</code>, <code>values</code> and <code>entries</code>,
which return the set of keys and the list of values and entries of the map,
respectively.</p>
</div>
<div class="sect3">
<h4 id="-datatypes-and-constructors-7">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The datatype for a map from type <code>A</code> to type <code>B</code> is is <code>Map&lt;A, B&gt;</code>.  The <code>map</code>
constructor function is used to construct maps.</p>
</div>
</div>
<div class="sect3">
<h4 id="-functions-5">Functions</h4>
<div class="sect4">
<h5 id="-emptymap">emptyMap</h5>
<div class="paragraph">
<p>Returns <code>True</code> if the map is empty, <code>False</code> otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool emptyMap&lt;A, B&gt;(Map&lt;A, B&gt; map);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-removekey">removeKey</h5>
<div class="paragraph">
<p>Returns a map with the first occurrence of <code>key</code> removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Map&lt;A, B&gt; removeKey&lt;A, B&gt;(Map&lt;A, B&gt; map, A key);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-values">values</h5>
<div class="paragraph">
<p>Returns a list of all values within the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;B&gt; values&lt;A, B&gt;(Map&lt;A, B&gt; map);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-keys">keys</h5>
<div class="paragraph">
<p>Returns a set of all keys of the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Set&lt;A&gt; keys&lt;A, B&gt;(Map&lt;A, B&gt; map);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-entries">entries</h5>
<div class="paragraph">
<p>Returns a list of all entries (i.e., pairs of key and value) of the map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def List&lt;Pair&lt;A, B&gt;&gt; entries&lt;A, B&gt;(Map&lt;A, B&gt; map);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-lookup">lookup</h5>
<div class="paragraph">
<p>If value <code>v</code> is associated with a given key <code>k</code>, return <code>Just(v)</code>.  Otherwise,
return <code>Nothing</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Maybe&lt;B&gt; lookup&lt;A, B&gt;(Map&lt;A, B&gt; ms, A k);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-lookupdefault">lookupDefault</h5>
<div class="paragraph">
<p>Returns the value associated with key <code>k</code>.  If the map does not contain an
entry with key <code>k</code>, return the value <code>d</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def B lookupDefault&lt;A, B&gt;(Map&lt;A, B&gt; ms, A k, B d);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you need to know whether the map contains an entry for key <code>k</code>, use the
function <code>lookup</code> instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="-lookupunsafe">lookupUnsafe</h5>
<div class="paragraph">
<p>Returns the value associated with key <code>k</code>.  It is an error if the map does not
contain an entry with key <code>k</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def B lookupUnsafe&lt;A, B&gt;(Map&lt;A, B&gt; ms, A k);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-lookupreverse">lookupReverse</h5>
<div class="paragraph">
<p>If there is an entry <code>k,v</code> in the map, return its key <code>Just(k)</code>.
Otherwise, return <code>Nothing</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Maybe&lt;A&gt; lookupReverse&lt;A, B&gt;(Map&lt;A, B&gt; ms, B v);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-lookupreversedefault">lookupReverseDefault</h5>
<div class="paragraph">
<p>If there is an entry <code>k,v</code> in the map, return its key <code>Just(k)</code>.
Otherwise, return the value <code>d</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A lookupReverseDefault&lt;A, B&gt;(Map&lt;A, B&gt; ms, B v, A d);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you need to know whether the map contains an entry with value
<code>v</code>, use the function <code>lookupReverse</code> instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="-insert">insert</h5>
<div class="paragraph">
<p>Returns a map with all entries of <code>map</code> plus an entry <code>p</code>, which is given as a
pair (<code>Pair(key, value)</code>) and maps <code>key</code> to <code>value</code>.  If <code>map</code> already
contains an entry with the same key <code>key</code>, it is not removed from the map but
<code>lookup</code> will return the new value <code>value</code>.  (The function <code>removeKey</code> removes
the first entry for a given key and thus “undoes” the effect of calling
<code>insert</code>.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Map&lt;A, B&gt; insert&lt;A, B&gt;(Map&lt;A, B&gt; map, Pair&lt;A, B&gt; p);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-put">put</h5>
<div class="paragraph">
<p>Returns a map with all entries of <code>ms</code> plus an entry mapping <code>k</code> to <code>v</code>, minus
the first entry already mapping <code>k</code> to a value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Map&lt;A, B&gt; put&lt;A, B&gt;(Map&lt;A, B&gt; ms, A k, B v);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-pair">11.11. Pairs</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors-8">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The <code>Pair&lt;A, B&gt;</code> datatype holds a pair of values of types <code>A</code> and <code>B</code>,
respectively.  The constructor is called <code>Pair</code> as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Pair&lt;Int, String&gt; pair = Pair(15, "Hello World");</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-functions-6">Functions</h4>
<div class="sect4">
<h5 id="-fst">fst</h5>
<div class="paragraph">
<p>The function <code>fst</code> returns the first value in a pair.</p>
</div>
</div>
<div class="sect4">
<h5 id="-snd">snd</h5>
<div class="paragraph">
<p>The function <code>snd</code> returns the second value in a pair.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-triple">11.12. Triples</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors-9">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The <code>Triple&lt;A, B, C&gt;</code> datatype holds a triple of values of types <code>A</code>, <code>B</code> and
<code>C</code>, respectively.  The constructor is called <code>Triple</code> as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Triple&lt;Int, String, Bool&gt; triple = Triple(15, "Hello World", False);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-functions-7">Functions</h4>
<div class="sect4">
<h5 id="-fstt">fstT</h5>
<div class="paragraph">
<p>The function <code>fstT</code> returns the first value in a triple.</p>
</div>
</div>
<div class="sect4">
<h5 id="-sndt">sndT</h5>
<div class="paragraph">
<p>The function <code>sndT</code> returns the second value in a triple.</p>
</div>
</div>
<div class="sect4">
<h5 id="-trdt">trdT</h5>
<div class="paragraph">
<p>The function <code>trdT</code> returns the third value in a triple.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type-optionals">11.13. Optionals</h3>
<div class="sect3">
<h4 id="-datatypes-and-constructors-10">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The datatype <code>Maybe&lt;A&gt;</code> wraps a concrete value of type A.  The value <code>Nothing</code>
denotes the absence of such a value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Maybe&lt;Int&gt; answer = Just(42);
Maybe&lt;String&gt; question = Nothing;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-functions-8">Functions</h4>
<div class="sect4">
<h5 id="-isjust">isJust</h5>
<div class="paragraph">
<p>The function <code>isJust</code> returns <code>False</code> if the <code>Maybe</code> value is <code>Nothing</code>,
<code>True</code> otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool isJust&lt;A&gt;(Maybe&lt;A&gt; a);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-fromjust">fromJust</h5>
<div class="paragraph">
<p>The function <code>fromJust</code> returns the wrapped value of a <code>Maybe</code>.  It is an error to call <code>fromJust</code> on <code>Nothing</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A fromJust&lt;A&gt;(Maybe&lt;A&gt; m);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-fromjustdefault">fromJustDefault</h5>
<div class="paragraph">
<p>The function <code>fromJustDefault</code> returns the wrapped value of the first
argument, or the second argument if the first argument is <code>Nothing</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def A fromJustDefault&lt;A&gt;(Maybe&lt;A&gt; m, A default);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stdlib-others">11.14. Others</h3>
<div class="paragraph">
<p>This subsection lists definitions of the standard library that do not fit in any other sections.</p>
</div>
<div class="sect3">
<h4 id="-functions-9">Functions</h4>
<div class="sect4">
<h5 id="-ms_since_model_start">ms_since_model_start</h5>
<div class="paragraph">
<p>The function <code>ms_since_model_start</code> returns a non-negative integer containing the number of milliseconds elapsed since the model was started.  It is useful mainly for benchmarking.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-the-model-api">12. The Model API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Erlang backend supports querying a running model.  When creating objects,
an annotation <code>HTTPName</code> makes them available via HTTP requests from outside
the model under the name given by the annotation.  Methods that are annotated
<code>HTTPCallable</code> can be invoked from the outside on such objects.  Additionally,
datatypes can be annotated to influence how they are converted to JSON when
they are returned from such methods.</p>
</div>
<div class="paragraph">
<p>The model API is supported by the Erlang backend.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Model API might accept connections only from local
(loopback) addresses, i.e., from the same machine.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All queries in this section can be prepended with a <code>/v2/</code>
prefix, i.e., <code><a href="http://localhost:8080/v2/call" class="bare">http://localhost:8080/v2/call</a></code> instead of
<code><a href="http://localhost:8080/call" class="bare">http://localhost:8080/call</a></code>.  In case incompatible changes have to be
introduced to the Model API in the future, the semantics of
invocations of queries with prefix <code>/v2/</code> will be preserved.  This
prefix is only implemented on the Erlang backend; patches are welcome.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="-starting-the-model-api">12.1. Starting the Model API</h3>
<div class="paragraph">
<p>When an ABS model is started with the <code>-p</code> parameter naming a port
number, the model will listen on the specified port for requests.  In
the following example, we compile a model <code>my-model.abs</code> and start the
model API on port 8080:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ absc --java my-model.abs -o my-model.jar
$ java -jar my-model.jar -p 8080
# alternatively:
$ absc --erlang my-model.abs
$ gen/erl/run -p 8080</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-shutting-down-the-model-api">12.2. Shutting down the Model API</h3>
<div class="paragraph">
<p>When running a model with the model API activated, it will not return to the
command line after the simulation has finished.  Instead, the model will keep
listening for requests and method calls.</p>
</div>
<div class="paragraph">
<p>A running model can be terminated manually from the console (for example, via
pressing <code>Ctrl-C</code>), or by requesting the URL <code>/quit</code>.  The following command
will terminate a model running on port 8080:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl localhost:8080/quit</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-exposing-objects">12.3. Exposing objects</h3>
<div class="paragraph">
<p>The Model API can be used to access objects of the running model, if
these models are exposed.</p>
</div>
<div class="paragraph">
<p>Objects are exposed via a <code>HTTPName</code> annotation.  In the following example,
two objects of class <code>C</code> are exposed with the names <code>C1</code> and <code>C2</code>
respectively.  The <code>HTTPName</code> annotation can be used on assignment statements,
variable declarations and <code>new</code> expression statements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[HTTPName: "C1"] new C();
[HTTPName: "C2"] I x = new C();</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-exposing-methods">12.4. Exposing methods</h3>
<div class="paragraph">
<p>The Model API can be used to call methods of exposed objects, if those
methods are exposed in their interface definition.  Exposed methods
have some restrictions for which arguments they can accept, because
their argument values need to be serialized via JSON or URL
parameters when called via the Model API.</p>
</div>
<div class="paragraph">
<p>In an interface declaration, a <code>HTTPCallable</code> annotation exposes the annotated
method such that it is callable from outside, given an exposed object that implements that interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>interface I {
  [HTTPCallable] String method(String param1, Int param2);
}</pre>
</div>
</div>
<div class="paragraph">
<p>It is a compile-time error if the method takes parameters whose types are not
supported.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 34%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ABS type</th>
<th class="tableblock halign-left valign-top">URLencoded format</th>
<th class="tableblock halign-left valign-top">JSON format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">literal upper- or lowercase <code>true</code> / <code>false</code>: <code>?p=True</code>, <code>?p=true</code>, <code>?p=False</code>, <code>?p=false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a string of digits, e.g., <code>?p=42</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a floating-point number, e.g., <code>?p=3.14</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON float</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URLEncoded text, e.g., <code>?p=Hello%20World!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;A&gt;</code> (where <code>A</code> can be decoded)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not supported</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON list with elements having type <code>A</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String, A&gt;</code> (where <code>A</code> can be decoded; JSON map keys will be decoded as ABS strings)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not supported</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON map with all values having type <code>A</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All others</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not supported</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not supported</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The method can have any return type.  Method call results will be returned as
a string via the ABS <code>toString()</code> function, except for the types enumerated in
the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33%;">
<col style="width: 67%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ABS type</th>
<th class="tableblock halign-left valign-top">JSON format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON boolean value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON string value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON float, via integer division.  The behavior is unspecified if
  the <code>Rat</code> value is outside of floating point range.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON float</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON list, with elements converted one-by-one per this table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Set&lt;A&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON list; guaranteed to contain no duplicate elements, with
  elements converted one-by-one per this table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;A, B&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON object, with keys generated from their ABS counterpart
  via <code>toString()</code>, values converted per this table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datatype, with at least one named or annotated constructor argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON
  object (see below)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Others</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converted via ABS <code>toString()</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>User-defined datatypes are encoded depending on the presence of accessor
functions and <code>HTTPName</code> annotations.  If the datatype definition contains
neither, values will be encoded as strings via <code>toString()</code>.  If at least one
accessor function or <code>HTTPName</code> annotation is present, values will be encoded
as objects, with the <code>HTTPName</code> annotation value (or accessor function name,
if no annotation is present) as key.  Unnamed constructor argument values will
not be contained in the JSON object.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Example of encoding of user-defined data types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ABS definition</th>
<th class="tableblock halign-left valign-top">Sample JSON encoding</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data D1 = D1(String, Int);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'D1("x", 1)'</code>, as per <code>toString()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data D2 = D2(String key, Int);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ 'key': 'x' }</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data D3 = D3([HTTPName: "effective key"] String key, Int);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ 'effective key': 'x' }</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="-querying-object-state">12.5. Querying object state</h3>
<div class="paragraph">
<p>The Model API can inspect the state of exposed objects, i.e., the
names and values of the object&#8217;s fields.</p>
</div>
<div class="paragraph">
<p>The following query returns the names of all exposed objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/o</pre>
</div>
</div>
<div class="paragraph">
<p>Inspecting an object state directly can be useful for debugging.  The
following query returns a JSON map of the state of the object exposed as <code>C1</code>,
with object fields as keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/o/C1</pre>
</div>
</div>
<div class="paragraph">
<p>The following query returns a JSON map containing the value of <code>C1&#8217;s `field</code>,
with <code>"field"</code> as key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/o/C1/field</pre>
</div>
</div>
<div class="paragraph">
<p>When querying for an unknown object or an unknown field, the HTTP request will
produce a 404 response code.</p>
</div>
</div>
<div class="sect2">
<h3 id="-listing-the-exposed-methods-of-an-object">12.6. Listing the exposed methods of an object</h3>
<div class="paragraph">
<p>The following query returns, for an object exposed as <code>C1</code>, a JSON array of
objects with metadata about callable functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/call/C1</pre>
</div>
</div>
<div class="paragraph">
<p>Each entry in the resulting list will be a JSON object with the following
keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: the name of the exposed method</p>
</li>
<li>
<p><code>parameters</code>: an array with one object per parameter, each with the
following entries:</p>
</li>
<li>
<p><code>name</code>: name of the parameter</p>
</li>
<li>
<p><code>type</code>: type of the parameter</p>
</li>
<li>
<p><code>return</code>: return type of the method</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="-calling-exposed-methods">12.7. Calling exposed methods</h3>
<div class="paragraph">
<p>Exposed methods are called by querying a URL of the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre>http://.../call/&lt;objectname&gt;/&lt;methodname&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Parameters are passed to methods either as query parameters in the URL or in a
JSON map passed in as the body of a POST request.  For duplicate arguments,
parameter values in the URL override values given in the JSON body.</p>
</div>
<div class="paragraph">
<p>The following query produces the return value of the method call
<code>method("value", 50)</code> by invoking it on the object exposed as <code>C1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/call/C1/method?param1=value&amp;param2=50</pre>
</div>
</div>
<div class="paragraph">
<p>This query can be invoked from the shell in two ways, using the <code>curl</code>
command, either using query parameters or a JSON body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl http://localhost:8080/call/C1/method?param1=value\&amp;param2=50
$ curl -d "{ 'param1': 'value', 'param2': 50 }" http://localhost:8080/call/C1/method</pre>
</div>
</div>
<div class="paragraph">
<p>Of course, the Model API can not only be invoked via <code>curl</code> but also
from other programs.  The following example shows how to call a method
<code>testConfig</code> that takes an argument <code>mylist</code> of type <code>List&lt;Int&gt;</code> from
Javascript using the JQuery library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="javascript"><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">call/Model/testConfig</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="dl">"</span><span class="s2">mylist</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">}),</span>
<span class="p">}).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Result: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">));</span>
<span class="p">});</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note the missing solidus (<code>/</code>) at the beginning of the query url&#8201;&#8212;&#8201;this
makes the request robust against custom url prefixes (see
<a href="#customizing-url-prefixes">Customizing the Model API URL</a>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Care must be taken to disable timeouts on the HTTP client when querying for
long-running methods in this way.</p>
</div>
<div class="paragraph">
<p>When querying for unknown objects or methods, the HTTP request will produce a
404 response code.</p>
</div>
<div class="paragraph">
<p>When querying with invalid method parameters, the HTTP request will produce a
400 response code.</p>
</div>
<div class="paragraph">
<p>When the invoked method throws an exception, the HTTP request will produce a
500 response code.</p>
</div>
</div>
<div class="sect2">
<h3 id="-the-model-api-and-timed-abs">12.8. The Model API and Timed ABS</h3>
<div class="paragraph">
<p>The simulated clock of Timed ABS (<a href="#sec:timed-abs">Timed ABS</a>) is accessible via
the Model API.</p>
</div>
<div class="paragraph">
<p>The current value of the clock can be obtained with the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/clock/now</pre>
</div>
</div>
<div class="paragraph">
<p>The result is a JSON object with a key <code>'result'</code> mapping to the
current value of the clock.</p>
</div>
<div class="paragraph">
<p>If the model was started with a clock limit (see
<a href="#timed-abs-and-model-api">Timed ABS and the Model API</a>), the limit can be increased via a request
like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost:8080/clock/advance?by=50</pre>
</div>
</div>
<div class="paragraph">
<p>The result is a JSON object with a key <code>'result'</code> mapping to the
new clock limit.</p>
</div>
<div class="paragraph">
<p>This call will always increase the clock limit by the given amount,
even if the clock had not yet reached the previous limit.  I.e., when
<code>now()</code> = 10 and the limit is 20, after the call the limit will be 70,
the same as when the clock was already stopped at the limit of 20 when
the call was received by the Model API.</p>
</div>
<div class="paragraph">
<p>Note that increasing the clock limit if the model was not started with
an initial limit has no effect.</p>
</div>
</div>
<div class="sect2">
<h3 id="-customizing-the-browser-based-visualization">12.9. Customizing the Browser-Based Visualization</h3>
<div class="paragraph">
<p>Since the Model API is implemented via HTTP, it can be accessed from a
web browser.  The <code>--modelapi-index-file</code> command-line switch is used
to supply an <code>index.html</code> file at compile-time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ absc --java --modelapi-index-file ./index.html *.abs</pre>
</div>
</div>
<div class="paragraph">
<p>When running a model on port 8080 and accessing
<code><a href="http://localhost:8080/" class="bare">http://localhost:8080/</a></code> from a browser, the contents of that file
will be displayed.</p>
</div>
<div class="paragraph">
<p>Sometimes it is necessary to add additional files for visualization,
e.g., CSS files, images or JavaScript libraries.  The contents of one
directory can be added to the model via the <code>--modelapi-static-dir</code>
command-line switch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ absc --java --modelapi-index-file ./index.html --modelapi-static-dir ./support-files/ *.abs</pre>
</div>
</div>
<div class="paragraph">
<p>The contents of the given directory are copied at compile-time.  The
files within that directory are available within the Model API below
the <code>static/</code> path.  For example, a file <code>./support-files/js/d3.js</code>
will be accessible as <code><a href="http://localhost:8080/static/js/d3.js" class="bare">http://localhost:8080/static/js/d3.js</a></code>, and can be referred within the <code>index.html</code> file like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;script type="text/javascript" src="static/js/d3.js"&gt;&lt;/script&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing-url-prefixes">12.10. Customizing the Model API URL</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This functionality is only available in the Erlang backend;
patches are welcome.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is sometimes necessary to change the url under which the model publishes
the given <code>index.html</code> file and static files.  When starting a model, the
parameter <code>--url-prefix</code> can be used to insert a prefix to these paths, and
to the <code>/call</code> and <code>/o</code> URLs described above.</p>
</div>
<div class="paragraph">
<p>As an example, the following command will make the index file given at compile-time available at <a href="http://localhost:8080/abcd/5080/index.html" class="bare">http://localhost:8080/abcd/5080/index.html</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gen/erl/run -p 8080 --url-prefix /abcd/5080</pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
In the <code>index.html</code> file, do not use an initial solidus (<code>/</code>) to
refer to static files and method calls, since such http requests will not work
when the model is run with an url prefix. Instead of <code>&lt;script src="/static/js/d3.js"&gt;&lt;/script&gt;</code>, write <code>&lt;script src="static/js/d3.js"&gt;&lt;/script&gt;</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:timed-abs">13. Timed ABS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Timed ABS is an extension to the core ABS language that introduces a notion of
<em>abstract time</em>.  Timed ABS can be used to model not only the functional
behavior but also the timing-related behavior of real systems running on real
hardware.  In contrast to real systems, time in an ABS model does not advance
by itself.  The time model of Timed ABS takes inspiration from formalisms such
as <a href="http://uppaal.org">Timed Automata</a> and
<a href="http://heim.ifi.uio.no/~peterol/RealTimeMaude/">Real-Time Maude</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All untimed ABS models are valid in Timed ABS.  An ABS model that
contains no time-influencing statements will run without influencing the clock
and will finish at time zero.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The ABS notion of time is <em>dense time</em> with <em>run-to-completion semantics</em>.
Timed ABS adds a clock to the language semantics that advances in response to
certain language constructs.  Time is expressed as a rational number, so the
clock can advance in infinitesimally small steps.</p>
</div>
<div class="paragraph">
<p>It is possible to assign <em>deadlines</em> to method calls.  Deadlines are expressed
in terms of a duration value relative to the current time and decrease as the
clock advances.  The current deadline of a method is available via the
function <code>deadline</code> and decreases down to zero.</p>
</div>
<div class="paragraph">
<p>Time only advances when all processes are blocked or suspended and no process
is ready to run.  This means that for time to advance, all processes are in
one of the following states:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the process is awaiting for a guard that is not enabled (see <a href="#await-stmt">Await (Statement)</a>)</p>
</li>
<li>
<p>the process is blocked on a future that is not available (see
<a href="#get-expression">Get</a>)</p>
</li>
<li>
<p>the process is suspended waiting for time to advance</p>
</li>
<li>
<p>the process is waiting for some resources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In practice this means that all processes run as long as there is “work to be
done.”</p>
</div>
<div class="sect2">
<h3 id="-datatypes-and-constructors-11">13.1. Datatypes and Constructors</h3>
<div class="paragraph">
<p>Time is expressed as a datatype <code>Time</code>, durations are expressed using the
datatype <code>Duration</code>, which can be infinite.  These datatypes are defined in
the standard library as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>data Time = Time(Rat timeValue);
data Duration = Duration(Rat durationValue) | InfDuration;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-functions-10">13.2. Functions</h3>
<div class="paragraph">
<div class="title">now</div>
<p>The function <code>now</code> always returns the current time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Time now()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that since ABS uses simulated time, two calls to <code>now</code> can return the same
value.  Specifically, the result of <code>now()</code> changes only by executing
<code>duration</code> or <code>await duration</code> statements, or by waiting for resources to
become available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>  Time t1 = now();
  Int i = pow(2, 50);
  Time t2 = now();
  assert (t1 == t2); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This assertion will not fail, since no time has passed in the model.  Time
advance in ABS is explicit and can only occur in suspension points.</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">deadline</div>
<p>The function <code>deadline</code> returns the deadline of the current process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Duration deadline()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The initial value of a deadline is set via a <code>Deadline</code> annotation at the
caller site.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Unit m() {
  [Deadline: Duration(10)] this!n(); <i class="conum" data-value="1"></i><b>(1)</b>
}

Unit n() {
  Duration d1 = deadline(); <i class="conum" data-value="2"></i><b>(2)</b>
  await duration(2, 2);
  Duration d2 = deadline(); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Deadline</code> annotation assigns a deadline to the process started by the asynchronous method call</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The process can query its current deadline; if no deadline is given, <code>deadline</code> returns <code>InfDuration</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>d2</code> will be two time units less than <code>d1</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">timeValue</div>
<p>The function <code>timeValue</code> returns the value of its argument as a rational number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Rat timeValue(Time t);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">timeDifference</div>
<p>The function <code>timeDifference</code> returns the absolute value of the difference
between its two arguments, i.e., a value greater or equal to <code>0</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Rat timeDifference(Time t1, Time t2);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">timeLessThan</div>
<p>The function <code>timeLessThan</code> returns <code>True</code> if the value of its first argument
is less than the value of its second argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool timeLessThan(Time t1, Time t2);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">durationValue</div>
<p>The function <code>durationValue</code> returns the value of its argument as a rational number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Rat durationValue(Duration t);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">isDurationInfinite</div>
<p>The function <code>isDurationInfinite</code> returns <code>True</code> if its argument is <code>InfDuration</code>, <code>False</code> if its argument is <code>Duration(x)</code> for some value <code>x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool isDurationInfinite(Duration d);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">addDuration</div>
<p>The function <code>addDuration</code> adds a duration to a time, returning a new value of
type <code>Time</code>.  It is an error to pass <code>InfDuration</code> as an argument to this
function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Time addDuration(Time t, Duration d);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">subtractDuration</div>
<p>The function <code>subtractDuration</code> subtracts a duration from a time, returning a
new value of type <code>Time</code>.  It is an error to pass <code>InfDuration</code> as an argument
to this function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Time subtractDuration(Time t, Duration d);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">durationLessThan</div>
<p>The function <code>durationLessThan</code> returns <code>True</code> if the value of its first
argument is less than the value of its second argument.  In case both
arguments are <code>InfDuration</code>, <code>durationLessThan</code> returns <code>False</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Bool durationLessThan(Duration d1, Duration d2);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">subtractFromDuration</div>
<p>The function <code>subtractFromDuration</code> subtracts a value <code>v</code> from a duration,
returning a new value of type <code>Duration</code>.  In case its first argument is
<code>InfDuration</code>, the result will also be <code>InfDuration</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>def Duration subtractFromDuration(Duration d, Rat v);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-statements-2">13.3. Statements</h3>
<div class="paragraph">
<p>The <code>duration(min, max)</code> statement blocks the cog of the executing process
until at least <code>min</code> and at most <code>max</code> time units have passed.  The <code>await
duration(min, max)</code> statement (see <a href="#await-stmt">Await (Statement)</a>) suspends the current
process until at least <code>min</code> and at most <code>max</code> time units have passed.</p>
</div>
<div class="paragraph">
<p>The second argument to <code>duration</code> can be omitted; <code>duration(x)</code> is interpreted
the same as <code>duration(x, x)</code>.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DurationStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code> <code>(</code> <em>PureExp</em> [ <code>,</code> <em>PureExp</em> ] <code>)</code> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AwaitStmt</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>await</code> <em>Guard</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Guard</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203; | <em>DurationGuard</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DurationGuard</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code> <code>(</code> <em>PureExp</em> [ <code>,</code> <em>PureExp</em> ] <code>)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The difference between <code>duration</code> and <code>await duration</code> is that in the latter
case other processes in the same cog can execute while the awaiting process is
suspended.  In the case of the blocking <code>duration</code> statement, no other process
in the same cog can execute.  Note that processes in other cogs are not
influenced by <code>duration</code> or <code>await duration</code>, except when they attempt to
synchronize with that process.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A subtle difference between <code>duration</code> and <code>await duration</code> is that in
the latter case, the suspended process becomes eligible for scheduling after
the specified time, but there is no guarantee that it will actually be
scheduled at that point.  This means that more time might pass than expressed in the <code>await duration</code> guard!
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre>  Time t = now();
  await duration(1/2, 5); <i class="conum" data-value="1"></i><b>(1)</b>
  Time t2 = now(); <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here the <strong>process</strong> suspends for 1/2-5 time units</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>t2</code> will be at least 1/2 time units larger than <code>t</code></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>  Time t = now();
  duration(1/2, 5); <i class="conum" data-value="1"></i><b>(1)</b>
  Time t2 = now(); <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here the <strong>cog</strong> blocks for 1/2-5 time units</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>t2</code> will be between 1/2 and 5 time units larger than <code>t</code></td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-semantics-of-time-advancement">13.4. Semantics of Time Advancement</h3>
<div class="paragraph">
<p>The simulated clock advances such that it makes the least amount of “jumps”
without missing any point of interest.  This means that when a process waits
or blocks for an interval <em>(min, max)</em>, the clock will not advance more than
<em>max</em>, since otherwise it would miss unblocking the process.  On the other
hand, the clock will advance by the highest amount allowed by the model.  This
means that if only one process waits for <em>(min, max)</em>, the clock will advance
by <em>max</em>.</p>
</div>
<div id="fig-time-advance" class="imageblock">
<div class="content">
<img src="images/ABS-time-advance.png" alt="Big-step time advance" width="510" height="150">
</div>
<div class="title">Figure 5. Big-step time advance</div>
</div>
<div class="paragraph">
<p>Figure <a href="#fig-time-advance">Big-step time advance</a> shows a timeline with two process, <code>P1</code> and <code>P2</code>.
They are waiting for time to advance between <code>(4, 6)</code> and <code>(3, 5)</code> units,
respectively.  Assuming that no other process is ready to run, the clock will
advance the maximum amount that still hits the earliest interval, in this
case 5.  Since the clock is now within both intervals, both processes are
unblocked and ready to run.</p>
</div>
</div>
<div class="sect2">
<h3 id="timed-abs-and-model-api">13.5. Timed ABS and the Model API</h3>
<div class="paragraph">
<p>By default, the clock will advance when all processes within the model
are waiting for the clock.  However, it is sometimes desirable to
synchronize the internal clock with some external event or system, and
therefore to temporarily block it from advancing beyond a certain
value.</p>
</div>
<div class="paragraph">
<p>When starting a model, the erlang backend (<a href="#sec:erlang-backend">Erlang Backend</a>) supports
a parameter <code>-l x</code> or <code>--clock-limit x</code> which stops the clock at the
given value <code>x</code>.  This makes it possible to model infinite systems up
to a certain clock value.  When the clock limit is reached, the model
will terminate even if there are processes which would be enabled by
further clock advancement.</p>
</div>
<div class="paragraph">
<p>When starting a model with both the <code>-l</code> and <code>-p</code> parameters (i.e.,
with both the model api and a clock limit), a request to the model api
of the form <code>/clock/advance?by=x</code> will increase the clock limit by
<code>x</code>, thereby causing waiting processes to run until the new limit is
reached.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:schedulers">14. User-Defined Schedulers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User-defined schedulers are an experimental feature of Timed ABS.  They are
available on the Maude and Erlang backends.  This section describes the
current state of the implementation on the Erlang backend.</p>
</div>
<div class="paragraph">
<p>All identifiers introduced in this section reside in the <code>ABS.Scheduler</code>
module, which is not imported by default.</p>
</div>
<div class="paragraph">
<p>See <a href="https://doi.org/10.1007/s11334-012-0184-5" class="bare">https://doi.org/10.1007/s11334-012-0184-5</a> for a discussion of ABS user-defined
schedulers and process attributes.</p>
</div>
<div class="sect2">
<h3 id="-defining-schedulers">14.1. Defining Schedulers</h3>
<div class="paragraph">
<p>A scheduler is a function that takes a list of processes and chooses one of
them.  Schedulers are ordinary ABS functions.</p>
</div>
<div class="paragraph">
<p>The following two example schedulers illustrate the concept.  The first,
deterministic scheduler takes the first process off the list; the second
scheduler chooses a non-deterministic one.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>def Process defaultscheduler(List&lt;Process&gt; queue) = head(queue);

def Process randomscheduler(List&lt;Process&gt; queue) = nth(queue, random(length(queue)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to formulate an Earliest Deadline First (EDF) scheduler in ABS:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>def Process earliest_deadline_scheduler(List&lt;Process&gt; queue) =
  foldl((Process a, Process b) =&gt;
      if durationLessThan(proc_deadline(a), proc_deadline(b)) // a &lt; b
      then a else b)
    (queue, head(queue));</code></pre>
</div>
</div>
<div class="paragraph">
<p>All schedulers must have a result type <code>Process</code> and must take an argument of
type <code>List&lt;Process&gt;</code> as their first argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:process-attributes">14.2. Processes and Process Attributes</h3>
<div class="paragraph">
<p>A <em>process</em> is an ABS abstract datatype; i.e., there is no constructor
available to create a <code>Process</code> value inside ABS.  Processes are created by
the runtime and handed to schedulers.</p>
</div>
<div class="paragraph">
<p>Processes have <em>attributes</em> which can be used by schedulers to choose the next
process to run.  For example, a scheduler could always prefer processes that
run a certain method.  The following attributes are available:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>method</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the method executed by the process</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>arrival</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time when method call was issued</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>proc_deadline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The (current) deadline value of the process (<code>InfDuration</code> if none)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinyOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Destiny</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The future of the asynchronous call that is currently being executed by the process</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The attributes <code>cost</code>, <code>start</code>, <code>crit</code> are available in
the Maude backend only but will be implemented in the Erlang backend as well.
The attributes <code>value</code>, <code>finish</code> are under consideration since their
usefulness is questionable.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The attribute <code>destinyOf</code> is only available in the Erlang backend.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="-using-schedulers">14.3. Using Schedulers</h3>
<div class="paragraph">
<p>Schedulers apply to <em>cogs</em> since cogs are responsible for scheduling one of
their processes when idle.  Since cogs are created via <code>new</code> expressions, a
scheduler can be given at that point via an annotation.  Classes can have a
<em>default scheduler</em> that is given as an annotation to the class definition;
any cog created when instantiating this class will have that scheduler by
default (unless overridden by an annotation at the <code>new</code> expression).</p>
</div>
<div class="paragraph">
<p>The following example shows how to define a class that uses the
<code>randomscheduler</code> by default.  The first argument (the list of processes) must
have the name <code>queue</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>[Scheduler: defaultscheduler(queue)] class C implements I {
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to create a cog with a different scheduler.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>   [Scheduler: randomscheduler(queue)] I instance = new C();</code></pre>
</div>
</div>
<div class="paragraph">
<p>For schedulers with more than one argument, values for subsequent arguments
are filled with the value of object fields of the same name current at
scheduling time.  The object whose fields are used is the first object in a
cog, i.e., the object created via the <code>new</code> expression that created the cog.
Subseqent objects created in that cog via <code>new local</code> cannot influence the
scheduler.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="rouge highlight"><code>module Test;
import * from ABS.StdLib.Scheduler;

class C {
  Bool flag = False; <i class="conum" data-value="1"></i><b>(1)</b>
}

def Process some_scheduler(List&lt;Process&gt; queue, Bool value) = head(queue); <i class="conum" data-value="2"></i><b>(2)</b>

{
  [Scheduler: some_scheduler(queue, flag)] new C(); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here, class <code>C</code> defines a field called <code>flag</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The scheduler <code>some_scheduler</code> has a second argument of type <code>Bool</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The current value of field <code>flag</code> will used as the second argument to <code>some_scheduler</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec:deployment">15. Deployment and Resource Modeling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to model non-functional properties of systems: code
deployment on varying numbers and kinds of machines, and the effects of code
locality and different resource types such as CPU speeds, interconnection
bandwidth, etc. on the performance of a system.</p>
</div>
<div class="paragraph">
<p>To simulate the effects of deployment decisions on the cost and performance of
running a distributed system, the following aspects need to be added to a
model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A notion of <em>location</em> to describe where different parts of the system will
run</p>
</li>
<li>
<p>A notion of <em>cost</em> of executing code on such locations; and finally</p>
</li>
<li>
<p>A notion of <em>time</em> that allows us to observe the effects of varying the
location and cost.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In ABS, the following language elements implement these aspects:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Deployment Components </dt>
<dd>
<p>ABS cogs can be created on a deployment component
(see <a href="#sec:deployment-components">Deployment Components</a>).  Deployment components have a limited
number of resources available.</p>
</dd>
<dt class="hdlist1">Resource Annotations </dt>
<dd>
<p>ABS statements can be annotated with resource costs
(see <a href="#sec:resources">Resource Types</a>).  Executing such annotated statements incurs resource costs.</p>
</dd>
<dt class="hdlist1">Timed ABS </dt>
<dd>
<p>The time model of Section <a href="#sec:timed-abs">Timed ABS</a> naturally extends to
observations on resource usage.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These elements work together as in Figure <a href="#fig-resource-consumption">Resource Consumption</a>:</p>
</div>
<div id="fig-resource-consumption" class="imageblock">
<div class="content">
<img src="images/ABS-resources.png" alt="Resource Consumption" width="676" height="431">
</div>
<div class="title">Figure 6. Resource Consumption</div>
</div>
<div class="paragraph">
<p>The figure shows a process with a <code>skip</code> statement with an associated cost of
5, followed by a <code>println</code> statement with a cost of 10.  The deployment
component <code>DC</code> has 10 resources available in each time interval.</p>
</div>
<div class="paragraph">
<p>At time <code>t</code>, the <code>skip</code> statement consumes the five needed resources and is
successfully executed.  The <code>println</code> statement consumes the remaining five
resources but is not executed yet.</p>
</div>
<div class="paragraph">
<p>At time <code>t+1</code>, the deployment component’s resources are refilled.  The five
remaining resources of the <code>println</code> statement are consumed and the statement
is executed.  The five remaining resources of <code>DC</code> are not used.</p>
</div>
<div class="paragraph">
<p>At time <code>t+2</code>, the deployment component’s resources are again refilled to 10.</p>
</div>
<div class="paragraph">
<p>The rest of this chapter explains these language elements concerning resource
modeling in detail.  All identifiers introduced in this section reside in the
<code>ABS.DC</code> module.</p>
</div>
<div class="sect2">
<h3 id="sec:cloudprovider">15.1. The CloudProvider API</h3>
<div class="paragraph">
<p>Deployment components are usually managed by a <em>Cloud Provider</em> instance.  The
Cloud Provider implements the life cycle shown in Figure
<a href="#fig-instance-lifecycle">Deployment Component lifecycle</a>.  A deployment component is <em>managed</em> by a cloud
provider if it was created via one of the <code>launchInstance</code> methods.</p>
</div>
<div id="fig-instance-lifecycle" class="imageblock">
<div class="content">
<img src="images/Cloud-API.png" alt="Deployment Component lifecycle" width="475" height="727">
</div>
<div class="title">Figure 7. Deployment Component lifecycle</div>
</div>
<div class="paragraph">
<p>The operations supported by deployment components during their lifecycle are
summarized in Table <a href="#table-dc-lifecycle">[table-dc-lifecycle]</a>.</p>
</div>
<table id="table-dc-lifecycle" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">State</th>
<th class="tableblock halign-left valign-top">Starting</th>
<th class="tableblock halign-left valign-top">Running</th>
<th class="tableblock halign-left valign-top">Terminating</th>
<th class="tableblock halign-left valign-top">Terminated</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create objects</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delayed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invoke methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delayed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process keep running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes/no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="-using-the-cloudprovider">Using the CloudProvider</h4>
<div class="paragraph">
<p>To use deployment components via a cloud provider, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a <code>CloudProvider</code> instance</p>
</li>
<li>
<p>Set the instance descriptions via the <code>setInstanceDescriptions</code> method</p>
</li>
<li>
<p>Create deployment components using the <code>launchInstanceNamed</code> method</p>
</li>
<li>
<p>(optional) Manage access via <code>releaseInstance</code> / <code>acquireInstance</code></p>
</li>
<li>
<p>(optional) Release deployment components via <code>shutdownInstance</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>module ProviderDemo;
import * from ABS.DC;

{
    CloudProvider p = new CloudProvider("Amazon");
    await p!setInstanceDescriptions(
        map[Pair("T2_MICRO", map[Pair(Memory,1), Pair(Speed,1)]),
            Pair("T2_SMALL", map[Pair(Memory,2), Pair(Speed,1)]),
            Pair("T2_MEDIUM", map[Pair(Memory,4), Pair(Speed,2)]),
            Pair("M4_LARGE", map[Pair(Memory,8), Pair(Speed,2)])]);
    DeploymentComponent dc = await p!launchInstanceNamed("T2_SMALL");
    // ... use the deployment component ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-datatypes-and-constructors-12">Datatypes and Constructors</h4>
<div class="paragraph">
<p>The type for cloud provider instances is <code>ABS.DC.CloudProvider</code>.</p>
</div>
<div class="paragraph">
<p>Cloud provider instances are created with a <code>new CloudProvider(String name)</code>
expression.  It is not mandatory but recommended that each cloud provider
instance has a unique name.</p>
</div>
<div class="paragraph">
<p>It is recommended to call <code>setInstanceDescriptions</code> once after creating a
cloud provider to set the list of named instance types that this cloud
provider offers.</p>
</div>
</div>
<div class="sect3">
<h4 id="-methods">Methods</h4>
<div class="paragraph">
<div class="title">setInstanceDescriptions</div>
<p>This method sets the named instance configurations that the cloud provider
instance should support.  These names are used in the methods
<code>launchInstanceNamed</code> and <code>prelaunchInstanceNamed</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>[Atomic] Unit setInstanceDescriptions(Map&lt;String, Map&lt;Resourcetype, Rat&gt;&gt; instanceDescriptions);</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">getInstanceDescriptions</div>
<p>This method returns the map of named instance configurations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>[Atomic] Map&lt;String, Map&lt;Resourcetype, Rat&gt;&gt; getInstanceDescriptions();</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">launchInstanceNamed</div>
<p>This method creates and returns a new deployment component with a resource
configuration corresponding to <code>instancename</code>, as set by the
<code>setInstanceDescriptions</code> method.  If no description for <code>instancename</code>
exists, <code>launchInstanceNamed</code> returns <code>null</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>DeploymentComponent launchInstanceNamed(String instancename);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the new deployment component will be <code>"&lt;Cloud provider
name&gt;-&lt;instancename&gt;-&lt;Counter&gt;"</code>, i.e., a concatenation of the name of the
cloud provider itself, the instance name, and a unique integer as suffix.</p>
</div>
<div class="paragraph">
<p>If the instance description specifies a startup duration,
<code>launchInstanceNamed</code> will only return after that amount of simulated time has
elapsed.</p>
</div>
<div class="paragraph">
<p>The returned deployment component will be acquired (as per <code>acquireInstance</code>)
and can be used immediately.</p>
</div>
<div class="paragraph">
<div class="title">prelaunchInstanceNamed</div>
<p>This method creates and returns a new deployment component with a resource
configuration corresponding to <code>instancename</code>, as set by the
<code>setInstanceDescriptions</code> method.  If no description for <code>instancename</code>
exists, <code>prelaunchInstanceNamed</code> returns <code>null</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>DeploymentComponent prelaunchInstanceNamed(String instancename);</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with <code>launchInstance</code>, the name of the new deployment component will be
<code>"&lt;Cloud provider name&gt;-&lt;instancename&gt;-&lt;Counter&gt;"</code>, i.e., a concatenation of
the name of the cloud provider itself, the instance name, and a unique integer
as suffix.</p>
</div>
<div class="paragraph">
<p>The method <code>prelaunchInstanceNamed</code> returns immediately, but the method
<code>acquireInstance</code>, when called on the returned deployment component, will not
return before its startup duration (if specified) has elapsed.</p>
</div>
<div class="paragraph">
<p>The returned deployment component needs to be acquired (as per
<code>acquireInstance</code>) before it can be used.</p>
</div>
<div class="paragraph">
<div class="title">launchInstance</div>
<p>The <code>launchInstance</code> method creates and returns a new deployment component
with the specified resource configuration.  It can be used when, for whatever
reason, the resource configuration should not be registered with the cloud
provider, but the deployment component should still be managed by it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>DeploymentComponent launchInstance(Map&lt;Resourcetype, Rat&gt; description);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the new deployment component will be <code>"&lt;Cloud provider
name&gt;-&lt;Counter&gt;"</code>, i.e., a concatenation of the name of the
cloud provider itself and a unique integer as suffix.</p>
</div>
<div class="paragraph">
<p>If the resource configuration specifies a startup duration,
<code>launchInstanceNamed</code> will only return after that amount of simulated time has
elapsed.</p>
</div>
<div class="paragraph">
<p>The returned deployment component will be acquired (as per <code>acquireInstance</code>)
and can be used immediately.</p>
</div>
<div class="paragraph">
<div class="title">prelaunchInstance</div>
<p>This method creates and returns a new deployment component with the specified
resource configuration.  As with <code>launchInstance</code>, this method can be used
when, for whatever reason, the resource configuration should not be registered
with the cloud provider, but the deployment component should still be managed
by it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>DeploymentComponent prelaunchInstance(Map&lt;Resourcetype, Rat&gt; d)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the new deployment component will be <code>"&lt;Cloud provider
name&gt;-&lt;Counter&gt;"</code>, i.e., a concatenation of the name of the cloud provider
itself and a unique integer as suffix.</p>
</div>
<div class="paragraph">
<p>The method <code>prelaunchInstance</code> returns immediately, but the method
<code>acquireInstance</code>, when called on the returned deployment component, will not
return before its startup duration (if specified) has elapsed.</p>
</div>
<div class="paragraph">
<p>The returned deployment component needs to be acquired (as per
<code>acquireInstance</code>) before it can be used.</p>
</div>
<div class="paragraph">
<div class="title">acquireInstance</div>
<p>This method, together with <code>releaseInstance</code>, implements exclusive access to a
deployment component.  After <code>acquireInstance</code> returns true, all further
invocations will return false until <code>releaseInstance</code> is called for the
deployment component.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Bool acquireInstance(DeploymentComponent instance);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the deployment component passed as argument was not created by the cloud
provider, the method returns false.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The methods <code>acquireInstance</code> and <code>releaseInstance</code> are used to
implement exclusive access in a <em>cooperative</em> manner.  Attempting to create a
cog on a deployment component without having acquired it beforehand will not
lead to a runtime error; ensuring exclusive access to deployment components is
the responsibility of the modeler.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">releaseInstance</div>
<p>This method releases the deployment component, such that the next call to
<code>acquireInstance</code> will return true.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Bool releaseInstance(DeploymentComponent instance);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method returns true if the deployment component was successfully
released.  It returns false if the deployment component was already not
acquired.</p>
</div>
<div class="paragraph">
<p>If the deployment component passed as argument was not created by the cloud
provider, the method returns false.</p>
</div>
<div class="paragraph">
<div class="title">shutdownInstance</div>
<p>This method shuts down a deployment component.  The effect on the cogs,
objects and running tasks deployed on that deployment component are
backend-specific.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>Bool shutdownInstance(DeploymentComponent instance);</code></pre>
</div>
</div>
<div class="paragraph">
<p>[Atomic] Rat getAccumulatedCost();</p>
</div>
<div class="paragraph">
<p>[Atomic] Map&lt;String, Map&lt;Resourcetype, Rat&gt;&gt; getInstanceDescriptions();</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:deployment-components">15.2. Deployment Components</h3>
<div class="paragraph">
<p>In ABS, processes run inside cogs.  Deployment components are used to provide
a location to cogs.  Cogs residing on the same deployment component share the
resources provided by the deployment component.</p>
</div>
<div id="fig-deployment-component" class="imageblock">
<div class="content">
<img src="images/Deployment-component.png" alt="A deployment component and its cogs" width="636" height="196">
</div>
<div class="title">Figure 8. A deployment component and its cogs</div>
</div>
<div class="paragraph">
<p>Deployment Components are first-class constructs in the ABS language.
References to deployment components can be stored in variables of type
<code>DeploymentComponent</code>, and the methods documented in this section can be
called via asynchronous method calls.</p>
</div>
<div class="paragraph">
<p>Deployment Components are usually created by a cloud provider instance (see
<a href="#sec:cloudprovider">The CloudProvider API</a>), but can also be created using the <code>new</code> expression.  A
new cog is created on a deployment component by using a <code>DC</code> annotation to the
<code>new</code> statement.</p>
</div>
<div class="paragraph">
<p>If no <code>DC</code> annotation is given for a <code>new</code> statement, the fresh cog
(and its first object) are created on the same deployment component as
the current cog.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is an error to try to create a deployment component via <code>new local</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>DeploymentComponent dc = await provider!launchInstance(map[Pair(Speed, 10)]); <i class="conum" data-value="1"></i><b>(1)</b>
[DC: dc] Worker w = new CWorker(); <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The cloud provider <code>provider</code> creates a new deployment component <code>dc</code> with 10 <code>Speed</code> resources</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A new cog containing a <code>CWorker</code> object is created on the new deployment component <code>dc</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All objects of a cog must reside on the same deployment component, i.e.,
<code>[DC: x] new local C()</code> is an error.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="-resources-and-deployment-components">Resources and Deployment Components</h4>
<div class="paragraph">
<p>As seen above, each deployment component “carries” some amount of resources
for each resource type.  This is expressed as a map from resource type to a
number, for example <code>map[Pair(Speed, 10), Pair(Bandwidth, 20)]</code>.  When no
amount is given for some resource type, it is infinite.  See <a href="#sec:resources">Resource Types</a>
for a description of the available resource types.</p>
</div>
</div>
<div class="sect3">
<h4 id="-methods-2">Methods</h4>
<div class="paragraph">
<div class="title">[Atomic] Rat load(Resourcetype rtype, Int periods)</div>
<p>Return the load (0-100) for the given resource type <code>rtype</code> over the last <code>n</code>
periods.  If the deployment component was created with infinite resources for
the given resource type, <code>load</code> returns <code>0</code>.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] InfRat total(Resourcetype rtype)</div>
<p>Return the total available amount for the given resourcetype.  If the
deployment component was created with infinite resources for the given
resource type, <code>total</code> returns <code>InfRat</code>, otherwise <code>Fin(value)</code>.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat decrementResources(Rat amount, Resourcetype rtype)</div>
<p>Decrease the total available amount for the given resourcetype by
<code>amount</code> from the next time interval onwards.  Trying to decrement
infinite resources has no effect.  Trying to decrement by more than
available will decrement the maximum amount possible.  Returns the
amount by which the resource was decreased.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat incrementResources(Rat amount, Resourcetype rtype)</div>
<p>Increase the total available amount for the given resourcetype by <code>amount</code> from
the next time interval onwards.  Trying to increment infinite resources has no
effect.  Returns the amount by which the resource was increased.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat transfer(DeploymentComponent target, Rat amount, Resourcetype rtype)</div>
<p>Transfer <code>amount</code> resources of type <code>rtype</code> from the current
deployment component to <code>target</code>.  Takes effect on the next time
period.  Returns the amount transferred, which will be lower than
<code>amount</code> in case the deployment component has less resources
available.</p>
</div>
<div class="paragraph">
<p>(This method is implemented via <code>decrementResources</code> and
<code>incrementResources</code>.)</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] String getName()</div>
<p>Returns the name of the deployment component.  Deployment components created
via a <code>CloudProvider</code> are guaranteed to have a unique name if no two cloud
providers have the same name.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Time getCreationTime()</div>
<p>Get the creation time of the deployment component, in terms of the simulated clock.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat getStartupDuration()</div>
<p>Get the specified startup duration, or 0 if none specified.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat getShutdownDuration()</div>
<p>Get the specified shutdown duration, or 0 if none specified.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Int getPaymentInterval()</div>
<p>Get the specified payment interval, or 1 if none specified.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] Rat getCostPerInterval()</div>
<p>Get the specified cost (price) per interval, or 0 if none specified.</p>
</div>
<div class="paragraph">
<div class="title">Bool shutdown()</div>
<p>Shut down the deployment component.  It is an error to create a new object on
a deployment component that has been shutdown, or to invoke a method on an
object residing on a deployment component that has been shut down.</p>
</div>
<div class="paragraph">
<div class="title">[Atomic] CloudProvider getProvider()</div>
<p>Get the cloud provider that manages this deployment component.  Returns <code>null</code>
if the deployment component was not created by a cloud provider.  See
<a href="#sec:cloudprovider">The CloudProvider API</a> for a discussion of cloud providers.</p>
</div>
<div class="paragraph">
<div class="title">Bool acquire()</div>
<p>Convenience method for calling <code>acquireInstance</code> of the associated cloud
provider.  If no cloud provider is set, returns <code>True</code>.  See
<a href="#sec:cloudprovider">The CloudProvider API</a> for a discussion of cloud providers.</p>
</div>
<div class="paragraph">
<div class="title">Bool release()</div>
<p>Convenience method for calling <code>releaseInstance</code> of the associated cloud
provider.  If no cloud provider is set, returns <code>True</code>.  See
<a href="#sec:cloudprovider">The CloudProvider API</a> for a discussion of cloud providers.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:resources">15.3. Resource Types</h3>
<div class="paragraph">
<p>The term “Resource” can be understood in different ways.  In ABS, we define
“Resource” to be a countable, measurable property of a deployment component.
Some resources stay constant throughout the life of a deployment component
(e.g., the number of cores), some others are influenced by program execution
(e.g., the available bandwidth in the current time slot).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Resource usage is not allowed in init blocks.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The resource types currently supported by the ABS language are defined in the
<code>ABS.DC</code> module as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>data Resourcetype = Speed | Bandwidth | Memory | Cores ;</pre>
</div>
</div>
<div class="paragraph">
<p>When a deployment component is created without explicitly giving a value for a
resource type, it is assumed to have an infinite amount of that resource.
E.g., when modeling a denial of service attack, the deployment component
running the attacker code will have infinite speed and bandwidth.</p>
</div>
<div class="sect3">
<h4 id="-speed">Speed</h4>
<div class="paragraph">
<p>The <code>Speed</code> resource type models execution speed.  Intuitively, a deployment
component with twice the number of <code>Speed</code> resources will execute twice as
fast.  Speed resources are consumed when execution in the current process
reaches a statement that is annotated with a <code>Cost</code> annotation.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>Time t1 = now();
[Cost: 5] skip;
Time t2 = now();</pre>
</div>
</div>
<div class="paragraph">
<p>Executing the above <code>skip</code> statement will consume 5 Speed resources from the
deployment component where the cog was deployed.  If the deployment component
does not have infinite Speed resources, executing the <code>skip</code> statement might
take an observable amount of time, i.e., <code>t1</code> and <code>t2</code> might be different.</p>
</div>
</div>
<div class="sect3">
<h4 id="-bandwidth">Bandwidth</h4>
<div class="paragraph">
<p>Bandwidth is a measure of transmission speed.  Bandwidth resources are
consumed during method invocation and <code>return</code> statements.  No bandwidth is
consumed if sender and receiver reside on the same deployment component.</p>
</div>
<div class="paragraph">
<p>Bandwidth consumption is expressed via a <code>DataSize</code> annotation:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>Time t1 = now();
[DataSize: 2 * length(datalist)] o!process(datalist);
Time t2 = now();</pre>
</div>
</div>
<div class="paragraph">
<p>Executing the above method invocation statement will consume bandwidth
resources proportional to the length of list <code>datalist</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="-memory">Memory</h4>
<div class="paragraph">
<p>The <code>Memory</code> resource type abstracts from the size of main memory, as a measure
of how many and which cogs can be created on a deployment component.  In
contrast to bandwidth and speed, memory does not influence the timed behavior
of the simulation of an ABS model; it is used for static deployment modeling.</p>
</div>
</div>
<div class="sect3">
<h4 id="-cores">Cores</h4>
<div class="paragraph">
<p>The <code>Cores</code> resource type expresses the number of CPU cores on a deployment
component.  It is used for static deployment decisions and does not have
influence on the timing behavior of simulations (use the <code>Speed</code> resource type
for this purpose).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-modeling-resource-usage">15.4. Modeling Resource Usage</h3>
<div class="paragraph">
<p>As described above, resource information is added to statements of an ABS
model using <code>Cost</code> and <code>DataSize</code> annotations.  Executing such annotated
statements causes observable changes in the simulated time and deployment
component load during simulation.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>module Test;
import * from ABS.DC; <i class="conum" data-value="1"></i><b>(1)</b>
interface I {
  Unit process();
}
class C implements I {
  Unit process() {
    [Cost: 10] skip; <i class="conum" data-value="2"></i><b>(2)</b>
}

{
  DeploymentComponent dc = new DeploymentComponent("Server",
    map[Pair(Speed, 5), Pair(Bandwidth, 10)]);
  [DC: dc] I i = new C();
  [DataSize: 5] i!process(); <i class="conum" data-value="3"></i><b>(3)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make all necessary identifiers accessible in the current module</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Executing this statement costs 10 <code>Speed</code> units; the time needed depends
on the capacity of the deployment component, and on other cogs executing in
parallel on the same deployment component.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Executing this method call consumes 5 Bandwidth resources.  Since <code>dc</code> has
10 bandwidth resources per time unit, the message will be transported
instantly.  Executing the <code>skip</code> statement in the method body will not finish
instantaneously because <code>dc</code> only has 5 <code>Speed</code> resources in total.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-software-product-line-engineering">16. Software Product Line Engineering</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ABS supports the development of software product lines with a set of language
constructs for defining system variants. Following a feature-oriented software
development approach, variants are described as sets of features.  Features
and their dependencies are specified in a feature model.  Each feature has its
corresponding ABS implementation. A feature&#8217;s implementation is specified in
terms of the code modifications (i.e., additions and removals) that need to be
performed to a variant of the system that does not include that feature in
order to add it. This style of programming is called delta-oriented
programming. The ABS code modules that encapsulate feature implementations are
called delta modules (deltas).</p>
</div>
<div class="sect2">
<h3 id="-delta-oriented-programming">16.1. Delta-Oriented Programming</h3>
<div class="paragraph">
<p>ABS supports the delta-oriented programming model, an approach that aids the
development of a set of programs simultaneously from a single code base,
following the software product line engineering approach.  In delta-oriented
programming, features defined by a feature model are associated with code
modules that describe modifications to a core program.  In ABS, these modules
are called <em>delta modules</em>. Hence the implementation of a software product
line in ABS is divided into a <em>core</em> and a set of delta modules.</p>
</div>
<div class="paragraph">
<p>The core consists of a set of ABS modules that implement a complete software
product of the corresponding software product line.  Delta modules (or
<em>deltas</em> in short) describe how to change the core program to obtain new
products.  This includes adding new classes and interfaces, modifying existing
ones, or even removing some classes from the core.  Delta modules can also
modify the functional entities of an ABS program, that is, they can add and
modify data types and type synonyms, and add functions.</p>
</div>
<div class="paragraph">
<p>Deltas are applied to the core program by the ABS compiler front end. The
choice of which delta modules to apply depends on the selection of a set of
features, that is, a particular product of the SPL.  The role of the ABS
compiler front end is to translate textual ABS models into an internal
representation and check the models for syntax and semantic errors.  The role
of the back ends is to generate code for the models targeting some suitable
execution or simulation environment.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaDecl</em>      ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delta</code> <em>SimpleTypeIdentifier</em> [ <code>(</code> <em>DeltaParam</em> { <code>,</code> <em>DeltaParam</em> } <code>)</code> ] <code>;</code><br>
 [ <em>ModuleAccess</em> ] { <em>ModuleModifier</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaParam</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Type</em> <em>SimpleIdentifier</em><br>
                   | <em>QualifiedTypeIdentifier</em> <em>HasCondition</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>HasCondition</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hasField</code> FieldDecl<br>
               | <code>hasMethod</code> MethSig<br>
               | <code>hasInterface</code> TypeId</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ModuleAccess</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uses</code> <em>TypeId</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ModuleModifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adds</code> <em>ClassDecl</em><br>
                    | <code>removes</code> <code>class</code> <em>TypeIdentifier</em> <code>;</code><br>
                    | <code>modifies</code> <code>class</code> <em>TypeIdentifier</em><br>
                    &#160; [<code>adds</code> <em>TypeIdentifier</em> { <code>,</code> <em>TypeIdentifier</em> } ]<br>
                    &#160; [<code>removes</code> <em>TypeIdentifier</em> { <code>,</code> <em>TypeIdentifier</em> } ]<br>
                    &#160; <code>{</code> { ClassModifier } <code>}</code><br>
                    | <code>adds</code> <em>InterfaceDecl</em><br>
                    | <code>removes</code> <code>interface</code> <em>TypeIdentifier</em> <code>;</code><br>
                    | <code>modifies</code> <code>interface</code> <em>TypeIdentifier</em> <code>{</code> { <em>InterfaceModifier</em> } <code>}</code><br>
                    | <code>adds</code> <em>FunctionDecl</em><br>
                    | <code>adds</code> <em>DataTypeDecl</em><br>
                    | <code>modifies</code> <em>DataTypeDecl</em><br>
                    | <code>adds</code> <em>TypeSynDecl</em><br>
                    | <code>modifies</code> <em>TypeSynDecl</em><br>
                    | <code>adds</code> <em>Import</em><br>
                    | <code>adds</code> <em>Export</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ClassModifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adds</code> <em>FieldDecl</em><br>
               | <code>removes</code> <em>FieldDecl</em><br>
               | <code>adds</code> <em>Method</em><br>
               | <code>modifies</code> <em>Method</em><br>
               | <code>removes</code> <em>MethodSig</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>InterfaceModifier</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adds</code> <em>MethSig</em><br>
                    | <code>removes</code> <em>MethSig</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>DeltaDecl</code> clause specifies the syntax of delta modules, consisting of a
unique identifier, an optional list of delta parameters, an optional module
access directive, and a sequence of module modifiers.</p>
</div>
<div class="paragraph">
<p>The <code>ModuleAccess</code> clause specifies the semantics of unqualified identifiers
within a delta.  Any identifiers without namespace prefix will be resolved as
if they occurred in the module named in the <code>ModuleAccess</code> clause.  A delta
can always make additions and modifications in any module by fully qualifying
the <code>TypeName</code> within module modifiers.  New program elements (classes,
interfaces, etc.) with unqualified names are added to the module given in the
<code>uses</code> clause; it is an error to add new program elements with unqualified
names in a delta that does not have a <code>uses</code> clause.</p>
</div>
<div class="paragraph">
<p>While delta modeling supports a broad range of ways to modify an ABS model,
not all ABS program entities are modifiable.  These unsupported modifications
are listed here for completeness.  While these modifications could be easily
specified and implemented, we opted not to overload the language with features
that have not been regarded as necessary in practice:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Class parameters and init block</dt>
<dd>
<p>Deltas currently do not support the modification of class parameter lists or
class init blocks.</p>
</dd>
<dt class="hdlist1">Deltas</dt>
<dd>
<p>currently only support adding functions, and adding and modifying data types
and type synonyms. Removal is not supported.</p>
</dd>
<dt class="hdlist1">Modules</dt>
<dd>
<p>Deltas currently do not support adding new modules or removing modules.</p>
</dd>
<dt class="hdlist1">Imports and Exports</dt>
<dd>
<p>While deltas do support the addition of import and export statements to
modules, they do not support their modification or removal.</p>
</dd>
<dt class="hdlist1">Main block</dt>
<dd>
<p>Deltas currently do not support the modification of the program&#8217;s main block.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="-the-feature-model">16.2. The Feature Model</h3>
<div class="paragraph">
<p>Software variability is commonly expressed using features which can be present
or absent from a product of the product line. Features are defined and organised in a
feature model, which is essentially a set of logical constraints expressing
the dependencies between features. Thus the feature model defines a set of
legal feature combinations, which represent the set of valid software variants
that can be built.</p>
</div>
<div class="sect3">
<h4 id="-specifying-the-feature-model">Specifying the Feature Model</h4>
<div class="paragraph">
<p>The <code>FeatureModel</code> clause specifies a number of "orthogonal" root feature
models along with a number of extensions that specify additional constraints,
typically cross-tree dependencies.  Its grammar is as follows:</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FeatureModel</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{ <code>root</code> <em>FeatureDecl</em> } { <em>FeatureExtension</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FeatureDecl</em>  ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>FName</em> [ <code>{</code> [ <em>Group</em> ] { <em>AttributeDecl</em> } { <em>Constraint</em> } <code>}</code> ]</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FeatureExtension</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>extension</code> <em>FName</em> <code>{</code> { <em>AttributeDecl</em> } { <em>Constraint</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Group</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>group</code> <em>Cardinality</em> <code>{</code> [ <code>opt</code> ] <em>FeatureDecl</em> { <code>,</code> [ <code>opt</code> ] <em>FeatureDecl</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Cardinality</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allof</code> | <code>oneof</code> | <code>[</code> <em>IntLiteral</em> <code>..</code> <em>Limit</em> <code>]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AttributeDecl</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Int</code> <em>AName</em> <code>;</code><br>
 |  <code>Int</code> <em>AName</em> <code>in</code> <code>[</code> <em>Limit</em> <code>..</code> <em>Limit</em> <code>]</code> <code>;</code><br>
 |  <code>Int</code> <em>AName</em> <code>in</code> <code>{</code> <em>IntLiteral</em> { <code>,</code> <em>IntLiteral</em> } <code>}</code> <code>;</code><br>
 | <code>Bool</code> <em>AName</em> <code>;</code><br>
 | <code>String</code> <em>AName</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Limit</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>IntLiteral</em> | <code>*</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Constraint</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Expr</em> <code>;</code><br>
  | <code>ifin</code> <code>:</code>  <em>Expr</em> <code>;</code><br>
  | <code>ifout</code> <code>:</code> <em>Expr</em> <code>;</code><br>
  | <code>require</code> <code>:</code> <em>FName</em> <code>;</code><br>
  | <code>exclude</code> <code>:</code> <em>FName</em> <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Expr</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code><br>
  | <code>False</code><br>
  | <em>IntLiteral</em><br>
  | <em>StringLiteral</em><br>
  | <em>FName</em><br>
  | <em>AName</em><br>
  | <em>FName</em> <code>.</code> <em>AName</em><br>
  | <em>UnOp</em> <em>Expr</em><br>
  | <em>Expr</em> <em>BinOp</em> <em>Expr</em><br>
  | <code>(</code> <em>Expr</em> <code>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>UnOp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code> | <code>-</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>BinOp</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>||</code> | <code>&amp;&amp;</code> | <code>-&gt;</code> | <code>&lt;-&gt;</code> | <code>==</code>
        | <code>!=</code> | <code>&gt;</code>  | <code>&lt;</code>  | <code>&gt;=</code>  | <code>&lt;=</code>
        | <code>+</code>  | <code>-</code>  | <code>*</code>  | <code>/</code>   | <code>%</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Attributes and values range over integers, strings or booleans.</p>
</div>
<div class="paragraph">
<p>The <code>FeatureDecl</code> clause specifies the details of a given feature, firstly by
giving it a name (<code>FName</code>), followed by a number of possibly optional
sub-features, the feature&#8217;s attributes and any relevant constraints.</p>
</div>
<div class="paragraph">
<p>The <code>FeatureExtension</code> clause specifies additional constraints and attributes
for a feature, and if the extended feature has no children a group can also be
specified.  This is particularly useful for specifying constraints that do not
fit into the tree structure given by the root feature model.</p>
</div>
<div class="paragraph">
<p>Here is an example feature model for the <code>DeltaResourceExample</code> product line,
defining valid combinations of features and valid ranges of parameters for
cost, capacity and number of machines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>root Calculations {
  group oneof {
    Wordcount,
    Wordsearch
  }
}

root Resources {
  group oneof {
    NoCost,
    Cost { Int cost in [ 0 .. 10000 ] ; }
  }
}

root Deployments {
  group oneof {
    NoDeploymentScenario,
    UnlimitedMachines { Int capacity in [ 0 .. 10000 ] ; },
    LimitedMachines { Int capacity in [ 0 .. 10000 ] ;
      Int machinelimit in [ 0 .. 100 ] ; }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-feature-model-reflection">Feature Model Reflection</h4>
<div class="paragraph">
<p>There is support for limited reflection on the feature model and configured
product in the module <code>ABS.Productline</code>.  The datatype <code>Feature</code> contains
constructors for all feature names.  The function <code>product_features</code> returns a
list of features contained in the current product, and <code>product_name</code> returns
the name of the product, or the empty string if no product was specified.</p>
</div>
<div class="paragraph">
<p>The following sample code shows the usage, assuming that product <code>Product</code> was
generated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>module Test;
import * from ABS.Productline;

{
  List&lt;Feature&gt; foo = product_features(); // =&gt; Cons(FeatureA, Cons(FeatureC, Nil))
  String name = product_name();           // =&gt; "Product"
}

productline Test;
features FeatureA, FeatureB, FeatureC;

product Product(FeatureA, FeatureC);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-software-product-lines-and-products">16.3. Software Product Lines and Products</h3>
<div class="paragraph">
<p>A (software) product line is a set of software variants that can be built by selecting
any combination of features allowed by the feature model and applying the deltas
that provide the implementation for those features to the core program. How features
are associated with their implementation is defined in ABS with a <em>SPL configuration</em>.</p>
</div>
<div class="paragraph">
<p>An ABS <em>product</em> is simply a set of features associated with a name.</p>
</div>
<div class="sect3">
<h4 id="-specifying-the-product-line">Specifying the Product Line</h4>
<div class="paragraph">
<p>The ABS configuration language links feature models, which describe the
structure of a SPL, to delta modules, which implement behavior.  The
configuration defines, for each selection of features satisfied by the product
selection, which delta modules should be applied to the core.  Furthermore, it
guides the code generation by ordering the application of the delta modules.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Configuration</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>productline</code> <em>TypeId</em> <code>;</code> <em>Features</em> <code>;</code> { <em>DeltaClause</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Features</em>      ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>features</code> <em>FName</em> { <code>,</code> <em>FName</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaClause</em>   ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delta</code> <em>DeltaSpec</em> [ <em>AfterClause</em> ] [ <em>WhenClause</em> ] <code>;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaSpec</em>     ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>DeltaName</em> [ <code>(</code> <em>DeltaParams</em> <code>)</code> ]</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaName</em>     ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>TypeId</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaParams</em>   ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>DeltaParam</em> { <code>,</code> <em>DeltaParam</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>DeltaParam</em>    ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>FName</em> | <em>FName</em> <code>.</code> <em>AName</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AfterClause</em>   ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code> <em>DeltaName</em> { <code>,</code> <em>DeltaName</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>WhenClause</em>    ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>when</code> <em>AppCond</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AppCond</em>       ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>AppCond</em> <code>&amp;&amp;</code> <em>AppCond</em><br>
                | <em>AppCond</em> <code>||</code> <em>AppCond</em><br>
                | <code>!</code> <em>AppCond</em><br>
                | <code>(</code> <em>AppCond</em> <code>)</code><br>
                | <em>FName</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Features and delta modules are associated through <em>application conditions</em> (a.k.a. <em>activation conditions</em>),
which are logical expressions over the set of features and attributes in a
feature model. The collection of applicable delta modules is given by the
application conditions that are true for a particular feature and attribute
selection. By not associating the delta modules directly with features, a
degree of flexibility is obtained.</p>
</div>
<div class="paragraph">
<p>Each delta clause has a <code>DeltaSpec</code>, specifying the name of a delta module
name and, optionally, a list of parameters; an <code>AfterClause</code>, specifying the
delta modules that the current delta must be applied after; and an application
condition <code>AppCond</code>, specifying an arbitrary predicate over the feature names
(<code>FName</code>) and attribute names (<code>AName</code>) in the feature model that describes
when the given delta module is applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>productline DeltaResourceExample;
features Cost, NoCost, NoDeploymentScenario, UnlimitedMachines, LimitedMachines, Wordcount, Wordsearch;
delta DOccurrences when Wordsearch;
delta DFixedCost(Cost.cost) when Cost;
delta DUnboundedDeployment(UnlimitedMachines.capacity) when UnlimitedMachines;
delta DBoundedDeployment(LimitedMachines.capacity, LimitedMachines.machinelimit) when LimitedMachines;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-specifying-products">Specifying Products</h4>
<div class="paragraph">
<p>ABS allows the developer to name products that are of particular interest, in
order to easily refer to them later when the actual code needs to be
generated. A product definition states which features are to be included in
the product and sets attributes of those features to concrete values. In the simplest
case products are declared directly, by listing the features that they include.
It is also possible to declare products based on other products using
<em>product expressions</em>. Product expressions use set-theoretic operations (union,
intersection, complement) over products and sets of features.</p>
</div>
<table class="tableblock frame-ends grid-none stretch">
<caption class="title">Syntax</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>Selection</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>product</code> <em>TypeId</em> ( <code>(</code> <em>FeatureSpecs</em> <code>)</code> <code>;</code> | <code>=</code> <em>ProductExpr</em> <code>;</code> )</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>ProductExpr</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{</code> <em>FeatureSpecs</em> <code>}</code><br>
  |  <em>ProductExpr</em> <code>&amp;&amp;</code> <em>ProductExpr</em><br>
  |  <em>ProductExpr</em> <code>||</code> <em>ProductExpr</em><br>
  |  <em>ProductExpr</em> <code>-</code> <em>ProductExpr</em><br>
  |  <em>TypeId</em><br>
  |  <code>(</code> <em>ProductExpr</em> <code>)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FeatureSpecs</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>FeatureSpec</em> { <code>,</code> <em>FeatureSpec</em> }</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>FeatureSpec</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>FName</em> [ <em>AttributeAssignments</em> ]</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AttributeAssignments</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{</code> <em>AttributeAssignment</em> { <code>,</code> <em>AttributeAssignment</em> } <code>}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><em>AttributeAssignment</em> ::=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>AName</em> <code>=</code> <em>Literal</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here are some product definitions for the <code>DeltaResourceExample</code> product line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>product WordcountModel (Wordcount, NoCost, NoDeploymentScenario);
product WordcountFull (Wordcount, Cost{cost=10}, UnlimitedMachines{capacity=20});
product WordsearchFull (Wordsearch, Cost{cost=10}, UnlimitedMachines{capacity=20});
product WordsearchDemo (Wordsearch, Cost{cost=10}, LimitedMachines{capacity=20, machinelimit=2});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are some product definitions for the <code>CharityOrganizationExample</code> with <code>ProductExpr</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>product Org1 = SekolahBermainMatahari || {Continuous};
product Org2 = SekolahBermainMatahari || {Continuous, Automatic_Report};
product Org3 = SekolahBermainMatahari || PKPU;
product Org4 = SekolahBermainMatahari || PKPU || RamadhanForKids;
product Org5 = SekolahBermainMatahari || PKPU || RamadhanForKids || BeriBuku;
product Org6 = SekolahBermainMatahari &amp;&amp; RamadhanForKids;
product Org7 = SekolahBermainMatahari &amp;&amp; BeriBuku;
product Org8 = SekolahBermainMatahari - {Eventual};
product Org9 = SekolahBermainMatahari - {Eventual, Income};
product Org10 = SekolahBermainMatahari &amp;&amp; RamadhanForKids || {Money, Item};
product Org11 = SekolahBermainMatahari &amp;&amp; (RamadhanForKids || {Money, Item});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-checking-the-spl">Checking the SPL</h4>
<div class="paragraph">
<p>Because the number of variants in an SPL can be very large, checking them
efficiently (e.g., to ensure that they are all well-typed) is challenging.
Building each variant in order to type-check it is usually not feasible from a
performance perspective. Instead, the ABS compiler employs a number of efficient
consistency checks. These fall into two categories.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Family-based</em> analysis steps operate on the SPL definition itself,</p>
</li>
<li>
<p>Analysis steps operate on lightweight <em>abstractions</em> of the SPL variants.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These checks are performed automatically upon compilation and help ensure that
all variants defined by an SPL specified in ABS can be built and are well-typed
ABS programs.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="-abs-backends">17. ABS Backends</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the available and supported backends for ABS.
Different backends have different purposes (simulation, code execution,
visualization).  Their respective section describes their features and usage.</p>
</div>
<div class="paragraph">
<p>The following table gives an overview of the features that different backends
have.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Real-Time ABS</dt>
<dd>
<p>Simulating a dense-time clock, and language constructs
expressing delays and task deadlines.  Used for simulating time usage of ABS
models.</p>
</dd>
<dt class="hdlist1">Resource Models</dt>
<dd>
<p>Specification of resource availability (processor power,
bandwidth) of <em>Deployment Components</em> and simulation of resource usage
deployed thereon.  Builds on the semantics of Real-Time ABS.</p>
</dd>
<dt class="hdlist1">FLI</dt>
<dd>
<p>Foreign-Language Interface, the ability to call backend-specific native
code from ABS.</p>
</dd>
<dt class="hdlist1">User-defined Schedulers</dt>
<dd>
<p>Specification of per-cog task priorities
using ABS functions.</p>
</dd>
<dt class="hdlist1">Model API</dt>
<dd>
<p>Interacting with a running ABS model via HTTP requests.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Backend Capabilities</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Backend</th>
<th class="tableblock halign-left valign-top">Maude</th>
<th class="tableblock halign-left valign-top">Erlang</th>
<th class="tableblock halign-left valign-top">Java</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real-Time ABS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Models</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User-defined Schedulers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Model API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="sec:java-backend">17.1. Java Backend</h3>
<div class="paragraph">
<p>The Java backend runs ABS models on the JVM by translating them into Java and
combining them with a runtime library implementing key ABS concepts.</p>
</div>
<div class="sect3">
<h4 id="-how-to-run-the-java-backend">How to run the Java backend</h4>
<div class="paragraph">
<p>Compiling all files in the current directory into Java and starting the
resulting model is done with the following commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ absc --java *.abs -o model.jar
$ java -jar model.jar</pre>
</div>
</div>
<div class="paragraph">
<p>The first command compiles the ABS model, the second command starts Java and
runs the code contained in <code>model.jar</code>.  In case more than one abs file
contains a main block, an arbitrary main block is executed.</p>
</div>
<div class="paragraph">
<p>The model accepts a number of command-line arguments; see the output
of <code>java -jar model.jar -h</code> for a list.</p>
</div>
<div class="paragraph">
<p>The source code of the generated classes can be inspected below the <code>gen/</code>
directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="-compiling-abs-code-from-gradle">Compiling ABS Code from Gradle</h4>
<div class="paragraph">
<p>The gradle build system can compile ABS code by adding the below
fragment to a Java project&#8217;s <code>build.gradle</code> file.  This does the
following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Downloads the latest released version of the ABS compiler</p>
</li>
<li>
<p>Compiles all ABS files below <code>src/main/abs</code></p>
</li>
<li>
<p>Adds a dependency such that ABS code is compiled before Java code</p>
</li>
<li>
<p>Adds the resulting Java source directory <code>build/abs</code> so that
generated ABS classes can be referenced from Java.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="groovy"><span class="c1">// Use Gradle's cache directory for downloaded files</span>
<span class="n">ext</span> <span class="o">{</span>
    <span class="n">absToolsDir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s2">"${gradle.gradleUserHomeDir}/caches/abstools"</span><span class="o">)</span>
<span class="o">}</span>

<span class="n">dependencies</span> <span class="o">{</span>
    <span class="c1">// Any other dependencies here ...</span>
    <span class="n">implementation</span> <span class="nf">files</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">project</span><span class="o">.</span><span class="na">ext</span><span class="o">.</span><span class="na">absToolsDir</span><span class="o">,</span> <span class="s2">"absfrontend.jar"</span><span class="o">))</span>
<span class="o">}</span>

<span class="n">task</span> <span class="n">downloadAbsFrontend</span> <span class="o">{</span>
    <span class="n">description</span> <span class="s1">'Downloads the latest absfrontend.jar from GitHub releases'</span>
    <span class="kt">def</span> <span class="n">taskAbsToolsDir</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="na">ext</span><span class="o">.</span><span class="na">absToolsDir</span>
    <span class="kt">def</span> <span class="n">taskAbsDownloadsDir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">taskAbsToolsDir</span><span class="o">,</span> <span class="s2">"/downloads"</span><span class="o">)</span>

    <span class="n">doLast</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Checking for latest absfrontend.jar..."</span><span class="o">)</span>
        <span class="n">taskAbsDownloadsDir</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">()</span>
        <span class="kt">def</span> <span class="n">apiUrl</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">URL</span><span class="o">(</span><span class="s2">"https://api.github.com/repos/abstools/abstools/releases/latest"</span><span class="o">)</span>
        <span class="kt">def</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">apiUrl</span><span class="o">.</span><span class="na">openConnection</span><span class="o">()</span>
        <span class="c1">// GitHub API may require a User-Agent header</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s2">"User-Agent"</span><span class="o">,</span> <span class="s2">"Gradle Build"</span><span class="o">)</span>

        <span class="kt">def</span> <span class="n">jsonText</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">().</span><span class="na">getText</span><span class="o">()</span>
        <span class="kt">def</span> <span class="n">json</span> <span class="o">=</span> <span class="k">new</span> <span class="n">groovy</span><span class="o">.</span><span class="na">json</span><span class="o">.</span><span class="na">JsonSlurper</span><span class="o">().</span><span class="na">parseText</span><span class="o">(</span><span class="n">jsonText</span><span class="o">)</span>
        <span class="kt">def</span> <span class="n">version</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="na">tag_name</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">version</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s1">'v'</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>  <span class="c1">// Remove 'v' prefix if present</span>
        <span class="o">}</span>
        <span class="kt">def</span> <span class="n">jarAsset</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="na">assets</span><span class="o">.</span><span class="na">find</span> <span class="o">{</span> <span class="n">it</span><span class="o">.</span><span class="na">name</span> <span class="o">==</span> <span class="s2">"absfrontend.jar"</span> <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">jarAsset</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">def</span> <span class="n">versionedJarName</span> <span class="o">=</span> <span class="s2">"absfrontend-${version}.jar"</span>
            <span class="kt">def</span> <span class="n">versionedJarFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">taskAbsDownloadsDir</span><span class="o">,</span> <span class="n">versionedJarName</span><span class="o">)</span>
            <span class="kt">def</span> <span class="n">jarFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">taskAbsToolsDir</span><span class="o">,</span> <span class="s2">"absfrontend.jar"</span><span class="o">)</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">versionedJarFile</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Version ${version} already downloaded at ${versionedJarFile.absolutePath}"</span><span class="o">)</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="kt">def</span> <span class="n">downloadUrl</span> <span class="o">=</span> <span class="n">jarAsset</span><span class="o">.</span><span class="na">browser_download_url</span>
                <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Found latest version ${version} at: ${downloadUrl}"</span><span class="o">)</span>
                <span class="c1">// Delete any previous absfrontend jar files</span>
                <span class="n">taskAbsDownloadsDir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">().</span><span class="na">each</span> <span class="o">{</span> <span class="n">file</span> <span class="o">-&gt;</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s2">"absfrontend-"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">file</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s2">".jar"</span><span class="o">))</span> <span class="o">{</span>
                        <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Deleting old version: ${file.name}"</span><span class="o">)</span>
                        <span class="n">file</span><span class="o">.</span><span class="na">delete</span><span class="o">()</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="kt">def</span> <span class="n">jarConnection</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">URL</span><span class="o">(</span><span class="n">downloadUrl</span><span class="o">).</span><span class="na">openConnection</span><span class="o">()</span>
                <span class="n">jarConnection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s2">"User-Agent"</span><span class="o">,</span> <span class="s2">"Gradle Build"</span><span class="o">)</span>
                <span class="k">try</span> <span class="o">(</span><span class="kt">def</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">jarConnection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">java</span><span class="o">.</span><span class="na">nio</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">inputStream</span><span class="o">,</span> <span class="n">versionedJarFile</span><span class="o">.</span><span class="na">toPath</span><span class="o">(),</span>
                                             <span class="n">java</span><span class="o">.</span><span class="na">nio</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">StandardCopyOption</span><span class="o">.</span><span class="na">REPLACE_EXISTING</span><span class="o">)</span>
                <span class="o">}</span>
                <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Successfully downloaded absfrontend.jar version ${version} to ${versionedJarFile.absolutePath}"</span><span class="o">)</span>
            <span class="o">}</span>
            <span class="n">java</span><span class="o">.</span><span class="na">nio</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">versionedJarFile</span><span class="o">.</span><span class="na">toPath</span><span class="o">(),</span> <span class="n">jarFile</span><span class="o">.</span><span class="na">toPath</span><span class="o">(),</span>
                                     <span class="n">java</span><span class="o">.</span><span class="na">nio</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">StandardCopyOption</span><span class="o">.</span><span class="na">REPLACE_EXISTING</span><span class="o">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">lifecycle</span><span class="o">(</span><span class="s2">"Copied ${versionedJarFile.absolutePath} to ${jarFile.absolutePath}"</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">GradleException</span><span class="o">(</span><span class="s2">"Could not find absfrontend.jar in the latest release"</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Compile ABS</span>
<span class="n">task</span> <span class="nf">compileAbs</span><span class="o">(</span><span class="nl">type:</span> <span class="n">Exec</span><span class="o">,</span> <span class="nl">dependsOn:</span> <span class="n">downloadAbsFrontend</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s1">'Compiles ABS.'</span>
    <span class="n">inputs</span><span class="o">.</span><span class="na">dir</span> <span class="s1">'src/main/abs'</span>
    <span class="n">outputs</span><span class="o">.</span><span class="na">dir</span> <span class="s1">'build/abs'</span>
    <span class="n">commandLine</span> <span class="s1">'java'</span><span class="o">,</span> <span class="s1">'-jar'</span><span class="o">,</span> <span class="n">project</span><span class="o">.</span><span class="na">ext</span><span class="o">.</span><span class="na">absToolsDir</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s1">'/absfrontend.jar'</span><span class="o">,</span> <span class="s1">'--java'</span><span class="o">,</span> <span class="s1">'-d'</span><span class="o">,</span> <span class="s1">'build/abs/'</span><span class="o">,</span> <span class="s1">'--sourceonly'</span><span class="o">,</span>
        <span class="o">*</span><span class="n">fileTree</span><span class="o">(</span><span class="nl">dir:</span> <span class="s1">'src/main/abs'</span><span class="o">,</span> <span class="nl">include:</span> <span class="s1">'**/*.abs'</span><span class="o">).</span><span class="na">collect</span> <span class="o">{</span> <span class="n">it</span><span class="o">.</span><span class="na">absolutePath</span> <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Also, add build/abs to the runtime classpath</span>
<span class="n">sourceSets</span> <span class="o">{</span>
    <span class="n">main</span> <span class="o">{</span>
        <span class="n">java</span> <span class="o">{</span>
            <span class="n">srcDirs</span> <span class="s1">'build/abs'</span>
        <span class="o">}</span>
        <span class="n">runtimeClasspath</span> <span class="o">+=</span> <span class="n">files</span><span class="o">(</span><span class="s1">'build/abs'</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">tasks</span><span class="o">.</span><span class="na">withType</span><span class="o">(</span><span class="n">JavaCompile</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">dependsOn</span> <span class="n">compileAbs</span>
    <span class="nf">source</span><span class="o">(</span><span class="s1">'build/abs'</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// Apply a specific Java toolchain to ease working on different environments.</span>
<span class="n">java</span> <span class="o">{</span>
    <span class="n">toolchain</span> <span class="o">{</span>
        <span class="n">languageVersion</span> <span class="o">=</span> <span class="n">JavaLanguageVersion</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">21</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-running-an-abs-model-from-java">Running an ABS Model from Java</h4>
<div class="paragraph">
<p>An ABS model can be started from a Java program by calling the main
method of a special class <code>Main</code> in the generated Java code.</p>
</div>
<div class="paragraph">
<p>Here is a simple ABS program that waits for 15 time unites, then prints a greeting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="abs">module ABS;
{
    await duration(15);
    println(`Hello world!  The time is $now()$`);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the generated ABS Java code is included in the Java project&#8217;s
source path, this ABS model can be started from Java as follows, and
the generated output captured in a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ByteArrayOutputStream</span> <span class="n">outputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
        <span class="nc">PrintStream</span> <span class="n">printStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrintStream</span><span class="o">(</span><span class="n">outputStream</span><span class="o">);</span>
        <span class="nc">PrintStream</span> <span class="n">originalOut</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="n">printStream</span><span class="o">);</span>
            <span class="no">ABS</span><span class="o">.</span><span class="na">Main</span><span class="o">.</span><span class="na">main</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">setOut</span><span class="o">(</span><span class="n">originalOut</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Captured Output:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">outputStream</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:erlang-backend">17.2. Erlang Backend</h3>
<div class="paragraph">
<p>The Erlang backend runs ABS models on the Erlang virtual machine by
translating them into Erlang and combining them with a small runtime library
implementing key ABS concepts (cogs, futures, objects, method invocations) in
Erlang.</p>
</div>
<div class="paragraph">
<p>Executing an ABS model in Erlang currently returns the value of the last
statement of the main block; output via <code>ABS.StdLib.println</code> is printed on the
console.  For additional introspective and interactive capabilities, the
Erlang backend supports a Model API (see below).</p>
</div>
<div class="sect3">
<h4 id="-how-to-run-the-erlang-backend">How to run the Erlang backend</h4>
<div class="paragraph">
<p>Running a model in Erlang involves compiling the ABS code, then compiling and
running the resulting Erlang code.</p>
</div>
<div class="paragraph">
<p>Compiling all files in the current directory into Erlang and starting the
resulting model is done with the following commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ absc --erlang *.abs
$ gen/erl/run</pre>
</div>
</div>
<div class="paragraph">
<p>This sequence of commands starts Erlang, then compiles the generated Erlang
code and starts it.  Type <code>gen/erl/run -h</code> for a list of options accepted by
the model.</p>
</div>
</div>
<div class="sect3">
<h4 id="-recording-and-replaying-traces">Recording and replaying traces</h4>
<div class="paragraph">
<p>ABS task scheduling is non-deterministic; i.e., when two tasks are enabled,
the cog will select an arbitrary one (but see <a href="#sec:schedulers">User-Defined Schedulers</a>).  The erlang
backend can record a trace of scheduling decisions and replay it to precisely
reproduce the previous run.</p>
</div>
<div class="paragraph">
<p>To record a trace to a file <code>trace.json</code>, start the model with a parameter
<code>--record trace.json</code> or <code>-t trace.json</code>.</p>
</div>
<div class="paragraph">
<p>To replay an existing trace recorded in <code>trace.json</code>, start the model with
<code>--replay trace.json</code> or <code>-r trace.json</code>.</p>
</div>
<div class="paragraph">
<p>A trace can also be obtained from a running model via the Model API.  Assuming
the model is started on port 8080 (via a parameter <code>-p 8080</code>), the trace is
accessible at the url <a href="http://localhost:8080/trace" class="bare">http://localhost:8080/trace</a>.  A trace visualizer can be
found here: <a href="https://github.com/larstvei/ABS-traces" class="bare">https://github.com/larstvei/ABS-traces</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="-generating-code-coverage-information">Generating code coverage information</h4>
<div class="paragraph">
<p>The Erlang backend can optionally generate code coverage information in a
format inspired by gnu <code>gcov</code> (see
<a href="https://gcc.gnu.org/onlinedocs/gcc/Invoking-Gcov.html" class="bare">https://gcc.gnu.org/onlinedocs/gcc/Invoking-Gcov.html</a>).  The coverage
information contains line numbers and execution count, but not the source code
itself.  This is sufficient for some tools to visualize code coverage, e.g.,
<code>cov-mode</code> for Emacs (<a href="https://github.com/AdamNiederer/cov" class="bare">https://github.com/AdamNiederer/cov</a>).</p>
</div>
<div class="paragraph">
<p>To generate code coverage information, compile an abs model with the
<code>--debuginfo</code> switch, then run it as normal, i.e.,</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ absc --erlang --debuginfo *.abs
$ gen/erl/run</pre>
</div>
</div>
<div class="paragraph">
<p>For each <code>.abs</code> file, running the model will generate a <code>.abs.gcov</code> file in
the directory <code>gen/erl/absmodel</code> after the simulation finishes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="-maude-backend">17.3. Maude Backend</h3>
<div class="paragraph">
<p>The Maude backend is a high-level, executable semantics in rewriting logic of
the ABS language.  Due to its relatively compact nature, it serves as a
test-bed for new language features.</p>
</div>
<div class="paragraph">
<p>Executing a model on the Maude backend results in a complete snapshot of the system state after execution has finished.</p>
</div>
<div class="paragraph">
<p>The main drawback of the Maude backend is its relatively poor performance, making it not very suitable to simulate large models.</p>
</div>
<div class="paragraph">
<p>Features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CPU and bandwidth resources</p>
</li>
<li>
<p>Simulation of resource usage on deployment components</p>
</li>
<li>
<p>Timed semantics</p>
</li>
<li>
<p>Executable formal semantics of the ABS language</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="-how-to-run-the-maude-backend">How to run the Maude backend</h4>
<div class="paragraph">
<p>Running a model on Maude involves compiling the code, then starting Maude with
the resulting file as input.</p>
</div>
<div class="paragraph">
<p>Compiling all files in the current directory into Maude is done with the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ absc --maude *.abs -o model.maude</pre>
</div>
</div>
<div class="paragraph">
<p>The model is started with the following commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ maude
Maude&gt; in model.maude
Maude&gt; frew start .</pre>
</div>
</div>
<div class="paragraph">
<p>This sequence of commands starts Maude, then loads the compiled model and
starts it.  The resulting output is a dump of the complete system state after
execution of the model finishes.</p>
</div>
<div class="paragraph">
<p>In case of problems, check the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>absc</code> should be in the path; check the <code>PATH</code> environment variable.</p>
</li>
<li>
<p><code>absfrontend.jar</code> should be in the environment variable <code>CLASSPATH</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. This ordering is not guaranteed to be stable between two invocations of a program.  If ABS ever develops object serialization, care must be taken to uphold any datatype invariants across program invocations, e.g., when reading back an ordered list of objects.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v1.10.1<br>
Last updated 2025-04-15 15:30:41 +0200
</div>
</div>
</body>
</html>